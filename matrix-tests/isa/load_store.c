#include "riscv_matrix.h"
#include "utils.h"

// M1
const int8_t i8_rs1[] = {-93, -89, 121, -123};
const int16_t i16_rs1[] = {24455, -30160, -20540, 20710};
const int32_t i32_rs1[] = {246897081, 1669227186, -1926070292, -2071733660};
const int64_t i64_rs1[] = {6434836983883769530, -8148777892508189639,
                           5511953749517690378, -630744233100753856};
const int8_t i8_rs1_tp[] = {-93, 121, -89, -123};
const int16_t i16_rs1_tp[] = {24455, -20540, -30160, 20710};
const int32_t i32_rs1_tp[] = {246897081, -1926070292, 1669227186, -2071733660};
const int64_t i64_rs1_tp[] = {6434836983883769530, 5511953749517690378,
                              -8148777892508189639, -630744233100753856};
const uint8_t u8_rs1[] = {0u, 218u, 216u, 222u};
const uint16_t u16_rs1[] = {42743u, 9091u, 8049u, 55208u};
const uint32_t u32_rs1[] = {1671532100u, 281802786u, 537437091u, 1841142291u};
const uint64_t u64_rs1[] = {14537392746491786892u, 15478644212105236565u,
                            4875585649773384250u, 11381168778312796626u};
const uint8_t u8_rs1_tp[] = {0u, 216u, 218u, 222u};
const uint16_t u16_rs1_tp[] = {42743u, 8049u, 9091u, 55208u};
const uint32_t u32_rs1_tp[] = {1671532100u, 537437091u, 281802786u,
                               1841142291u};
const uint64_t u64_rs1_tp[] = {14537392746491786892u, 4875585649773384250u,
                               15478644212105236565u, 11381168778312796626u};
const fp16_t fp16_rs1[] = {1.417, -0.611, 0.852, 0.4038};
const fp32_t fp32_rs1[] = {0.2876706f, 0.25072205f, 0.552841f, -1.4288656f};
const fp64_t fp64_rs1[] = {0.25951296, -0.22276918, 0.00402457, 0.49142913};
const fp16_t fp16_rs1_tp[] = {1.417, 0.852, -0.611, 0.4038};
const fp32_t fp32_rs1_tp[] = {0.2876706f, 0.552841f, 0.25072205f, -1.4288656f};
const fp64_t fp64_rs1_tp[] = {0.25951296, 0.00402457, -0.22276918, 0.49142913};

// M2
// [2, 16]
const int8_t i8_a_m2[] = {55,  37, 39,  37,  -100, 39,  -96, -72,
                          -77, 89, -64, -83, -99,  -56, -40, -114,
                          28,  90, -78, 26,  40,   -40, 27,  27,
                          -81, 16, 120, -54, -100, 60,  -10, -1};
const int8_t i8_a_m2_tp[] = {55,   28,   37,  90,  39,  -78, 37,   26,
                             -100, 40,   39,  -40, -96, 27,  -72,  27,
                             -77,  -81,  89,  16,  -64, 120, -83,  -54,
                             -99,  -100, -56, 60,  -40, -10, -114, -1};
const uint8_t u8_a_m2[] = {46, 107, 211, 85,  216, 204, 102, 120, 247, 90, 132,
                           81, 239, 224, 232, 105, 114, 34,  176, 100, 51, 70,
                           69, 185, 168, 161, 154, 0,   97,  86,  60,  175};
const uint8_t u8_a_m2_tp[] = {
    46,  114, 107, 34,  211, 176, 85, 100, 216, 51, 204, 70, 102, 69, 120, 185,
    247, 168, 90,  161, 132, 154, 81, 0,   239, 97, 224, 86, 232, 60, 105, 175};
// [3, 8]
const int16_t i16_a_m2[] = {28132,  -19626, -4816,  -2203, 7218,   3410,
                            -22728, -23957, -16566, 19768, -21823, 30816,
                            -8967,  11357,  27018,  21033, -16612, 24987,
                            -25625, 11747,  23402,  27672, -28044, 26464};
const int16_t i16_a_m2_tp[] = {28132,  -16566, -16612, -19626, 19768, 24987,
                               -4816,  -21823, -25625, -2203,  30816, 11747,
                               7218,   -8967,  23402,  3410,   11357, 27672,
                               -22728, 27018,  -28044, -23957, 21033, 26464};

const uint16_t u16_a_m2[] = {21325, 51211, 14476, 59090, 22899, 20202,
                             64615, 54256, 10688, 17019, 1240,  17643,
                             40880, 26734, 43049, 55294, 50220, 59985,
                             52081, 15056, 171,   55551, 4112,  26843};
const uint16_t u16_a_m2_tp[] = {21325, 10688, 50220, 51211, 17019, 59985,
                                14476, 1240,  52081, 59090, 17643, 15056,
                                22899, 40880, 171,   20202, 26734, 55551,
                                64615, 43049, 4112,  54256, 55294, 26843};
const fp16_t fp16_a_m2[] = {
    28624.,  -42624., -19984., 55168.,  -32128., 6516.,   -50112., -33536.,
    -16768., 12712.,  -55680., -59616., -65472., -30112., -57728., -63424.,
    54464.,  -19168., 24112.,  -15296., 19984.,  -55456., 38112.,  42432.};
const fp16_t fp16_a_m2_tp[] = {
    28624.,  -16768., 54464.,  -42624., 12712.,  -19168., -19984., -55680.,
    24112.,  55168.,  -59616., -15296., -32128., -65472., 19984.,  6516.,
    -30112., -55456., -50112., -57728., 38112.,  -33536., -63424., 42432.};
// [4, 4]
const int32_t i32_a_m2[] = {-1949944760, -660323623,  1624383466,  672465499,
                            -2054142899, 343270409,   -485624649,  2002471009,
                            818766064,   1329549791,  -1274143290, -1664871553,
                            -1469430248, -1345937432, 157764570,   -1701026939};
const int32_t i32_a_m2_tp[] = {
    -1949944760, -2054142899, 818766064,   -1469430248, -660323623,  343270409,
    1329549791,  -1345937432, 1624383466,  -485624649,  -1274143290, 157764570,
    672465499,   2002471009,  -1664871553, -1701026939};
const uint32_t u32_a_m2[] = {3937005616, 2865460462, 531929314,  2249225592,
                             3921326836, 2872663330, 267028748,  3988825463,
                             64121195,   2544450380, 434974217,  1749829358,
                             297713988,  824083590,  2203237323, 959531134};
const uint32_t u32_a_m2_tp[] = {3937005616, 3921326836, 64121195,   297713988,
                                2865460462, 2872663330, 2544450380, 824083590,
                                531929314,  267028748,  434974217,  2203237323,
                                2249225592, 3988825463, 1749829358, 959531134};
const fp32_t fp32_a_m2[] = {
    -5.8141459e+37, -6.9045779e+37, -6.4010189e+37, 5.1303022e+37,
    2.4056729e+38,  2.0421184e+38,  -2.2672625e+38, -7.9126918e+37,
    1.8522848e+38,  1.8012116e+38,  -2.9879314e+38, -2.9793547e+38,
    2.9852861e+38,  1.7624548e+37,  -3.0569189e+38, 8.6349621e+37};
const fp32_t fp32_a_m2_tp[] = {
    -5.8141459e+37, 2.4056729e+38,  1.8522848e+38,  2.9852861e+38,
    -6.9045779e+37, 2.0421184e+38,  1.8012116e+38,  1.7624548e+37,
    -6.4010189e+37, -2.2672625e+38, -2.9879314e+38, -3.0569189e+38,
    5.1303022e+37,  -7.9126918e+37, -2.9793547e+38, 8.6349621e+37};
// [5, 2]
const int64_t i64_a_m2[] = {-6436571777124282808, -1745695021553196366,
                            -3822058587776394261, 2521866819055658827,
                            -6234389712282446212, 228862449121437418,
                            -8129419534977643711, -353231915027973423,
                            -4925374119132463918, 6720266756215345123};
const int64_t i64_a_m2_tp[] = {-6436571777124282808, -3822058587776394261,
                               -6234389712282446212, -8129419534977643711,
                               -4925374119132463918, -1745695021553196366,
                               2521866819055658827,  228862449121437418,
                               -353231915027973423,  6720266756215345123};
const uint64_t u64_a_m2[] = {1962009568192628204,  6962986500212720835,
                             15619535875105360049, 15974378444360977648,
                             7099316697992627191,  5918082445019289691u,
                             12052753122763837658, 12859917593166347751,
                             7995443601131549468,  17979394559714694115};
const uint64_t u64_a_m2_tp[] = {1962009568192628204,  15619535875105360049,
                                7099316697992627191,  12052753122763837658,
                                7995443601131549468,  6962986500212720835,
                                15974378444360977648, 5918082445019289691,
                                12859917593166347751, 17979394559714694115};
const fp64_t fp64_a_m2[] = {1.13943201e+38,  -1.65549022e+38, 2.18331800e+38,
                            -2.68962526e+38, 8.11282621e+37,  2.79003062e+38,
                            2.82697912e+38,  1.15466392e+37,  1.42118010e+37,
                            -1.63923976e+38};
const fp64_t fp64_a_m2_tp[] = {1.13943201e+38,  2.18331800e+38, 8.11282621e+37,
                               2.82697912e+38,  1.42118010e+37, -1.65549022e+38,
                               -2.68962526e+38, 2.79003062e+38, 1.15466392e+37,
                               -1.63923976e+38};

// M4
// [2, 32]
const int8_t i8_a_m4[] = {
    12,   -49, 67, 60,  -72,  -15, 29,   -88, 115,  83,  9,   -63,  -68,
    -66,  85,  78, -35, 36,   13,  -102, 45,  -121, -18, -91, -120, -89,
    -6,   -53, 81, -69, -115, -17, -100, 99,  -10,  16,  4,   87,   91,
    -89,  -54, -2, 10,  6,    -70, 111,  -38, 33,   -39, -28, -75,  106,
    -115, -9,  94, -54, -103, -29, 28,   -95, -7,   -9,  -75, 89};
const int8_t i8_a_m4_tp[] = {
    12,  -100, -49,  99,   67,  -10, 60,  16,  -72,  4,    -15,  87,  29,
    91,  -88,  -89,  115,  -54, 83,  -2,  9,   10,   -63,  6,    -68, -70,
    -66, 111,  85,   -38,  78,  33,  -35, -39, 36,   -28,  13,   -75, -102,
    106, 45,   -115, -121, -9,  -18, 94,  -91, -54,  -120, -103, -89, -29,
    -6,  28,   -53,  -95,  81,  -7,  -69, -9,  -115, -75,  -17,  89};
const uint8_t u8_a_m4[] = {
    112, 47,  209, 179, 66,  90, 10,  39,  201, 39,  105, 33,  76,
    84,  12,  2,   235, 21,  71, 119, 35,  230, 43,  61,  22,  9,
    233, 88,  141, 194, 170, 26, 242, 239, 251, 34,  215, 145, 193,
    12,  111, 109, 159, 97,  15, 143, 216, 135, 213, 234, 56,  204,
    151, 201, 241, 69,  199, 50, 83,  118, 28,  13,  22,  173};
const uint8_t u8_a_m4_tp[] = {
    112, 242, 47,  239, 209, 251, 179, 34,  66,  215, 90,  145, 10,
    193, 39,  12,  201, 111, 39,  109, 105, 159, 33,  97,  76,  15,
    84,  143, 12,  216, 2,   135, 235, 213, 21,  234, 71,  56,  119,
    204, 35,  151, 230, 201, 43,  241, 61,  69,  22,  199, 9,   50,
    233, 83,  88,  118, 141, 28,  194, 13,  170, 22,  26,  173};
// [3, 16]
const int16_t i16_a_m4[] = {
    -26931, -5461,  -21732, -17323, 19744, -11547, 32479, 17400,
    -8670,  -14254, -1598,  24185,  23379, -28389, 2373,  13161,
    -24242, -16256, -30590, -22567, 22009, 14448,  13339, -13654,
    1690,   19001,  10345,  14529,  -9397, 18771,  9433,  26963,
    24393,  -3105,  -15441, 23832,  -6006, -3450,  16653, 19048,
    26342,  -27823, -28989, 8727,   8335,  -5002,  13115, -15282};
const int16_t i16_a_m4_tp[] = {
    -26931, -24242, 24393,  -5461,  -16256, -3105,  -21732, -30590,
    -15441, -17323, -22567, 23832,  19744,  22009,  -6006,  -11547,
    14448,  -3450,  32479,  13339,  16653,  17400,  -13654, 19048,
    -8670,  1690,   26342,  -14254, 19001,  -27823, -1598,  10345,
    -28989, 24185,  14529,  8727,   23379,  -9397,  8335,   -28389,
    18771,  -5002,  2373,   9433,   13115,  13161,  26963,  -15282};
const uint16_t u16_a_m4[] = {
    57200, 61498, 25617, 22772, 22644, 11449, 18047, 44553, 32468, 58057,
    47194, 53248, 27551, 6907,  15926, 38242, 58263, 21268, 39084, 42254,
    11167, 38548, 33959, 3337,  26879, 60235, 55528, 39908, 39016, 7521,
    32662, 55372, 37528, 35852, 61048, 21511, 5100,  42807, 45532, 19457,
    42102, 13294, 34215, 34120, 42063, 33733, 6202,  10844};
const uint16_t u16_a_m4_tp[] = {
    57200, 58263, 37528, 61498, 21268, 35852, 25617, 39084, 61048, 22772,
    42254, 21511, 22644, 11167, 5100,  11449, 38548, 42807, 18047, 33959,
    45532, 44553, 3337,  19457, 32468, 26879, 42102, 58057, 60235, 13294,
    47194, 55528, 34215, 53248, 39908, 34120, 27551, 39016, 42063, 6907,
    7521,  33733, 15926, 32662, 6202,  38242, 55372, 10844};
const fp16_t fp16_a_m4[] = {
    37856.,  16976.,  -27616., 25904.,  9664.,   47200.,  41952.,  -3898.,
    -1029.,  -52544., -20480., 466.,    43904.,  64416.,  -37696., 57120.,
    31504.,  -59648., -44608., -63008., -18016., -64416., 64992.,  30176.,
    51072.,  53248.,  -56512., -50624., -64224., 1325.,   -14456., 887.5,
    -33408., -33664., 16328.,  -9128.,  -34208., 47616.,  15648.,  48832.,
    28432.,  29632.,  -56192., -60800., -7896.,  41920.,  -16752., 27200.};
const fp16_t fp16_a_m4_tp[] = {
    37856.,  31504., -33408., 16976.,  -59648., -33664., -27616., -44608.,
    16328.,  25904., -63008., -9128.,  9664.,   -18016., -34208., 47200.,
    -64416., 47616., 41952.,  64992.,  15648.,  -3898.,  30176.,  48832.,
    -1029.,  51072., 28432.,  -52544., 53248.,  29632.,  -20480., -56512.,
    -56192., 466.,   -50624., -60800., 43904.,  -64224., -7896.,  64416.,
    1325.,   41920., -37696., -14456., -16752., 57120.,  887.5,   27200.};
// [4, 8]
const int32_t i32_a_m4[] = {
    1836121111,  1288552308,  787296739,   -1651949746, 908690949,  -1002537117,
    -1561697799, 815045811,   11182868,    -1191239055, 1471994941, -1856137392,
    -1174780731, 882213221,   1081674142,  9034749,     1197064216, 1507796144,
    -1026899311, -1538024540, -204244229,  -806960161,  -465336497, -1338690002,
    1150550032,  -1374749364, -1943928986, -428674369,  -733050678, -45323304,
    63069290,    -1162568215};
const int32_t i32_a_m4_tp[] = {
    1836121111,  11182868,    1197064216,  1150550032, 1288552308,  -1191239055,
    1507796144,  -1374749364, 787296739,   1471994941, -1026899311, -1943928986,
    -1651949746, -1856137392, -1538024540, -428674369, 908690949,   -1174780731,
    -204244229,  -733050678,  -1002537117, 882213221,  -806960161,  -45323304,
    -1561697799, 1081674142,  -465336497,  63069290,   815045811,   9034749,
    -1338690002, -1162568215};
const uint32_t u32_a_m4[] = {
    4012676296, 3883178757, 418655399,  1069034026, 371734118,  2156009161,
    3417575396, 1741698324, 4086495629, 2031789684, 690372145,  4189095268,
    2787086044, 1826706484, 169136081,  2167707796, 2887916450, 2125129980,
    716677723,  3507433663, 1118367790, 2856940147, 4009745461, 578578644,
    2277555017, 2889632780, 2896828040, 3802877511, 3104523367, 3491812555,
    546004863,  3966753699};
const uint32_t u32_a_m4_tp[] = {
    4012676296, 4086495629, 2887916450, 2277555017, 3883178757, 2031789684,
    2125129980, 2889632780, 418655399,  690372145,  716677723,  2896828040,
    1069034026, 4189095268, 3507433663, 3802877511, 371734118,  2787086044,
    1118367790, 3104523367, 2156009161, 1826706484, 2856940147, 3491812555,
    3417575396, 169136081,  4009745461, 546004863,  1741698324, 2167707796,
    578578644,  3966753699};
const fp32_t fp32_a_m4[] = {
    -4.2460877e+37, 2.5094168e+38,  9.7793281e+37,  -1.6430936e+38,
    -7.7163342e+37, -1.6963446e+38, -1.9846287e+38, 1.9927216e+38,
    -1.5182447e+37, 3.0871310e+38,  -2.5664308e+38, 1.8691127e+38,
    -3.3605259e+38, 1.3194312e+38,  -2.9612997e+37, 2.3587453e+38,
    8.9861601e+37,  2.5760086e+38,  2.6747389e+38,  1.1238387e+38,
    -4.7391723e+36, -5.1899279e+37, -2.0192790e+38, -3.9012784e+37,
    2.0214727e+38,  -1.1304964e+38, -2.8696553e+38, -3.0452304e+38,
    1.9561617e+38,  8.4430494e+37,  -1.5674523e+38, 2.3550431e+38};
const fp32_t fp32_a_m4_tp[] = {
    -4.2460877e+37, -1.5182447e+37, 8.9861601e+37,  2.0214727e+38,
    2.5094168e+38,  3.0871310e+38,  2.5760086e+38,  -1.1304964e+38,
    9.7793281e+37,  -2.5664308e+38, 2.6747389e+38,  -2.8696553e+38,
    -1.6430936e+38, 1.8691127e+38,  1.1238387e+38,  -3.0452304e+38,
    -7.7163342e+37, -3.3605259e+38, -4.7391723e+36, 1.9561617e+38,
    -1.6963446e+38, 1.3194312e+38,  -5.1899279e+37, 8.4430494e+37,
    -1.9846287e+38, -2.9612997e+37, -2.0192790e+38, -1.5674523e+38,
    1.9927216e+38,  2.3587453e+38,  -3.9012784e+37, 2.3550431e+38};
// [5, 4]
const int64_t i64_a_m4[] = {
    7568760390297604802,  1354926343928646474,  830828196244900335,
    -4185339547876550034, -1211925309896013781, -1888899834252467766,
    1130213699883323361,  -3995822586106494908, 3987962763753968122,
    3787078855959733933,  4773735223658650094,  -7474501681327631255,
    5683376383011952361,  1482091986592127507,  -2322068962219280162,
    -9144602654339641727, 1320897234516246537,  2490978085992388479,
    -7313694116599677394, -8674306878720781451};
const int64_t i64_a_m4_tp[] = {
    7568760390297604802,  -1211925309896013781, 3987962763753968122,
    5683376383011952361,  1320897234516246537,  1354926343928646474,
    -1888899834252467766, 3787078855959733933,  1482091986592127507,
    2490978085992388479,  830828196244900335,   1130213699883323361,
    4773735223658650094,  -2322068962219280162, -7313694116599677394,
    -4185339547876550034, -3995822586106494908, -7474501681327631255,
    -9144602654339641727, -8674306878720781451};
const uint64_t u64_a_m4[] = {
    14508597697215005437, 17800201414468498073, 3888977610776292860,
    11358898816462983847, 6340635313722555274,  12554802368956847614,
    8605067213114849549,  6528136676472995848,  12319254151311079435,
    4655411027332922862,  17989418167265566726, 17286779097111968737,
    17023946237026620210, 17163580067863971783, 8661806848817383024,
    5531572362587382469,  749877534171359096,   12083922632308687016,
    6304727204857506151,  13194120917526541871};
const uint64_t u64_a_m4_tp[] = {
    14508597697215005437, 6340635313722555274, 12319254151311079435,
    17023946237026620210, 749877534171359096,  17800201414468498073,
    12554802368956847614, 4655411027332922862, 17163580067863971783,
    12083922632308687016, 3888977610776292860, 8605067213114849549,
    17989418167265566726, 8661806848817383024, 6304727204857506151,
    11358898816462983847, 6528136676472995848, 17286779097111968737,
    5531572362587382469,  13194120917526541871};
const fp64_t fp64_a_m4[] = {
    3.90615335e+305,  7.33627146e+305,  -7.92594558e+305, 1.37173639e+306,
    8.30727591e+305,  4.29411070e+305,  1.62976338e+305,  1.47357011e+306,
    -6.25738718e+305, -2.21998450e+304, -1.32847376e+306, 7.23284329e+305,
    1.91152998e+305,  -2.74103368e+305, 1.09761738e+306,  1.02797220e+306,
    6.89211149e+305,  -1.27482128e+306, -5.90980287e+305, 7.63598914e+304};
const fp64_t fp64_a_m4_tp[] = {
    3.90615335e+305,  8.30727591e+305,  -6.25738718e+305, 1.91152998e+305,
    6.89211149e+305,  7.33627146e+305,  4.29411070e+305,  -2.21998450e+304,
    -2.74103368e+305, -1.27482128e+306, -7.92594558e+305, 1.62976338e+305,
    -1.32847376e+306, 1.09761738e+306,  -5.90980287e+305, 1.37173639e+306,
    1.47357011e+306,  7.23284329e+305,  1.02797220e+306,  7.63598914e+304};

// B and C Regs
// M2
// [2, 32]
const int8_t i8_b_m2[] = {
    26,  19,   -40,  -103, -22,  26,  -103, 5,   -123, 92,   -117, 39,  116,
    17,  17,   -23,  -90,  -19,  -64, -56,  -92, 117,  113,  -128, 106, 56,
    43,  -105, -108, 71,   -82,  78,  92,   -23, 2,    -127, -7,   108, 53,
    108, 72,   68,   -4,   -108, 31,  -118, -25, 62,   -49,  -38,  94,  -76,
    -20, 51,   -34,  -120, 42,   -89, -32,  53,  46,   50,   36,   108};
const int16_t i8_b_m2_tp[] = {
    26,  92,   19,   -23,  -40,  2,   -103, -127, -22,  -7,  26,   108, -103,
    53,  5,    108,  -123, 72,   92,  68,   -117, -4,   39,  -108, 116, 31,
    17,  -118, 17,   -25,  -23,  62,  -90,  -49,  -19,  -38, -64,  94,  -56,
    -76, -92,  -20,  117,  51,   113, -34,  -128, -120, 106, 42,   56,  -89,
    43,  -32,  -105, 53,   -108, 46,  71,   50,   -82,  36,  78,   108};
const uint8_t u8_b_m2[] = {
    95,  21,  68,  113, 245, 236, 31,  159, 11,  39,  59, 41,  218,
    141, 223, 206, 167, 159, 187, 231, 182, 211, 194, 33, 140, 185,
    106, 92,  56,  83,  44,  131, 170, 111, 237, 212, 63, 135, 236,
    236, 91,  166, 72,  23,  136, 2,   85,  65,  220, 91, 210, 109,
    165, 31,  60,  43,  110, 70,  213, 37,  183, 62,  79, 162};
const uint8_t u8_b_m2_tp[] = {
    95,  170, 21,  111, 68,  237, 113, 212, 245, 63,  236, 135, 31,
    236, 159, 236, 11,  91,  39,  166, 59,  72,  41,  23,  218, 136,
    141, 2,   223, 85,  206, 65,  167, 220, 159, 91,  187, 210, 231,
    109, 182, 165, 211, 31,  194, 60,  33,  43,  140, 110, 185, 70,
    106, 213, 92,  37,  56,  183, 83,  62,  44,  79,  131, 162};
// [3, 16]
const int16_t i16_b_m2[] = {
    -20221, -27656, 6193,   26267,  -13642, 12971,  -13243, 21287,
    -15193, -1129,  9376,   -8195,  -21198, 30807,  16413,  -15100,
    -30321, -24964, -17811, -13290, 20240,  9846,   13458,  30709,
    5619,   -18069, -22028, 28990,  4941,   29303,  -9890,  -23635,
    6781,   32432,  -17714, 5832,   -27751, -26441, 12149,  21851,
    -28520, 32471,  -28275, -15153, -8075,  1971,   11616,  -17900};
const int16_t i16_b_m2_tp[] = {
    -20221, -30321, 6781,   -27656, -24964, 32432,  6193,   -17811,
    -17714, 26267,  -13290, 5832,   -13642, 20240,  -27751, 12971,
    9846,   -26441, -13243, 13458,  12149,  21287,  30709,  21851,
    -15193, 5619,   -28520, -1129,  -18069, 32471,  9376,   -22028,
    -28275, -8195,  28990,  -15153, -21198, 4941,   -8075,  30807,
    29303,  1971,   16413,  -9890,  11616,  -15100, -23635, -17900};
const uint16_t u16_b_m2[] = {
    11026, 34792, 39058, 9756,  640,   1519,  30648, 41919, 21214, 35115,
    16164, 52932, 26936, 38206, 57235, 57872, 46760, 38592, 60116, 15843,
    21978, 4346,  1359,  13882, 10337, 29067, 49264, 2569,  32827, 10235,
    29950, 47178, 57312, 25171, 10262, 21850, 12278, 2084,  43284, 9839,
    19176, 45938, 50462, 17243, 35267, 31404, 42298, 44610};
const uint16_t u16_b_m2_tp[] = {
    11026, 46760, 57312, 34792, 38592, 25171, 39058, 60116, 10262, 9756,
    15843, 21850, 640,   21978, 12278, 1519,  4346,  2084,  30648, 1359,
    43284, 41919, 13882, 9839,  21214, 10337, 19176, 35115, 29067, 45938,
    16164, 49264, 50462, 52932, 2569,  17243, 26936, 32827, 35267, 38206,
    10235, 31404, 57235, 29950, 42298, 57872, 47178, 44610};
const fp16_t fp16_b_m2[] = {
    51040., 11824.,  43616.,  1192.,   -48288., -3754.,  34144.,  -15080.,
    5152.,  41440.,  57088.,  -54432., 9096.,   -64192., -53408., -21136.,
    14384., 7252.,   37888.,  -37888., 41600.,  -56608., 16016.,  -3970.,
    34560., -50048., 49376.,  -31424., 60640.,  22704.,  -3226.,  43392.,
    -3074., -27264., -6368.,  -40128., -41984., -30464., -12808., -63072.,
    56928., 11392.,  -24704., 16496.,  -32512., 63552.,  -21520., 61952.};
const fp16_t fp16_b_m2_tp[] = {
    51040.,  14384.,  -3074.,  11824.,  7252.,   -27264., 43616.,  37888.,
    -6368.,  1192.,   -37888., -40128., -48288., 41600.,  -41984., -3754.,
    -56608., -30464., 34144.,  16016.,  -12808., -15080., -3970.,  -63072.,
    5152.,   34560.,  56928.,  41440.,  -50048., 11392.,  57088.,  49376.,
    -24704., -54432., -31424., 16496.,  9096.,   60640.,  -32512., -64192.,
    22704.,  63552.,  -53408., -3226.,  -21520., -21136., 43392.,  61952.};
// [4, 8]
const int32_t i32_b_m2[] = {-1809425755, -1152443955, -589559184,  636729864,
                            -773491308,  1976877853,  1227309174,  -303029368,
                            -80695023,   -1186587203, 224204633,   1814732443,
                            -413902382,  -1487342636, -1849874051, -612613145,
                            -712772184,  -722956651,  -1439995242, 649321786,
                            807708196,   -235652242,  -2064030513, -1807809886,
                            1802864717,  -415996641,  -515693191,  951123419,
                            83328009,    -1738243200, -1791988785, -804824162};
const int32_t i32_b_m2_tp[] = {
    -1809425755, -80695023,   -712772184,  1802864717,  -1152443955,
    -1186587203, -722956651,  -415996641,  -589559184,  224204633,
    -1439995242, -515693191,  636729864,   1814732443,  649321786,
    951123419,   -773491308,  -413902382,  807708196,   83328009,
    1976877853,  -1487342636, -235652242,  -1738243200, 1227309174,
    -1849874051, -2064030513, -1791988785, -303029368,  -612613145,
    -1807809886, -804824162};
const uint32_t u32_b_m2[] = {
    1013040949, 1474943459, 1997890222, 221442698,  3448451066, 3549693808,
    1593063782, 2628155293, 1763278950, 3684963155, 501960586,  3279489727,
    1950054498, 1570873979, 1510488192, 204159869,  3541464942, 3493573118,
    3165396037, 3928389361, 3143788965, 4016326614, 1534848307, 3237063982,
    1230392118, 794783565,  894429280,  820611927,  3350733635, 4231727013,
    3300735277, 93164980};
const uint32_t u32_b_m2_tp[] = {
    1013040949, 1763278950, 3541464942, 1230392118, 1474943459, 3684963155,
    3493573118, 794783565,  1997890222, 501960586,  3165396037, 894429280,
    221442698,  3279489727, 3928389361, 820611927,  3448451066, 1950054498,
    3143788965, 3350733635, 3549693808, 1570873979, 4016326614, 4231727013,
    1593063782, 1510488192, 1534848307, 3300735277, 2628155293, 204159869,
    3237063982, 93164980};
const fp32_t fp32_b_m2[] = {
    -7.5218122e+37, 2.8227340e+38,  5.1727401e+37,  -1.4158211e+38,
    1.2526482e+38,  2.7056323e+38,  -3.2465015e+38, -2.8461778e+38,
    7.3600641e+37,  2.2766976e+38,  1.7896616e+38,  -6.3245871e+36,
    2.8578205e+38,  -2.9644693e+38, 9.4689969e+36,  8.1404475e+37,
    2.7734938e+38,  1.2527701e+38,  1.2677648e+38,  -2.9227918e+37,
    -8.9280803e+36, 2.1342383e+38,  1.5371489e+38,  3.0277717e+38,
    -7.0177477e+37, 3.2176891e+38,  -3.3452839e+38, -1.4166228e+38,
    3.1116743e+38,  9.0851220e+37,  -3.1631807e+38, -2.0347440e+37};
const fp32_t fp32_b_m2_tp[] = {
    -7.5218122e+37, 7.3600641e+37,  2.7734938e+38,  -7.0177477e+37,
    2.8227340e+38,  2.2766976e+38,  1.2527701e+38,  3.2176891e+38,
    5.1727401e+37,  1.7896616e+38,  1.2677648e+38,  -3.3452839e+38,
    -1.4158211e+38, -6.3245871e+36, -2.9227918e+37, -1.4166228e+38,
    1.2526482e+38,  2.8578205e+38,  -8.9280803e+36, 3.1116743e+38,
    2.7056323e+38,  -2.9644693e+38, 2.1342383e+38,  9.0851220e+37,
    -3.2465015e+38, 9.4689969e+36,  1.5371489e+38,  -3.1631807e+38,
    -2.8461778e+38, 8.1404475e+37,  3.0277717e+38,  -2.0347440e+37};
// [5, 4]
const int64_t i64_b_m2[] = {
    -5078386660358685736, 6278925696700527092,  -3419274820139680513,
    -8011031392130217830, 6626161973491153194,  -5714945473392085918,
    -6357121100143381256, -8870577499511012438, -4124844933137012533,
    4760080329569762916,  3960130374188020750,  4383744919430488531,
    998769871987792012,   -1907752989841851345, 1326733803306297826,
    -1842722717081200889, -9219712615058186204, -615141789003937955,
    -5386783852186948773, -6206393863785172177};
const int64_t i64_b_m2_tp[] = {
    -5078386660358685736, 6626161973491153194,  -4124844933137012533,
    998769871987792012,   -9219712615058186204, 6278925696700527092,
    -5714945473392085918, 4760080329569762916,  -1907752989841851345,
    -615141789003937955,  -3419274820139680513, -6357121100143381256,
    3960130374188020750,  1326733803306297826,  -5386783852186948773,
    -8011031392130217830, -8870577499511012438, 4383744919430488531,
    -1842722717081200889, -6206393863785172177};
const uint64_t u64_b_m2[] = {
    7901051582450981622, 2148069212342627471,  11895585964132977974,
    4240660033053575747, 16435951704387939081, 8269325595104927935,
    5890316229170416406, 8224593750512793475,  4815824659980553127,
    1582969412458202819, 15653967687068094806, 12595906508838032423,
    2582353086853206840, 5375122790213251580,  16189514333529593884,
    8314094019647472478, 7778581938098571973,  9206173958309294180,
    98464416039395675,   16992292781112150589};
const uint64_t u64_b_m2_tp[] = {
    7901051582450981622,  16435951704387939081, 4815824659980553127,
    2582353086853206840,  7778581938098571973,  2148069212342627471,
    8269325595104927935,  1582969412458202819,  5375122790213251580,
    9206173958309294180,  11895585964132977974, 5890316229170416406,
    15653967687068094806, 16189514333529593884, 98464416039395675,
    4240660033053575747,  8224593750512793475,  12595906508838032423,
    8314094019647472478,  16992292781112150589};
const fp64_t fp64_b_m2[] = {
    -2.90133459e+40, 1.30232420e+40, 1.54023095e+40,  -2.74764683e+40,
    -1.48393018e+40, 3.12233864e+40, 8.55078433e+38,  1.65576362e+40,
    2.08354583e+40,  2.61055023e+40, 2.29698412e+40,  -2.18031283e+40,
    -3.07409719e+40, 2.21238655e+40, -2.35210903e+40, -1.18535409e+39,
    -1.53239762e+40, 2.38549022e+40, 5.03272791e+39,  -3.20167632e+40};
const fp64_t fp64_b_m2_tp[] = {
    -2.90133459e+40, -1.48393018e+40, 2.08354583e+40,  -3.07409719e+40,
    -1.53239762e+40, 1.30232420e+40,  3.12233864e+40,  2.61055023e+40,
    2.21238655e+40,  2.38549022e+40,  1.54023095e+40,  8.55078433e+38,
    2.29698412e+40,  -2.35210903e+40, 5.03272791e+39,  -2.74764683e+40,
    1.65576362e+40,  -2.18031283e+40, -1.18535409e+39, -3.20167632e+40};
// M4
// [2, 64]
const int8_t i8_b_m4[] = {
    -7,  -2,   -108, 102, 38,   -12, -115, 37,  -60,  -113, 67,   -70, -102,
    116, -49,  66,   -47, -111, 27,  33,   75,  -124, -86,  -84,  115, 63,
    -1,  -83,  -45,  -20, -59,  40,  11,   -4,  -62,  -97,  -12,  -82, 20,
    56,  -121, -88,  72,  26,   102, -101, -59, -125, -87,  -111, -95, -89,
    -99, 40,   116,  72,  41,   122, -29,  70,  -106, -116, -109, 58,  36,
    57,  45,   7,    -13, -27,  -68, 68,   -96, 31,   -32,  -35,  91,  -11,
    62,  99,   -1,   61,  -36,  -79, 126,  -60, -67,  -1,   -32,  -48, -125,
    121, 61,   -25,  66,  68,   -67, -116, 73,  5,    -1,   82,   122, 33,
    -73, -36,  -41,  69,  -53,  110, -62,  -55, -62,  -18,  -107, -39, -76,
    -62, 87,   16,   66,  90,   86,  96,   79,  -75,  16,   -21};
const int8_t i8_b_m4_tp[] = {
    -7,  36,   -2,   57,   -108, 45,   102, 7,    38,   -13, -12,  -27,  -115,
    -68, 37,   68,   -60,  -96,  -113, 31,  67,   -32,  -70, -35,  -102, 91,
    116, -11,  -49,  62,   66,   99,   -47, -1,   -111, 61,  27,   -36,  33,
    -79, 75,   126,  -124, -60,  -86,  -67, -84,  -1,   115, -32,  63,   -48,
    -1,  -125, -83,  121,  -45,  61,   -20, -25,  -59,  66,  40,   68,   11,
    -67, -4,   -116, -62,  73,   -97,  5,   -12,  -1,   -82, 82,   20,   122,
    56,  33,   -121, -73,  -88,  -36,  72,  -41,  26,   69,  102,  -53,  -101,
    110, -59,  -62,  -125, -55,  -87,  -62, -111, -18,  -95, -107, -89,  -39,
    -99, -76,  40,   -62,  116,  87,   72,  16,   41,   66,  122,  90,   -29,
    86,  70,   96,   -106, 79,   -116, -75, -109, 16,   58,  -21};
const uint8_t u8_b_m4[] = {
    89,  77,  163, 195, 47,  151, 184, 181, 212, 6,   245, 1,   19,  132, 33,
    238, 149, 125, 28,  210, 236, 104, 101, 190, 138, 204, 189, 201, 205, 127,
    151, 123, 116, 207, 145, 24,  75,  163, 36,  41,  88,  90,  251, 196, 66,
    93,  8,   254, 158, 2,   27,  244, 145, 86,  205, 201, 80,  218, 249, 243,
    133, 229, 161, 239, 77,  150, 13,  23,  216, 178, 75,  69,  192, 19,  170,
    116, 213, 198, 11,  198, 63,  57,  91,  96,  56,  26,  30,  228, 146, 141,
    152, 109, 91,  122, 46,  159, 54,  31,  130, 128, 175, 21,  130, 50,  130,
    203, 119, 22,  162, 32,  201, 152, 104, 190, 184, 81,  243, 138, 83,  31,
    193, 62,  127, 111, 15,  210, 42,  154};
const uint8_t u8_b_m4_tp[] = {
    89,  77,  77,  150, 163, 13,  195, 23,  47,  216, 151, 178, 184, 75,  181,
    69,  212, 192, 6,   19,  245, 170, 1,   116, 19,  213, 132, 198, 33,  11,
    238, 198, 149, 63,  125, 57,  28,  91,  210, 96,  236, 56,  104, 26,  101,
    30,  190, 228, 138, 146, 204, 141, 189, 152, 201, 109, 205, 91,  127, 122,
    151, 46,  123, 159, 116, 54,  207, 31,  145, 130, 24,  128, 75,  175, 163,
    21,  36,  130, 41,  50,  88,  130, 90,  203, 251, 119, 196, 22,  66,  162,
    93,  32,  8,   201, 254, 152, 158, 104, 2,   190, 27,  184, 244, 81,  145,
    243, 86,  138, 205, 83,  201, 31,  80,  193, 218, 62,  249, 127, 243, 111,
    133, 15,  229, 210, 161, 42,  239, 154};
// [3, 32]
const int16_t i16_b_m4[] = {
    20102,  -27215, -31002, -28440, -2386,  30711,  -11415, 20182,  19510,
    -16452, -22675, 13145,  -2468,  -1655,  -9060,  -3465,  17535,  6498,
    27711,  19180,  25371,  -32615, -8355,  -24201, 12672,  -17268, -10362,
    19964,  -3301,  -29596, 8157,   -16368, 26197,  10883,  -9838,  3135,
    596,    7050,   -3482,  7545,   15106,  6028,   7627,   -9552,  18562,
    -8369,  3243,   20794,  -1047,  -4420,  -8086,  16029,  -5784,  12030,
    7609,   -8411,  -18719, 13257,  4778,   -27569, -15251, 17130,  -11134,
    -21618, -17851, 9257,   -12169, 8766,   -2131,  -30212, -10755, 8417,
    -15697, 27151,  -25861, -18341, 6148,   1777,   -31337, 3535,   18077,
    -22872, 18849,  6915,   2796,   -12382, -20928, 16540,  18884,  -10732,
    -21705, 28928,  -7075,  12351,  9252,   4094};
const int16_t i16_b_m4_tp[] = {
    20102,  26197,  -17851, -27215, 10883,  9257,   -31002, -9838, -12169,
    -28440, 3135,   8766,   -2386,  596,    -2131,  30711,  7050,  -30212,
    -11415, -3482,  -10755, 20182,  7545,   8417,   19510,  15106, -15697,
    -16452, 6028,   27151,  -22675, 7627,   -25861, 13145,  -9552, -18341,
    -2468,  18562,  6148,   -1655,  -8369,  1777,   -9060,  3243,  -31337,
    -3465,  20794,  3535,   17535,  -1047,  18077,  6498,   -4420, -22872,
    27711,  -8086,  18849,  19180,  16029,  6915,   25371,  -5784, 2796,
    -32615, 12030,  -12382, -8355,  7609,   -20928, -24201, -8411, 16540,
    12672,  -18719, 18884,  -17268, 13257,  -10732, -10362, 4778,  -21705,
    19964,  -27569, 28928,  -3301,  -15251, -7075,  -29596, 17130, 12351,
    8157,   -11134, 9252,   -16368, -21618, 4094};
const uint16_t u16_b_m4[] = {
    1539,  31233, 42125, 28491, 33904, 29019, 61963, 6799,  24694, 61461, 32663,
    48980, 28200, 6065,  15857, 44481, 51175, 49660, 14327, 50356, 39126, 26129,
    55005, 22873, 2783,  31549, 14179, 30298, 52346, 50799, 49162, 27912, 58087,
    30933, 40818, 45274, 53685, 60374, 32709, 34548, 13456, 60776, 10770, 7220,
    3938,  2214,  44460, 62826, 26860, 47045, 46895, 60550, 40488, 14876, 59273,
    39614, 45377, 34213, 813,   26989, 43533, 53150, 48107, 6100,  18258, 51086,
    20334, 55978, 42783, 43326, 48113, 11639, 42703, 1589,  3309,  36252, 52424,
    63040, 29008, 65491, 55136, 51754, 49343, 16088, 39747, 19682, 24708, 51817,
    22607, 53000, 63100, 28699, 5410,  9088,  2814,  45088};
const uint16_t u16_b_m4_tp[] = {
    1539,  58087, 18258, 31233, 30933, 51086, 42125, 40818, 20334, 28491, 45274,
    55978, 33904, 53685, 42783, 29019, 60374, 43326, 61963, 32709, 48113, 6799,
    34548, 11639, 24694, 13456, 42703, 61461, 60776, 1589,  32663, 10770, 3309,
    48980, 7220,  36252, 28200, 3938,  52424, 6065,  2214,  63040, 15857, 44460,
    29008, 44481, 62826, 65491, 51175, 26860, 55136, 49660, 47045, 51754, 14327,
    46895, 49343, 50356, 60550, 16088, 39126, 40488, 39747, 26129, 14876, 19682,
    55005, 59273, 24708, 22873, 39614, 51817, 2783,  45377, 22607, 31549, 34213,
    53000, 14179, 813,   63100, 30298, 26989, 28699, 52346, 43533, 5410,  50799,
    53150, 9088,  49162, 48107, 2814,  27912, 6100,  45088};
const fp16_t fp16_b_m4[] = {
    -58880., 21344.,  42656.,  60960.,  -31872., -44416., -36864., -5092.,
    49184.,  -64800., 25584.,  42976.,  -9088.,  -40192., 18032.,  -10968.,
    30192.,  58656.,  65376.,  6560.,   -30240., 53824.,  -13832., 47776.,
    -21152., -31600., 43104.,  -34272., -48832., -43552., -23088., 47712.,
    -53824., 21648.,  32336.,  16264.,  48224.,  -33408., -10512., 46272.,
    38848.,  53920.,  -24528., 55712.,  -26560., 55616.,  -15728., -43136.,
    51200.,  41664.,  -38880., 56544.,  57120.,  -25184., 18544.,  62496.,
    6928.,   38592.,  554.,    -55776., -22048., 49248.,  -12184., -33056.,
    -19744., -42752., -7776.,  63552.,  30176.,  -31296., -61952., 9952.,
    9080.,   50400.,  -8352.,  -30672., -4312.,  -45920., 6344.,   -10016.,
    -48960., 57056.,  -16216., 54496.,  -20096., 20144.,  -25760., -22560.,
    -46304., 4432.,   62016.,  -37984., -63552., 60800.,  -52352., -48064.};
const fp16_t fp16_b_m4_tp[] = {
    -58880., -53824., -19744., 21344.,  21648.,  -42752., 42656.,  32336.,
    -7776.,  60960.,  16264.,  63552.,  -31872., 48224.,  30176.,  -44416.,
    -33408., -31296., -36864., -10512., -61952., -5092.,  46272.,  9952.,
    49184.,  38848.,  9080.,   -64800., 53920.,  50400.,  25584.,  -24528.,
    -8352.,  42976.,  55712.,  -30672., -9088.,  -26560., -4312.,  -40192.,
    55616.,  -45920., 18032.,  -15728., 6344.,   -10968., -43136., -10016.,
    30192.,  51200.,  -48960., 58656.,  41664.,  57056.,  65376.,  -38880.,
    -16216., 6560.,   56544.,  54496.,  -30240., 57120.,  -20096., 53824.,
    -25184., 20144.,  -13832., 18544.,  -25760., 47776.,  62496.,  -22560.,
    -21152., 6928.,   -46304., -31600., 38592.,  4432.,   43104.,  554.,
    62016.,  -34272., -55776., -37984., -48832., -22048., -63552., -43552.,
    49248.,  60800.,  -23088., -12184., -52352., 47712.,  -33056., -48064.};
// [4, 16]
const int32_t i32_b_m4[] = {
    1742150944,  539521583,   984645535,  -1944610927, 301795990,   670221795,
    1882668348,  1641410073,  -667702095, -483211889,  990194069,   -676166963,
    -1402283890, -1412270369, 1364190376, -20013392,   1555272405,  2108131729,
    -2085599653, -101906096,  29333899,   -1061020810, 275113473,   -300582344,
    1323066166,  1043487280,  113360074,  460605322,   704898655,   938380306,
    612776420,   406626982,   -292543660, 1650542111,  -1571879729, 1825502835,
    1373022847,  -834571242,  1329864232, 1545707205,  309065006,   -1910035390,
    -1265194007, -1592130783, 1575439270, 213759884,   -1205085244, -428140743,
    -924233844,  -317357114,  523241847,  -1665586554, -405196701,  996994762,
    -1772310337, 759971179,   -278078262, 48094343,    -1710181301, 366159143,
    660480125,   -435526049,  1303028958, -1085753101};
const int32_t i32_b_m4_tp[] = {
    1742150944,  1555272405,  -292543660,  -924233844,  539521583,   2108131729,
    1650542111,  -317357114,  984645535,   -2085599653, -1571879729, 523241847,
    -1944610927, -101906096,  1825502835,  -1665586554, 301795990,   29333899,
    1373022847,  -405196701,  670221795,   -1061020810, -834571242,  996994762,
    1882668348,  275113473,   1329864232,  -1772310337, 1641410073,  -300582344,
    1545707205,  759971179,   -667702095,  1323066166,  309065006,   -278078262,
    -483211889,  1043487280,  -1910035390, 48094343,    990194069,   113360074,
    -1265194007, -1710181301, -676166963,  460605322,   -1592130783, 366159143,
    -1402283890, 704898655,   1575439270,  660480125,   -1412270369, 938380306,
    213759884,   -435526049,  1364190376,  612776420,   -1205085244, 1303028958,
    -20013392,   406626982,   -428140743,  -1085753101};
const uint32_t u32_b_m4[] = {
    3679954677, 1709684800, 1430939764, 957162854,  3313105459, 1119023615,
    1687683137, 853033522,  1475366927, 3740550677, 4165510785, 1277054798,
    652632808,  1421500843, 2842331589, 638934558,  2189499944, 2244541648,
    3636507474, 1562595741, 1533845535, 3866417980, 4200052257, 146973060,
    3351914962, 175819954,  2504410154, 1490245331, 3408537067, 44093867,
    764452816,  1307903280, 3974103733, 1064341536, 2207676431, 1430214331,
    1803381405, 2202081662, 465662841,  4041194991, 2464622661, 2469093936,
    3898686072, 3392545314, 2889744762, 2172425353, 1843791492, 4015026101,
    2552750213, 3263632396, 3054305793, 1084299965, 4145673013, 616609768,
    754474080,  927381659,  1010293536, 266821640,  3492023540, 3802753668,
    3882364369, 671132302,  3453088760, 1459814909};
const uint32_t u32_b_m4_tp[] = {
    3679954677, 2189499944, 3974103733, 2552750213, 1709684800, 2244541648,
    1064341536, 3263632396, 1430939764, 3636507474, 2207676431, 3054305793,
    957162854,  1562595741, 1430214331, 1084299965, 3313105459, 1533845535,
    1803381405, 4145673013, 1119023615, 3866417980, 2202081662, 616609768,
    1687683137, 4200052257, 465662841,  754474080,  853033522,  146973060,
    4041194991, 927381659,  1475366927, 3351914962, 2464622661, 1010293536,
    3740550677, 175819954,  2469093936, 266821640,  4165510785, 2504410154,
    3898686072, 3492023540, 1277054798, 1490245331, 3392545314, 3802753668,
    652632808,  3408537067, 2889744762, 3882364369, 1421500843, 44093867,
    2172425353, 671132302,  2842331589, 764452816,  1843791492, 3453088760,
    638934558,  1307903280, 4015026101, 1459814909};
const fp32_t fp32_b_m4[] = {
    -1.5345240e+38, 6.0076056e+37,  1.3128271e+38,  -9.5613642e+37,
    1.6728474e+38,  -1.4731844e+38, 6.6496199e+37,  2.3714686e+38,
    3.0700992e+37,  8.3485278e+37,  -3.5136042e+37, -2.7403779e+38,
    -8.3728464e+37, -2.9499773e+38, -6.5581229e+37, 3.3829889e+38,
    1.8098321e+38,  3.0126899e+38,  -2.6254527e+38, -2.7432614e+38,
    2.8469879e+38,  2.4199732e+38,  -5.9066953e+36, -3.3710774e+38,
    3.1139160e+38,  1.7171600e+37,  1.3101155e+38,  1.0763651e+38,
    -1.5703526e+38, 1.3972713e+38,  -1.9663439e+38, 2.0242616e+37,
    -2.6940707e+38, 2.7848330e+38,  -1.6838857e+38, 2.4384174e+38,
    3.2238237e+38,  7.0829932e+37,  -2.8725028e+38, 2.4365825e+38,
    2.5256575e+38,  -3.1845282e+38, -6.3829615e+37, 5.1849627e+37,
    4.0243188e+37,  3.9952635e+37,  -2.7563253e+38, 3.3889710e+38,
    -2.9753200e+38, -5.3635463e+37, 2.8651116e+38,  1.3317912e+38,
    1.3543794e+38,  -2.4025023e+38, 2.5003641e+38,  3.9002975e+37,
    -1.1653768e+38, -7.0229273e+37, 3.2971191e+38,  5.4586733e+36,
    3.2396912e+38,  -2.7248754e+38, -2.9746693e+38, -2.9891396e+38};
const fp32_t fp32_b_m4_tp[] = {
    -1.5345240e+38, 1.8098321e+38,  -2.6940707e+38, -2.9753200e+38,
    6.0076056e+37,  3.0126899e+38,  2.7848330e+38,  -5.3635463e+37,
    1.3128271e+38,  -2.6254527e+38, -1.6838857e+38, 2.8651116e+38,
    -9.5613642e+37, -2.7432614e+38, 2.4384174e+38,  1.3317912e+38,
    1.6728474e+38,  2.8469879e+38,  3.2238237e+38,  1.3543794e+38,
    -1.4731844e+38, 2.4199732e+38,  7.0829932e+37,  -2.4025023e+38,
    6.6496199e+37,  -5.9066953e+36, -2.8725028e+38, 2.5003641e+38,
    2.3714686e+38,  -3.3710774e+38, 2.4365825e+38,  3.9002975e+37,
    3.0700992e+37,  3.1139160e+38,  2.5256575e+38,  -1.1653768e+38,
    8.3485278e+37,  1.7171600e+37,  -3.1845282e+38, -7.0229273e+37,
    -3.5136042e+37, 1.3101155e+38,  -6.3829615e+37, 3.2971191e+38,
    -2.7403779e+38, 1.0763651e+38,  5.1849627e+37,  5.4586733e+36,
    -8.3728464e+37, -1.5703526e+38, 4.0243188e+37,  3.2396912e+38,
    -2.9499773e+38, 1.3972713e+38,  3.9952635e+37,  -2.7248754e+38,
    -6.5581229e+37, -1.9663439e+38, -2.7563253e+38, -2.9746693e+38,
    3.3829889e+38,  2.0242616e+37,  3.3889710e+38,  -2.9891396e+38};
// [5, 8]
const int64_t i64_b_m4[] = {
    -7484291480182972497, 15379515606192637,    -7457710115014886173,
    -5456823920578708624, 8771141286835953792,  4202787127440643725,
    -6304444077481729724, 2626238175685698165,  -5473121163646790792,
    5634525509189980838,  4230489288718355494,  1368863551712195620,
    9201049997826540019,  -340454196286566320,  8580989952812062285,
    -2155858317175735511, -4538972533226136837, 1063295191763423550,
    717576696914274431,   -2799532595791762196, -7450149621902552682,
    -2244669182848006402, 216868766124393225,   -8647750457301493078,
    1430227414866316154,  8560855572259907609,  -3740319242291250986,
    4415905332433568184,  -5464271914251573990, 1968148351417284957,
    6052718066167025601,  -8139785636299902958};
const int64_t i64_b_m4_tp[] = {
    -7484291480182972497, -5473121163646790792, -4538972533226136837,
    1430227414866316154,  15379515606192637,    5634525509189980838,
    1063295191763423550,  8560855572259907609,  -7457710115014886173,
    4230489288718355494,  717576696914274431,   -3740319242291250986,
    -5456823920578708624, 1368863551712195620,  -2799532595791762196,
    4415905332433568184,  8771141286835953792,  9201049997826540019,
    -7450149621902552682, -5464271914251573990, 4202787127440643725,
    -340454196286566320,  -2244669182848006402, 1968148351417284957,
    -6304444077481729724, 8580989952812062285,  216868766124393225,
    6052718066167025601,  2626238175685698165,  -2155858317175735511,
    -8647750457301493078, -8139785636299902958};
const uint64_t u64_b_m4[] = {
    4507827801037123677,  8554216129825400862,  5611779033226745648,
    11523167804950100271, 1119921359715481469,  6529412501673384349,
    7224829739010064243,  10556731338484449752, 18417250942024473046,
    7308015957082166666,  7267530633505600219,  3818691627463430630,
    12997643298187341372, 5924609618150531738,  9647516763804551981,
    11306868951906735726, 16682994587695182711, 13452685312758028190,
    7056170515180687490,  7598369532347019656,  3090570777413184498,
    11898747785538714418, 9588959411153094689,  12467816796214741177,
    2083153965220250766,  18317338633099964165, 626391998157895073,
    18092856115215819830, 1368361589867780975,  13727669096589900275,
    5494902879968299569,  15382306237144265445};
const uint64_t u64_b_m4_tp[] = {
    4507827801037123677,  18417250942024473046, 16682994587695182711,
    2083153965220250766,  8554216129825400862,  7308015957082166666,
    13452685312758028190, 18317338633099964165, 5611779033226745648,
    7267530633505600219,  7056170515180687490,  626391998157895073,
    11523167804950100271, 3818691627463430630,  7598369532347019656,
    18092856115215819830, 1119921359715481469,  12997643298187341372,
    3090570777413184498,  1368361589867780975,  6529412501673384349,
    5924609618150531738,  11898747785538714418, 13727669096589900275,
    7224829739010064243,  9647516763804551981,  9588959411153094689,
    5494902879968299569,  10556731338484449752, 11306868951906735726,
    12467816796214741177, 15382306237144265445};
const fp64_t fp64_b_m4[] = {
    1.07031746e+306,  -3.33615576e+305, 1.04752983e+306,  9.60114699e+304,
    -1.58893013e+306, 7.52565285e+305,  -5.67107127e+305, 1.24995504e+305,
    -8.54708805e+305, -1.73230307e+306, 6.09353057e+305,  -1.50660606e+306,
    -1.36603131e+306, -7.15047383e+305, 1.15261487e+306,  -1.02061943e+306,
    -8.76225873e+305, 2.59731068e+305,  1.02209261e+306,  6.84233287e+304,
    -9.68311107e+305, -2.17886602e+305, 1.05291216e+306,  4.19807844e+305,
    3.25652208e+305,  -9.96781794e+305, 3.84026227e+305,  -1.76421943e+306,
    -2.53744001e+305, 6.24900471e+305,  -1.79261242e+306, 1.37399854e+306,
    -1.19984555e+306, 3.15335736e+305,  4.17144004e+305,  1.58178686e+306,
    -5.36870360e+305, 1.42267585e+306,  3.89526766e+305,  1.66690364e+306};
const fp64_t fp64_b_m4_tp[] = {
    1.07031746e+306,  -8.54708805e+305, -8.76225873e+305, 3.25652208e+305,
    -1.19984555e+306, -3.33615576e+305, -1.73230307e+306, 2.59731068e+305,
    -9.96781794e+305, 3.15335736e+305,  1.04752983e+306,  6.09353057e+305,
    1.02209261e+306,  3.84026227e+305,  4.17144004e+305,  9.60114699e+304,
    -1.50660606e+306, 6.84233287e+304,  -1.76421943e+306, 1.58178686e+306,
    -1.58893013e+306, -1.36603131e+306, -9.68311107e+305, -2.53744001e+305,
    -5.36870360e+305, 7.52565285e+305,  -7.15047383e+305, -2.17886602e+305,
    6.24900471e+305,  1.42267585e+306,  -5.67107127e+305, 1.15261487e+306,
    1.05291216e+306,  -1.79261242e+306, 3.89526766e+305,  1.24995504e+305,
    -1.02061943e+306, 4.19807844e+305,  1.37399854e+306,  1.66690364e+306};

const uint8_t u8_rs1_m2[] = {
    214, 247, 170, 183, 234, 22,  252, 171, 228, 147, 203, 10,  15,
    159, 234, 153, 247, 87,  92,  186, 27,  143, 67,  17,  254, 135,
    186, 28,  180, 60,  183, 64,  167, 82,  227, 247, 114, 151, 85,
    22,  110, 100, 21,  42,  97,  203, 152, 37,  108, 237, 57,  221,
    93,  217, 158, 131, 134, 140, 96,  68,  92,  170, 206, 239};
const uint8_t u8_rs1_m2_tp[] = {
    214, 228, 247, 254, 167, 110, 108, 134, 247, 147, 87,  135, 82,
    100, 237, 140, 170, 203, 92,  186, 227, 21,  57,  96,  183, 10,
    186, 28,  247, 42,  221, 68,  234, 15,  27,  180, 114, 97,  93,
    92,  22,  159, 143, 60,  151, 203, 217, 170, 252, 234, 67,  183,
    85,  152, 158, 206, 171, 153, 17,  64,  22,  37,  131, 239};
const int8_t i8_rs1_m2[] = {
    59,  116, 84,  4,   -126, -45, -59, 7,   -65, -29,  68,  -45, 124,
    19,  -24, -14, -49, -120, -21, -27, 2,   -26, -25,  42,  6,   24,
    -59, 51,  53,  45,  -57,  -69, 72,  3,   100, 16,   22,  101, 77,
    8,   43,  -19, 3,   -49,  70,  -54, 32,  49,  118,  -82, 20,  91,
    104, -49, 73,  75,  -60,  1,   45,  -39, 38,  -127, 99,  -63};
const int8_t i8_rs1_m2_tp[] = {
    59,  -65, -49, 6,   72, 43,  118,  -60, 116,  -29, -120, 24,  3,
    -19, -82, 1,   84,  68, -21, -59,  100, 3,    20,  45,   4,   -45,
    -27, 51,  16,  -49, 91, -39, -126, 124, 2,    53,  22,   70,  104,
    38,  -45, 19,  -26, 45, 101, -54,  -49, -127, -59, -24,  -25, -57,
    77,  32,  73,  99,  7,  -14, 42,   -69, 8,    49,  75,   -63};
const int16_t i16_rs1_m2[] = {
    -24647, 25854,  -20596, 22389,  4719,  15818,  -13188, 12178,
    13742,  -1211,  3049,   8849,   21116, 20803,  -9466,  -700,
    30459,  -12195, 29060,  -8297,  7693,  2639,   16595,  -26983,
    31113,  -3454,  2106,   -26484, 28026, -9804,  30194,  -12219,
    27954,  -15746, -2354,  5764,   32603, -14593, -10597, 29327,
    -24446, 21144,  32764,  -13071, 17476, 13423,  -13596, 24092,
    -18276, 6923,   -6496,  -30078, 6552,  -9403,  -11488, 15006,
    11832,  2375,   -21082, -5632,  3664,  -32397, 1729,   -5772};
const int16_t i16_rs1_m2_tp[] = {
    -24647, 13742, 30459,  31113,  27954,  -24446, -18276, 11832,
    25854,  -1211, -12195, -3454,  -15746, 21144,  6923,   2375,
    -20596, 3049,  29060,  2106,   -2354,  32764,  -6496,  -21082,
    22389,  8849,  -8297,  -26484, 5764,   -13071, -30078, -5632,
    4719,   21116, 7693,   28026,  32603,  17476,  6552,   3664,
    15818,  20803, 2639,   -9804,  -14593, 13423,  -9403,  -32397,
    -13188, -9466, 16595,  30194,  -10597, -13596, -11488, 1729,
    12178,  -700,  -26983, -12219, 29327,  24092,  15006,  -5772};
const uint16_t u16_rs1_m2[] = {
    31729, 30115, 38967, 64862, 36019, 10670, 2363,  44235, 9832,  54599, 577,
    25199, 60494, 29479, 1778,  32628, 7595,  57625, 20770, 59089, 6065,  46111,
    39886, 32107, 25466, 54335, 26940, 10550, 12357, 46468, 58094, 35855, 55468,
    48367, 62000, 10715, 8975,  32877, 18981, 13516, 35293, 8062,  14883, 42807,
    4984,  64007, 52968, 44624, 10915, 59533, 52911, 22248, 11738, 54311, 46469,
    692,   19928, 9535,  23280, 63598, 4665,  28164, 11736, 14241};
const uint16_t u16_rs1_m2_tp[] = {
    31729, 9832,  7595,  25466, 55468, 35293, 10915, 19928, 30115, 54599, 57625,
    54335, 48367, 8062,  59533, 9535,  38967, 577,   20770, 26940, 62000, 14883,
    52911, 23280, 64862, 25199, 59089, 10550, 10715, 42807, 22248, 63598, 36019,
    60494, 6065,  12357, 8975,  4984,  11738, 4665,  10670, 29479, 46111, 46468,
    32877, 64007, 54311, 28164, 2363,  1778,  39886, 58094, 18981, 52968, 46469,
    11736, 44235, 32628, 32107, 35855, 13516, 44624, 692,   14241};
const fp16_t fp16_rs1_m2[] = {
    8.04426574,  4.85517387,  -6.03162345, -0.54080017, -5.53110902,
    -0.33242081, 1.20322386,  -3.9156482,  -3.42409931, -5.87383733,
    5.78922411,  -3.88743634, 1.75111207,  3.38265942,  0.07025911,
    9.0806965,   7.07878566,  1.36989383,  -0.03256515, 1.20698213,
    6.49990727,  6.74799553,  -2.7170786,  -9.72158365, 0.38021985,
    -2.31474992, -9.72952552, -7.06756293, -8.18516661, 7.38433584,
    -5.24337304, 3.44033404,  -9.97051772, 3.12895744,  -2.61952641,
    -6.41413117, -3.49349221, -7.28481953, -9.59078352, 5.50309448,
    -5.78971172, 1.86954698,  5.08323938,  -1.66315843, 5.03936974,
    3.48705672,  4.04438921,  -3.0969378,  -7.00766777, -1.74556456,
    5.35331916,  7.65696261,  3.75578339,  3.16738137,  -7.4614684,
    -0.47829585, 8.64535749,  5.93197182,  4.33920813,  -2.63018082,
    1.26934137,  1.28313406,  -0.18655563, -4.64656408};
const fp16_t fp16_rs1_m2_tp[] = {
    8.04426574,  -3.42409931, 7.07878566,  0.38021985,  -9.97051772,
    -5.78971172, -7.00766777, 8.64535749,  4.85517387,  -5.87383733,
    1.36989383,  -2.31474992, 3.12895744,  1.86954698,  -1.74556456,
    5.93197182,  -6.03162345, 5.78922411,  -0.03256515, -9.72952552,
    -2.61952641, 5.08323938,  5.35331916,  4.33920813,  -0.54080017,
    -3.88743634, 1.20698213,  -7.06756293, -6.41413117, -1.66315843,
    7.65696261,  -2.63018082, -5.53110902, 1.75111207,  6.49990727,
    -8.18516661, -3.49349221, 5.03936974,  3.75578339,  1.26934137,
    -0.33242081, 3.38265942,  6.74799553,  7.38433584,  -7.28481953,
    3.48705672,  3.16738137,  1.28313406,  1.20322386,  0.07025911,
    -2.7170786,  -5.24337304, -9.59078352, 4.04438921,  -7.4614684,
    -0.18655563, -3.9156482,  9.0806965,   -9.72158365, 3.44033404,
    5.50309448,  -3.0969378,  -0.47829585, -4.64656408};
const int32_t i32_rs1_m2[] = {
    -1172872110, -542302858,  -152217906, -597710611, -2086798997, 364084106,
    -1846093441, 1007626198,  348202922,  -214119097, 1456809411,  1974387600,
    814934293,   -1455662292, -282532614, -1894226333};
const int32_t i32_rs1_m2_tp[] = {
    -1172872110, -2086798997, 348202922,  814934293,   -542302858, 364084106,
    -214119097,  -1455662292, -152217906, -1846093441, 1456809411, -282532614,
    -597710611,  1007626198,  1974387600, -1894226333};
const uint32_t u32_rs1_m2[] = {4126465962, 3966685382, 360563397,  2285304584,
                               145753956,  2229791898, 2112742006, 627738651,
                               4024790042, 55730863,   2840986599, 2106059612,
                               1583600997, 3683884727, 1039347349, 3916936588};
const uint32_t u32_rs1_m2_tp[] = {
    4126465962, 145753956,  4024790042, 1583600997, 3966685382, 2229791898,
    55730863,   3683884727, 360563397,  2112742006, 2840986599, 1039347349,
    2285304584, 627738651,  2106059612, 3916936588};
const fp32_t fp32_rs1_m2[] = {
    -9.16278403, -1.49313265, -2.26454497, 7.34858267, -0.78221233, 6.75881454,
    -5.04976764, -9.49817093, 0.46260961,  3.79709828, -8.54421692, -0.55067725,
    -2.56794258, -7.7069743,  4.21791779,  7.46360441};
const fp32_t fp32_rs1_m2_tp[] = {
    -9.16278403, -0.78221233, 0.46260961,  -2.56794258, -1.49313265, 6.75881454,
    3.79709828,  -7.7069743,  -2.26454497, -5.04976764, -8.54421692, 4.21791779,
    7.34858267,  -9.49817093, -0.55067725, 7.46360441};
// 2 x 2
const int64_t i64_rs1_m2[] = {1042330047, -2099544644, 242361902, 37793366};
const int64_t i64_rs1_m2_tp[] = {1042330047, 242361902, -2099544644, 37793366};
const uint64_t u64_rs1_m2[] = {4866034294274352918, 3154386358101889683,
                               748724526342031250, 3610332686078213458};
const uint64_t u64_rs1_m2_tp[] = {4866034294274352918, 748724526342031250,
                                  3154386358101889683, 3610332686078213458};
const fp64_t fp64_rs1_m2[] = {823.7411394, 827.9716114, 289.65507996,
                              759.68804021};
const fp64_t fp64_rs1_m2_tp[] = {823.7411394, 289.65507996, 827.9716114,
                                 759.68804021};

static void test_mlae() {
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileki(2);

  msettype(E8, M1, BA);
  mint8m1_t i8_td = mlae8_m1(i8_rs1, 2 * sizeof(int8_t));
  msae8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1, i8_buffer, 4, " MLAE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlae16_m1(i16_rs1, 2 * sizeof(int16_t));
  msae16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1, i16_buffer, 4, " MLAE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlae32_m1(i32_rs1, 2 * sizeof(int32_t));
  msae32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1, i32_buffer, 4, " MLAE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlae64_m1(i64_rs1, 2 * sizeof(int64_t));
  msae64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1, i64_buffer, 4, " MLAE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlae8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msae8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1, u8_buffer, 4, " MLAE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlae16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msae16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1, u16_buffer, 4, " MLAE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlae32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msae32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1, u32_buffer, 4, " MLAE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlae64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msae64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1, u64_buffer, 4, " MLAE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlae16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msae16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1, fp16_buffer, 4, " MLAE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlae32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msae32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1, fp32_buffer, 4, " MLAE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlae64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msae64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1, fp64_buffer, 4, " MLAE FP64   M1");

  // M2
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileki(16);
  mint8m2_t i8_td_m2 = mlae8_m2(i8_a_m2, 16 * sizeof(int8_t));
  msae8_m(i8_td_m2, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_a_m2, i8_buffer, 2 * 16, " MLAE INT8   M2");

  msettype(E8, M2, BA);
  msettilemi(2);
  msettileki(16);
  muint8m2_t u8_td_m2 = mlae8_m2(u8_a_m2, 16 * sizeof(uint8_t));
  msae8_m(u8_td_m2, u8_buffer, 16 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_a_m2, u8_buffer, 2 * 16, " MLAE UINT8  M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileki(8);
  mint16m2_t i16_td_m2 = mlae16_m2(i16_a_m2, 8 * sizeof(int16_t));
  msae16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_a_m2, i16_buffer, 3 * 8, " MLAE INT16  M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileki(8);
  muint16m2_t u16_td_m2 = mlae16_m2(u16_a_m2, 8 * sizeof(uint16_t));
  msae16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_a_m2, u16_buffer, 3 * 8, " MLAE UINT16 M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileki(8);
  mfloat16m2_t fp16_td_m2 = mlae16_m2(fp16_a_m2, 8 * sizeof(fp16_t));
  msae16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_a_m2, fp16_buffer, 3 * 8, " MLAE FP16   M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mint32m2_t i32_td_m2 = mlae32_m2(i32_a_m2, 4 * sizeof(int32_t));
  msae32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_a_m2, i32_buffer, 4 * 4, " MLAE INT32  M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  muint32m2_t u32_td_m2 = mlae32_m2(u32_a_m2, 4 * sizeof(uint32_t));
  msae32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_a_m2, u32_buffer, 4 * 4, " MLAE UINT32 M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mfloat32m2_t fp32_td_m2 = mlae32_m2(fp32_a_m2, 4 * sizeof(fp32_t));
  msae32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_a_m2, fp32_buffer, 4 * 4, " MLAE FP32   M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileki(2);
  mint64m2_t i64_td_m2 = mlae64_m2(i64_a_m2, 2 * sizeof(int64_t));
  msae64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_a_m2, i64_buffer, 5 * 2, " MLAE INT64  M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileki(2);
  muint64m2_t u64_td_m2 = mlae64_m2(u64_a_m2, 2 * sizeof(uint64_t));
  msae64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_a_m2, u64_buffer, 5 * 2, " MLAE UINT64 M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileki(2);
  mfloat64m2_t fp64_td_m2 = mlae64_m2(fp64_a_m2, 2 * sizeof(fp64_t));
  msae64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_a_m2, fp64_buffer, 5 * 2, " MLAE FP64   M2");

  // M4
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileki(32);
  mint8m4_t i8_td_m4 = mlae8_m4(i8_a_m4, 32 * sizeof(int8_t));
  msae8_m(i8_td_m4, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_a_m4, i8_buffer, 2 * 32, " MLAE INT8   M4");

  msettype(E8, M4, BA);
  msettilemi(2);
  msettileki(32);
  muint8m4_t u8_td_m4 = mlae8_m4(u8_a_m4, 32 * sizeof(uint8_t));
  msae8_m(u8_td_m4, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_a_m4, u8_buffer, 2 * 32, " MLAE UINT8  M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileki(16);
  mint16m4_t i16_td_m4 = mlae16_m4(i16_a_m4, 16 * sizeof(int16_t));
  msae16_m(i16_td_m4, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_a_m4, i16_buffer, 3 * 16, " MLAE INT16  M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileki(16);
  muint16m4_t u16_td_m4 = mlae16_m4(u16_a_m4, 16 * sizeof(uint16_t));
  msae16_m(u16_td_m4, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_a_m4, u16_buffer, 3 * 16, " MLAE UINT16 M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileki(16);
  mfloat16m4_t fp16_td_m4 = mlae16_m4(fp16_a_m4, 16 * sizeof(fp16_t));
  msae16_m(fp16_td_m4, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_a_m4, fp16_buffer, 3 * 16, " MLAE FP16   M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(8);
  mint32m4_t i32_td_m4 = mlae32_m4(i32_a_m4, 8 * sizeof(int32_t));
  msae32_m(i32_td_m4, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_a_m4, i32_buffer, 4 * 8, " MLAE INT32  M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(8);
  muint32m4_t u32_td_m4 = mlae32_m4(u32_a_m4, 8 * sizeof(uint32_t));
  msae32_m(u32_td_m4, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_a_m4, u32_buffer, 4 * 8, " MLAE UINT32 M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(8);
  mfloat32m4_t fp32_td_m4 = mlae32_m4(fp32_a_m4, 8 * sizeof(fp32_t));
  msae32_m(fp32_td_m4, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_a_m4, fp32_buffer, 4 * 8, " MLAE FP32   M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileki(4);
  mint64m4_t i64_td_m4 = mlae64_m4(i64_a_m4, 4 * sizeof(int64_t));
  msae64_m(i64_td_m4, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_a_m4, i64_buffer, 5 * 4, " MLAE INT64  M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileki(4);
  muint64m4_t u64_td_m4 = mlae64_m4(u64_a_m4, 4 * sizeof(uint64_t));
  msae64_m(u64_td_m4, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_a_m4, u64_buffer, 5 * 4, " MLAE UINT64 M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileki(4);
  mfloat64m4_t fp64_td_m4 = mlae64_m4(fp64_a_m4, 4 * sizeof(fp64_t));
  msae64_m(fp64_td_m4, fp64_buffer, 4 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_a_m4, fp64_buffer, 5 * 4, " MLAE FP64   M4");
}

static void test_mlbe() {
  msettype(E8, M1, BA);
  msettileki(2);
  msettileni(2);
  mint8m1_t i8_td = mlbe8_m1(i8_rs1, 2 * sizeof(int8_t));
  msbe8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1, i8_buffer, 4, " MLBE INT8   M1");

  msettype(E16, M1, BA);
  msettileki(2);
  msettileni(2);
  mint16m1_t i16_td = mlbe16_m1(i16_rs1, 2 * sizeof(int16_t));
  msbe16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1, i16_buffer, 4, " MLBE INT16  M1");

  msettype(E32, M1, BA);
  msettileki(2);
  msettileni(2);
  mint32m1_t i32_td = mlbe32_m1(i32_rs1, 2 * sizeof(int32_t));
  msbe32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1, i32_buffer, 4, " MLBE INT32  M1");

  msettype(E64, M1, BA);
  msettileki(2);
  msettileni(2);
  mint64m1_t i64_td = mlbe64_m1(i64_rs1, 2 * sizeof(int64_t));
  msbe64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1, i64_buffer, 4, " MLBE INT64  M1");

  msettype(E8, M1, BA);
  msettileki(2);
  msettileni(2);
  muint8m1_t u8_td = mlbe8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msbe8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1, u8_buffer, 4, " MLBE UINT8  M1");

  msettype(E16, M1, BA);
  msettileki(2);
  msettileni(2);
  muint16m1_t u16_td = mlbe16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msbe16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1, u16_buffer, 4, " MLBE UINT16 M1");

  msettype(E32, M1, BA);
  msettileki(2);
  msettileni(2);
  muint32m1_t u32_td = mlbe32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msbe32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1, u32_buffer, 4, " MLBE UINT32 M1");

  msettype(E64, M1, BA);
  msettileki(2);
  msettileni(2);
  muint64m1_t u64_td = mlbe64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msbe64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1, u64_buffer, 4, " MLBE UINT64 M1");

  msettype(E16, M1, BA);
  msettileki(2);
  msettileni(2);
  mfloat16m1_t fp16_td = mlbe16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msbe16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1, fp16_buffer, 4, "MLBE FP16   M1");

  msettype(E32, M1, BA);
  msettileki(2);
  msettileni(2);
  mfloat32m1_t fp32_td = mlbe32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msbe32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1, fp32_buffer, 4, "MLBE FP32   M1");

  msettype(E64, M1, BA);
  msettileki(2);
  msettileni(2);
  mfloat64m1_t fp64_td = mlbe64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msbe64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1, fp64_buffer, 4, "MLBE FP64   M1");

  // M2
  msettype(E8, M2, BA);
  msettileki(2);
  msettileni(32);
  mint8m2_t i8_td_m2 = mlbe8_m2(i8_b_m2, 32 * sizeof(int8_t));
  msbe8_m(i8_td_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_b_m2, i8_buffer, 2 * 32, "MLBE INT8   M2");

  msettype(E8, M2, BA);
  msettileki(2);
  msettileni(32);
  muint8m2_t u8_td_m2 = mlbe8_m2(u8_b_m2, 32 * sizeof(uint8_t));
  msbe8_m(u8_td_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_b_m2, u8_buffer, 2 * 32, "MLBE UINT8  M2");

  msettype(E16, M2, BA);
  msettileki(3);
  msettileni(16);
  mint16m2_t i16_td_m2 = mlbe16_m2(i16_b_m2, 16 * sizeof(int16_t));
  msbe16_m(i16_td_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_b_m2, i16_buffer, 3 * 16, "MLBE INT16  M2");

  msettype(E16, M2, BA);
  msettileki(3);
  msettileni(16);
  muint16m2_t u16_td_m2 = mlbe16_m2(u16_b_m2, 16 * sizeof(uint16_t));
  msbe16_m(u16_td_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_b_m2, u16_buffer, 3 * 16, "MLBE UINT16 M2");

  msettype(E16, M2, BA);
  msettileki(3);
  msettileni(16);
  mfloat16m2_t fp16_td_m2 = mlbe16_m2(fp16_b_m2, 16 * sizeof(fp16_t));
  msbe16_m(fp16_td_m2, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_b_m2, fp16_buffer, 3 * 16, "MLBE FP16   M2");

  msettype(E32, M2, BA);
  msettileki(4);
  msettileni(8);
  mint32m2_t i32_td_m2 = mlbe32_m2(i32_b_m2, 8 * sizeof(int32_t));
  msbe32_m(i32_td_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_b_m2, i32_buffer, 4 * 8, "MLBE INT32  M2");

  msettype(E32, M2, BA);
  msettileki(4);
  msettileni(8);
  muint32m2_t u32_td_m2 = mlbe32_m2(u32_b_m2, 8 * sizeof(uint32_t));
  msbe32_m(u32_td_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_b_m2, u32_buffer, 4 * 8, "MLBE UINT32 M2");

  msettype(E32, M2, BA);
  msettileki(4);
  msettileni(8);
  mfloat32m2_t fp32_td_m2 = mlbe32_m2(fp32_b_m2, 8 * sizeof(fp32_t));
  msbe32_m(fp32_td_m2, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_b_m2, fp32_buffer, 4 * 8, "MLBE FP32   M2");

//   msettype(E64, M2, BA);
//   msettileki(5);
//   msettileni(4);
//   mint64m2_t i64_td_m2 = mlbe64_m2(i64_b_m2, 4 * sizeof(int64_t));
//   msbe64_m(i64_td_m2, i64_buffer, 4 * sizeof(int64_t));
//   EXCEPT_I64_ARRAY_EQ(i64_b_m2, i64_buffer, 5 * 4, "MLBE INT64  M2");

//   msettype(E64, M2, BA);
//   msettileki(5);
//   msettileni(4);
//   muint64m2_t u64_td_m2 = mlbe64_m2(u64_b_m2, 4 * sizeof(uint64_t));
//   msbe64_m(u64_td_m2, u64_buffer, 4 * sizeof(uint64_t));
//   EXCEPT_U64_ARRAY_EQ(u64_b_m2, u64_buffer, 5 * 4, "MLBE UINT64 M2");

//   msettype(E64, M2, BA);
//   msettileki(5);
//   msettileni(4);
//   mfloat64m2_t fp64_td_m2 = mlbe64_m2(fp64_b_m2, 4 * sizeof(fp64_t));
//   msbe64_m(fp64_td_m2, fp64_buffer, 4 * sizeof(fp64_t));
//   EXCEPT_FP64_ARRAY_EQ(fp64_b_m2, fp64_buffer, 5 * 4, "MLBE FP64   M2");

  // M4
  msettype(E8, M4, BA);
  msettileki(2);
  msettileni(64);
  mint8m4_t i8_td_m4 = mlbe8_m4(i8_b_m4, 64 * sizeof(int8_t));
  msbe8_m(i8_td_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_b_m4, i8_buffer, 2 * 64, "MLBE INT8   M4");

  msettype(E8, M4, BA);
  msettileki(2);
  msettileni(64);
  muint8m4_t u8_td_m4 = mlbe8_m4(u8_b_m4, 64 * sizeof(uint8_t));
  msbe8_m(u8_td_m4, u8_buffer, 64 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_b_m4, u8_buffer, 2 * 64, "MLBE UINT8  M4");

  msettype(E16, M4, BA);
  msettileki(3);
  msettileni(32);
  mint16m4_t i16_td_m4 = mlbe16_m4(i16_b_m4, 32 * sizeof(int16_t));
  msbe16_m(i16_td_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_b_m4, i16_buffer, 3 * 32, "MLBE INT16  M4");

  msettype(E16, M4, BA);
  msettileki(3);
  msettileni(32);
  muint16m4_t u16_td_m4 = mlbe16_m4(u16_b_m4, 32 * sizeof(uint16_t));
  msbe16_m(u16_td_m4, u16_buffer, 32 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_b_m4, u16_buffer, 3 * 32, "MLBE UINT16 M4");

  msettype(E16, M4, BA);
  msettileki(3);
  msettileni(32);
  mfloat16m4_t fp16_td_m4 = mlbe16_m4(fp16_b_m4, 32 * sizeof(fp16_t));
  msbe16_m(fp16_td_m4, fp16_buffer, 32 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_b_m4, fp16_buffer, 3 * 32, "MLBE FP16   M4");

  msettype(E32, M4, BA);
  msettileki(4);
  msettileni(16);
  mint32m4_t i32_td_m4 = mlbe32_m4(i32_b_m4, 16 * sizeof(int32_t));
  msbe32_m(i32_td_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_b_m4, i32_buffer, 4 * 16, "MLBE INT32  M4");

  msettype(E32, M4, BA);
  msettileki(4);
  msettileni(16);
  muint32m4_t u32_td_m4 = mlbe32_m4(u32_b_m4, 16 * sizeof(uint32_t));
  msbe32_m(u32_td_m4, u32_buffer, 16 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_b_m4, u32_buffer, 4 * 16, "MLBE UINT32 M4");

  msettype(E32, M4, BA);
  msettileki(4);
  msettileni(16);
  mfloat32m4_t fp32_td_m4 = mlbe32_m4(fp32_b_m4, 16 * sizeof(fp32_t));
  msbe32_m(fp32_td_m4, fp32_buffer, 16 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_b_m4, fp32_buffer, 4 * 16, "MLBE FP32   M4");

//   msettype(E64, M4, BA);
//   msettileki(5);
//   msettileni(5);
//   mint64m4_t i64_td_m4 = mlbe64_m4(i64_b_m4, 5 * sizeof(int64_t));
//   msbe64_m(i64_td_m4, i64_buffer, 5 * sizeof(int64_t));
//   EXCEPT_I64_ARRAY_EQ(i64_b_m4, i64_buffer, 5 * 5, "MLBE INT64  M4");
//   DUMP_MATRIX(i64_buffer, 5, 5, "%d");

//   msettype(E64, M4, BA);
//   msettileki(5);
//   msettileni(8);
//   muint64m4_t u64_td_m4 = mlbe64_m4(u64_b_m4, 8 * sizeof(uint64_t));
//   msbe64_m(u64_td_m4, u64_buffer, 8 * sizeof(uint64_t));
//   EXCEPT_U64_ARRAY_EQ(u64_b_m4, u64_buffer, 5 * 8, "MLBE UINT64 M4");

//   msettype(E64, M4, BA);
//   msettileki(5);
//   msettileni(8);
//   mfloat64m4_t fp64_td_m4 = mlbe64_m4(fp64_b_m4, 8 * sizeof(fp64_t));
//   msbe64_m(fp64_td_m4, fp64_buffer, 8 * sizeof(fp64_t));
//   EXCEPT_FP64_ARRAY_EQ(fp64_b_m4, fp64_buffer, 5 * 8, "MLBE FP64   M4");
}

static void test_mlce() {
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint8m1_t i8_td = mlce8_m1(i8_rs1, 2 * sizeof(int8_t));
  msce8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1, i8_buffer, 4, "MLCE INT8   M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint16m1_t i16_td = mlce16_m1(i16_rs1, 2 * sizeof(int16_t));
  msce16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1, i16_buffer, 4, "MLCE INT16  M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint32m1_t i32_td = mlce32_m1(i32_rs1, 2 * sizeof(int32_t));
  msce32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1, i32_buffer, 4, "MLCE INT32  M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint64m1_t i64_td = mlce64_m1(i64_rs1, 2 * sizeof(int64_t));
  msce64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1, i64_buffer, 4, "MLCE UINT64 M1");

  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(2);
  muint8m1_t u8_td = mlce8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msce8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1, u8_buffer, 4, "MLCE UINT8  M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileni(2);
  muint16m1_t u16_td = mlce16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msce16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1, u16_buffer, 4, "MLCE UINT16 M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileni(2);
  muint32m1_t u32_td = mlce32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msce32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1, u32_buffer, 4, "MLCE UINT32 M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileni(2);
  muint64m1_t u64_td = mlce64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msce64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1, u64_buffer, 4, "MLCE UINT64 M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileni(2);
  mfloat16m1_t fp16_td = mlce16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msce16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1, fp16_buffer, 4, "MLCE FP16   M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileni(2);
  mfloat32m1_t fp32_td = mlce32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msce32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1, fp32_buffer, 4, "MLCE FP32   M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileni(2);
  mfloat64m1_t fp64_td = mlce64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msce64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1, fp64_buffer, 4, "MLCE FP64   M1");

  // M2
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  mint8m2_t i8_td_m2 = mlce8_m2(i8_b_m2, 32 * sizeof(int8_t));
  msce8_m(i8_td_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_b_m2, i8_buffer, 2 * 32, "MLCE INT8   M2");

  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  muint8m2_t u8_td_m2 = mlce8_m2(u8_b_m2, 32 * sizeof(uint8_t));
  msce8_m(u8_td_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_b_m2, u8_buffer, 2 * 32, "MLCE UINT8  M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  mint16m2_t i16_td_m2 = mlce16_m2(i16_b_m2, 16 * sizeof(int16_t));
  msce16_m(i16_td_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_b_m2, i16_buffer, 3 * 16, "MLCE INT16  M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  muint16m2_t u16_td_m2 = mlce16_m2(u16_b_m2, 16 * sizeof(uint16_t));
  msce16_m(u16_td_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_b_m2, u16_buffer, 3 * 16, "MLCE UINT16 M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  mfloat16m2_t fp16_td_m2 = mlce16_m2(fp16_b_m2, 16 * sizeof(fp16_t));
  msce16_m(fp16_td_m2, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_b_m2, fp16_buffer, 3 * 16, "MLCE FP16   M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  mint32m2_t i32_td_m2 = mlce32_m2(i32_b_m2, 8 * sizeof(int32_t));
  msce32_m(i32_td_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_b_m2, i32_buffer, 4 * 8, "MLCE INT32  M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  muint32m2_t u32_td_m2 = mlce32_m2(u32_b_m2, 8 * sizeof(uint32_t));
  msce32_m(u32_td_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_b_m2, u32_buffer, 4 * 8, "MLCE UINT32 M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  mfloat32m2_t fp32_td_m2 = mlce32_m2(fp32_b_m2, 8 * sizeof(fp32_t));
  msce32_m(fp32_td_m2, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_b_m2, fp32_buffer, 4 * 8, "MLCE FP32   M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  mint64m2_t i64_td_m2 = mlce64_m2(i64_b_m2, 4 * sizeof(int64_t));
  msce64_m(i64_td_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_b_m2, i64_buffer, 5 * 4, "MLCE INT64  M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  muint64m2_t u64_td_m2 = mlce64_m2(u64_b_m2, 4 * sizeof(uint64_t));
  msce64_m(u64_td_m2, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_b_m2, u64_buffer, 5 * 4, "MLCE UINT64 M2");

  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  mfloat64m2_t fp64_td_m2 = mlce64_m2(fp64_b_m2, 4 * sizeof(fp64_t));
  msce64_m(fp64_td_m2, fp64_buffer, 4 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_b_m2, fp64_buffer, 5 * 4, "MLCE FP64   M2");

  // M4
  msettype(E8, M4, BA);
  msettileki(2);
  msettileni(64);
  mint8m4_t i8_td_m4 = mlce8_m4(i8_b_m4, 64 * sizeof(int8_t));
  msce8_m(i8_td_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_b_m4, i8_buffer, 2 * 64, "MLCE INT8   M4");

  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(64);
  muint8m4_t u8_td_m4 = mlce8_m4(u8_b_m4, 64 * sizeof(uint8_t));
  msce8_m(u8_td_m4, u8_buffer, 64 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_b_m4, u8_buffer, 2 * 64, "MLCE UINT8  M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(32);
  mint16m4_t i16_td_m4 = mlce16_m4(i16_b_m4, 32 * sizeof(int16_t));
  msce16_m(i16_td_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_b_m4, i16_buffer, 3 * 32, "MLCE INT16  M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(32);
  muint16m4_t u16_td_m4 = mlce16_m4(u16_b_m4, 32 * sizeof(uint16_t));
  msce16_m(u16_td_m4, u16_buffer, 32 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_b_m4, u16_buffer, 3 * 32, "MLCE UINT16 M4");

  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(32);
  mfloat16m4_t fp16_td_m4 = mlce16_m4(fp16_b_m4, 32 * sizeof(fp16_t));
  msce16_m(fp16_td_m4, fp16_buffer, 32 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_b_m4, fp16_buffer, 3 * 32, "MLCE FP16   M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(16);
  mint32m4_t i32_td_m4 = mlce32_m4(i32_b_m4, 16 * sizeof(int32_t));
  msce32_m(i32_td_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_b_m4, i32_buffer, 4 * 16, "MLCE INT32  M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(16);
  muint32m4_t u32_td_m4 = mlce32_m4(u32_b_m4, 16 * sizeof(uint32_t));
  msce32_m(u32_td_m4, u32_buffer, 16 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_b_m4, u32_buffer, 4 * 16, "MLCE UINT32 M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(16);
  mfloat32m4_t fp32_td_m4 = mlce32_m4(fp32_b_m4, 16 * sizeof(fp32_t));
  msce32_m(fp32_td_m4, fp32_buffer, 16 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_b_m4, fp32_buffer, 4 * 16, "MLCE FP32   M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(8);
  mint64m4_t i64_td_m4 = mlce64_m4(i64_b_m4, 8 * sizeof(int64_t));
  msce64_m(i64_td_m4, i64_buffer, 8 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_b_m4, i64_buffer, 5 * 8, "MLCE INT64  M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(8);
  muint64m4_t u64_td_m4 = mlce64_m4(u64_b_m4, 8 * sizeof(uint64_t));
  msce64_m(u64_td_m4, u64_buffer, 8 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_b_m4, u64_buffer, 5 * 8, "MLCE UINT64 M4");

  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(8);
  mfloat64m4_t fp64_td_m4 = mlce64_m4(fp64_b_m4, 8 * sizeof(fp64_t));
  msce64_m(fp64_td_m4, fp64_buffer, 8 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_b_m4, fp64_buffer, 5 * 8, "MLCE FP64   M4");
}

static void test_mlate() {
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileki(2);
  mint8m1_t i8_td = mlate8_m1(i8_rs1, 2 * sizeof(int8_t));
  msae8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MLATE INT8   M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileki(2);
  mint16m1_t i16_td = mlate16_m1(i16_rs1, 2 * sizeof(int16_t));
  msae16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MLATE INT16  M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileki(2);
  mint32m1_t i32_td = mlate32_m1(i32_rs1, 2 * sizeof(int32_t));
  msae32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MLATE INT32  M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileki(2);
  mint64m1_t i64_td = mlate64_m1(i64_rs1, 2 * sizeof(int64_t));
  msae64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MLATE INT64  M1");

  msettype(E8, M1, BA);
  msettilemi(2);
  msettileki(2);
  muint8m1_t u8_td = mlate8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msae8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MLATE UINT8  M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileki(2);
  muint16m1_t u16_td = mlate16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msae16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MLATE UINT16 M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileki(2);
  muint32m1_t u32_td = mlate32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msae32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MLATE UINT32 M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileki(2);
  muint64m1_t u64_td = mlate64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msae64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MLATE UINT64 M1");

  msettype(E16, M1, BA);
  msettilemi(2);
  msettileki(2);
  mfloat16m1_t fp16_td = mlate16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msae16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MLATE FP16   M1");

  msettype(E32, M1, BA);
  msettilemi(2);
  msettileki(2);
  mfloat32m1_t fp32_td = mlate32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msae32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MLATE FP32   M1");

  msettype(E64, M1, BA);
  msettilemi(2);
  msettileki(2);
  mfloat64m1_t fp64_td = mlate64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msae64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MLATE FP64   M1");

  // M2
  msettype(E8, M2, BA);
  msettilemi(8);
  msettileki(8);
  mint8m2_t i8_td_m2 = mlate8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  msae8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLATE INT8   M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  mint16m2_t i16_td_m2 = mlate16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  msae16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLATE INT16  M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mint32m2_t i32_td_m2 = mlate32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  msae32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLATE INT32  M2");

  msettype(E64, M2, BA);
  msettilemi(2);
  msettileki(2);
  mint64m2_t i64_td_m2 = mlate64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msae64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLATE INT64  M2");

  msettype(E8, M2, BA);
  msettilemi(8);
  msettileki(8);
  muint8m2_t u8_td_m2 = mlate8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  msae8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLATE UINT8  M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  muint16m2_t u16_td_m2 = mlate16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  msae16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLATE UINT16 M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  muint32m2_t u32_td_m2 = mlate32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  msae32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLATE UINT32 M2");

  msettype(E64, M2, BA);
  msettilemi(2);
  msettileki(2);
  muint64m2_t u64_td_m2 = mlate64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msae64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLATE UINT64 M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  mfloat16m2_t fp16_td_m2 = mlate16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msae16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLATE FP16   M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mfloat32m2_t fp32_td_m2 = mlate32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msae32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLATE FP32   M2");

  msettype(E32, M2, BA);
  msettilemi(2);
  msettileki(2);
  mfloat64m2_t fp64_td_m2 = mlate64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msae64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLATE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettilemi(8);
  msettileki(8);
  mint8m4_t i8_td_m4 = mlate8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  msae8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLATE INT8   M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  mint16m4_t i16_td_m4 = mlate16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  msae16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLATE INT16  M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  mint32m4_t i32_td_m4 = mlate32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  msae32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLATE INT32  M4");

  msettype(E64, M4, BA);
  msettilemi(2);
  msettileki(2);
  mint64m4_t i64_td_m4 = mlate64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  msae64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLATE INT64  M4");

  msettype(E8, M4, BA);
  msettilemi(8);
  msettileki(8);
  muint8m4_t u8_td_m4 = mlate8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  msae8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLATE UINT8  M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  muint16m4_t u16_td_m4 = mlate16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  msae16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLATE UINT16 M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  muint32m4_t u32_td_m4 = mlate32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  msae32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLATE UINT32 M4");

  msettype(E64, M4, BA);
  msettilemi(2);
  msettileki(2);
  muint64m4_t u64_td_m4 = mlate64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  msae64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLATE UINT64 M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  mfloat16m4_t fp16_td_m4 = mlate16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msae16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLATE FP16   M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  mfloat32m4_t fp32_td_m4 = mlate32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msae32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLATE FP32   M4");

  msettype(E32, M4, BA);
  msettilemi(2);
  msettileki(2);
  mfloat64m4_t fp64_td_m4 = mlate64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msae64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLATE FP64   M4");
}

static void test_mlbte() {
  msettype(E8, M1, BA);
  msettileni(2);
  msettileki(2);
  mint8m1_t i8_td = mlbte8_m1(i8_rs1, 2 * sizeof(int8_t));
  msbe8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MLBTE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlbte16_m1(i16_rs1, 2 * sizeof(int16_t));
  msbe16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MLBTE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlbte32_m1(i32_rs1, 2 * sizeof(int32_t));
  msbe32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MLBTE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlbte64_m1(i64_rs1, 2 * sizeof(int64_t));
  msbe64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MLBTE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlbte8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msbe8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MLBTE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlbte16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msbe16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MLBTE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlbte32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msbe32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MLBTE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlbte64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msbe64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MLBTE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlbte16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msbe16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MLBTE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlbte32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msbe32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MLBTE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlbte64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msbe64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MLBTE FP64   M1");

  // M2
  msettype(E8, M2, BA);
  msettileni(8);
  msettileki(8);
  mint8m2_t i8_td_m2 = mlbte8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  msbe8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLBTE INT8   M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  mint16m2_t i16_td_m2 = mlbte16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  msbe16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLBTE INT16  M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  mint32m2_t i32_td_m2 = mlbte32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  msbe32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLBTE INT32  M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettileki(2);
  mint64m2_t i64_td_m2 = mlbte64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msbe64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLBTE INT64  M2");

  msettype(E8, M2, BA);
  msettileni(8);
  msettileki(8);
  muint8m2_t u8_td_m2 = mlbte8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  msbe8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLBTE UINT8  M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  muint16m2_t u16_td_m2 = mlbte16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  msbe16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLBTE UINT16 M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  muint32m2_t u32_td_m2 = mlbte32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  msbe32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLBTE UINT32 M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettileki(2);
  muint64m2_t u64_td_m2 = mlbte64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msbe64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLBTE UINT64 M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  mfloat16m2_t fp16_td_m2 = mlbte16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msbe16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLBTE FP16   M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  mfloat32m2_t fp32_td_m2 = mlbte32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msbe32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLBTE FP32   M2");

  msettype(E32, M2, BA);
  msettileni(2);
  msettileki(2);
  mfloat64m2_t fp64_td_m2 = mlbte64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msbe64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLBTE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettileni(8);
  msettileki(8);
  mint8m4_t i8_td_m4 = mlbte8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  msbe8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLBTE INT8   M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  mint16m4_t i16_td_m4 = mlbte16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  msbe16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLBTE INT16  M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  mint32m4_t i32_td_m4 = mlbte32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  msbe32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLBTE INT32  M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettileki(2);
  mint64m4_t i64_td_m4 = mlbte64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  msbe64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLBTE INT64  M4");

  msettype(E8, M4, BA);
  msettileni(8);
  msettileki(8);
  muint8m4_t u8_td_m4 = mlbte8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  msbe8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLBTE UINT8  M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  muint16m4_t u16_td_m4 = mlbte16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  msbe16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLBTE UINT16 M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  muint32m4_t u32_td_m4 = mlbte32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  msbe32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLBTE UINT32 M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettileki(2);
  muint64m4_t u64_td_m4 = mlbte64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  msbe64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLBTE UINT64 M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  mfloat16m4_t fp16_td_m4 = mlbte16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msbe16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLBTE FP16   M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  mfloat32m4_t fp32_td_m4 = mlbte32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msbe32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLBTE FP32   M4");

  msettype(E32, M4, BA);
  msettileni(2);
  msettileki(2);
  mfloat64m4_t fp64_td_m4 = mlbte64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msbe64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLBTE FP64   M4");
}

static void test_mlcte() {
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint8m1_t i8_td = mlcte8_m1(i8_rs1, 2 * sizeof(int8_t));
  msce8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MLCTE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlcte16_m1(i16_rs1, 2 * sizeof(int16_t));
  msce16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MLCTE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlcte32_m1(i32_rs1, 2 * sizeof(int32_t));
  msce32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MLCTE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlcte64_m1(i64_rs1, 2 * sizeof(int64_t));
  msce64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MLCTE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlcte8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msce8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MLCTE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlcte16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msce16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MLCTE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlcte32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msce32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MLCTE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlcte64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msce64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MLCTE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlcte16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msce16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MLCTE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlcte32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msce32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MLCTE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlcte64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msce64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MLCTE FP64   M1");
  // M2
  msettype(E8, M2, BA);
  msettileni(8);
  msettilemi(8);
  mint8m2_t i8_td_m2 = mlcte8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  msce8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLCTE INT8   M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  mint16m2_t i16_td_m2 = mlcte16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  msce16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLCTE INT16  M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  mint32m2_t i32_td_m2 = mlcte32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  msce32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLCTE INT32  M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettilemi(2);
  mint64m2_t i64_td_m2 = mlcte64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msce64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLCTE INT64  M2");

  msettype(E8, M2, BA);
  msettileni(8);
  msettilemi(8);
  muint8m2_t u8_td_m2 = mlcte8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  msce8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLCTE UINT8  M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  muint16m2_t u16_td_m2 = mlcte16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  msce16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLCTE UINT16 M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  muint32m2_t u32_td_m2 = mlcte32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  msce32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLCTE UINT32 M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettilemi(2);
  muint64m2_t u64_td_m2 = mlcte64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msce64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLCTE UINT64 M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  mfloat16m2_t fp16_td_m2 = mlcte16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msce16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLCTE FP16   M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  mfloat32m2_t fp32_td_m2 = mlcte32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msce32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLCTE FP32   M2");

  msettype(E32, M2, BA);
  msettileni(2);
  msettilemi(2);
  mfloat64m2_t fp64_td_m2 = mlcte64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msce64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLCTE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettileni(8);
  msettilemi(8);
  mint8m4_t i8_td_m4 = mlcte8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  msce8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MLCTE INT8   M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  mint16m4_t i16_td_m4 = mlcte16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  msce16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MLCTE INT16  M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  mint32m4_t i32_td_m4 = mlcte32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  msce32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MLCTE INT32  M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettilemi(2);
  mint64m4_t i64_td_m4 = mlcte64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  msce64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MLCTE INT64  M4");

  msettype(E8, M4, BA);
  msettileni(8);
  msettilemi(8);
  muint8m4_t u8_td_m4 = mlcte8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  msce8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MLCTE UINT8  M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  muint16m4_t u16_td_m4 = mlcte16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  msce16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MLCTE UINT16 M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  muint32m4_t u32_td_m4 = mlcte32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  msce32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MLCTE UINT32 M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettilemi(2);
  muint64m4_t u64_td_m4 = mlcte64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  msce64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MLCTE UINT64 M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  mfloat16m4_t fp16_td_m4 = mlcte16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msce16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MLCTE FP16   M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  mfloat32m4_t fp32_td_m4 = mlcte32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msce32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MLCTE FP32   M4");

  msettype(E32, M4, BA);
  msettileni(2);
  msettilemi(2);
  mfloat64m4_t fp64_td_m4 = mlcte64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msce64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MLCTE FP64   M4");
}

static void test_msate() {
  msettype(E8, M1, BA);
  msettileki(2);
  msettilemi(2);
  mint8m1_t i8_td = mlae8_m1(i8_rs1, 2 * sizeof(int8_t));
  msate8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MSATE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlae16_m1(i16_rs1, 2 * sizeof(int16_t));
  msate16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MSATE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlae32_m1(i32_rs1, 2 * sizeof(int32_t));
  msate32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MSATE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlae64_m1(i64_rs1, 2 * sizeof(int64_t));
  msate64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MSATE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlae8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msate8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MSATE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlae16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msate16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MSATE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlae32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msate32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MSATE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlae64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msate64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MSATE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlae16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msate16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MSATE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlae32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msate32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MSATE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlae64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msate64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MSATE FP64   M1");
  // M2
  msettype(E8, M2, BA);
  msettilemi(8);
  msettileki(8);
  mint8m2_t i8_td_m2 = mlae8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  msate8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSATE INT8   M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  mint16m2_t i16_td_m2 = mlae16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  msate16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSATE INT16  M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mint32m2_t i32_td_m2 = mlae32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  msate32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSATE INT32  M2");

  msettype(E64, M2, BA);
  msettilemi(2);
  msettileki(2);
  mint64m2_t i64_td_m2 = mlae64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msate64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSATE INT64  M2");

  msettype(E8, M2, BA);
  msettilemi(8);
  msettileki(8);
  muint8m2_t u8_td_m2 = mlae8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  msate8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSATE UINT8  M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  muint16m2_t u16_td_m2 = mlae16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  msate16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSATE UINT16 M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  muint32m2_t u32_td_m2 = mlae32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  msate32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSATE UINT32 M2");

  msettype(E64, M2, BA);
  msettilemi(2);
  msettileki(2);
  muint64m2_t u64_td_m2 = mlae64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msate64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSATE UINT64 M2");

  msettype(E16, M2, BA);
  msettilemi(8);
  msettileki(8);
  mfloat16m2_t fp16_td_m2 = mlae16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msate16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSATE FP16   M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileki(4);
  mfloat32m2_t fp32_td_m2 = mlae32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msate32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSATE FP32   M2");

  msettype(E32, M2, BA);
  msettilemi(2);
  msettileki(2);
  mfloat64m2_t fp64_td_m2 = mlae64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msate64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSATE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettilemi(8);
  msettileki(8);
  mint8m4_t i8_td_m4 = mlae8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  msate8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSATE INT8   M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  mint16m4_t i16_td_m4 = mlae16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  msate16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSATE INT16  M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  mint32m4_t i32_td_m4 = mlae32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  msate32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSATE INT32  M4");

  msettype(E64, M4, BA);
  msettilemi(2);
  msettileki(2);
  mint64m4_t i64_td_m4 = mlae64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  msate64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSATE INT64  M4");

  msettype(E8, M4, BA);
  msettilemi(8);
  msettileki(8);
  muint8m4_t u8_td_m4 = mlae8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  msate8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSATE UINT8  M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  muint16m4_t u16_td_m4 = mlae16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  msate16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSATE UINT16 M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  muint32m4_t u32_td_m4 = mlae32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  msate32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSATE UINT32 M4");

  msettype(E64, M4, BA);
  msettilemi(2);
  msettileki(2);
  muint64m4_t u64_td_m4 = mlae64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  msate64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSATE UINT64 M4");

  msettype(E16, M4, BA);
  msettilemi(8);
  msettileki(8);
  mfloat16m4_t fp16_td_m4 = mlae16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msate16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSATE FP16   M4");

  msettype(E32, M4, BA);
  msettilemi(4);
  msettileki(4);
  mfloat32m4_t fp32_td_m4 = mlae32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msate32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSATE FP32   M4");

  msettype(E32, M4, BA);
  msettilemi(2);
  msettileki(2);
  mfloat64m4_t fp64_td_m4 = mlae64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msate64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSATE FP64   M4");
}

static void test_msbte() {
  msettype(E8, M1, BA);
  msettileki(2);
  msettileni(2);
  mint8m1_t i8_td = mlbe8_m1(i8_rs1, 2 * sizeof(int8_t));
  msbte8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MSBTE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlbe16_m1(i16_rs1, 2 * sizeof(int16_t));
  msbte16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MSBTE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlbe32_m1(i32_rs1, 2 * sizeof(int32_t));
  msbte32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MSBTE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlbe64_m1(i64_rs1, 2 * sizeof(int64_t));
  msbte64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MSBTE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlbe8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msbte8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MSBTE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlbe16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msbte16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MSBTE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlbe32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msbte32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MSBTE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlbe64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msbte64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MSBTE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlbe16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msbte16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MSBTE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlbe32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msbte32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MSBTE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlbe64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msbte64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MSBTE FP64   M1");
  // M2
  msettype(E8, M2, BA);
  msettileni(8);
  msettileki(8);
  mint8m2_t i8_td_m2 = mlbe8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  msbte8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSBTE INT8   M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  mint16m2_t i16_td_m2 = mlbe16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  msbte16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSBTE INT16  M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  mint32m2_t i32_td_m2 = mlbe32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  msbte32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSBTE INT32  M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettileki(2);
  mint64m2_t i64_td_m2 = mlbe64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msbte64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSBTE INT64  M2");

  msettype(E8, M2, BA);
  msettileni(8);
  msettileki(8);
  muint8m2_t u8_td_m2 = mlbe8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  msbte8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSBTE UINT8  M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  muint16m2_t u16_td_m2 = mlbe16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  msbte16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSBTE UINT16 M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  muint32m2_t u32_td_m2 = mlbe32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  msbte32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSBTE UINT32 M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettileki(2);
  muint64m2_t u64_td_m2 = mlbe64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msbte64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSBTE UINT64 M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettileki(8);
  mfloat16m2_t fp16_td_m2 = mlbe16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msbte16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSBTE FP16   M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettileki(4);
  mfloat32m2_t fp32_td_m2 = mlbe32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msbte32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSBTE FP32   M2");

  msettype(E32, M2, BA);
  msettileni(2);
  msettileki(2);
  mfloat64m2_t fp64_td_m2 = mlbe64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msbte64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSBTE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettileni(8);
  msettileki(8);
  mint8m4_t i8_td_m4 = mlbe8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  msbte8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSBTE INT8   M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  mint16m4_t i16_td_m4 = mlbe16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  msbte16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSBTE INT16  M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  mint32m4_t i32_td_m4 = mlbe32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  msbte32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSBTE INT32  M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettileki(2);
  mint64m4_t i64_td_m4 = mlbe64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  msbte64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSBTE INT64  M4");

  msettype(E8, M4, BA);
  msettileni(8);
  msettileki(8);
  muint8m4_t u8_td_m4 = mlbe8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  msbte8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSBTE UINT8  M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  muint16m4_t u16_td_m4 = mlbe16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  msbte16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSBTE UINT16 M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  muint32m4_t u32_td_m4 = mlbe32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  msbte32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSBTE UINT32 M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettileki(2);
  muint64m4_t u64_td_m4 = mlbe64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  msbte64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSBTE UINT64 M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettileki(8);
  mfloat16m4_t fp16_td_m4 = mlbe16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  msbte16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSBTE FP16   M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettileki(4);
  mfloat32m4_t fp32_td_m4 = mlbe32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  msbte32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSBTE FP32   M4");

  msettype(E32, M4, BA);
  msettileni(2);
  msettileki(2);
  mfloat64m4_t fp64_td_m4 = mlbe64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msbte64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSBTE FP64   M4");
}

static void test_mscte() {
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(2);
  mint8m1_t i8_td = mlce8_m1(i8_rs1, 2 * sizeof(int8_t));
  mscte8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_tp, i8_buffer, 4, "MSCTE INT8   M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlce16_m1(i16_rs1, 2 * sizeof(int16_t));
  mscte16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_tp, i16_buffer, 4, "MSCTE INT16  M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlce32_m1(i32_rs1, 2 * sizeof(int32_t));
  mscte32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_tp, i32_buffer, 4, "MSCTE INT32  M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlce64_m1(i64_rs1, 2 * sizeof(int64_t));
  mscte64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_tp, i64_buffer, 4, "MSCTE INT64  M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlce8_m1(u8_rs1, 2 * sizeof(uint8_t));
  mscte8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_tp, u8_buffer, 4, "MSCTE UINT8  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlce16_m1(u16_rs1, 2 * sizeof(uint16_t));
  mscte16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_tp, u16_buffer, 4, "MSCTE UINT16 M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlce32_m1(u32_rs1, 2 * sizeof(uint32_t));
  mscte32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_tp, u32_buffer, 4, "MSCTE UINT32 M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlce64_m1(u64_rs1, 2 * sizeof(uint64_t));
  mscte64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_tp, u64_buffer, 4, "MSCTE UINT64 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlce16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  mscte16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_tp, fp16_buffer, 4, "MSCTE FP16   M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlce32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  mscte32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_tp, fp32_buffer, 4, "MSCTE FP32   M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlce64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  mscte64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_tp, fp64_buffer, 4, "MSCTE FP64   M1");
  // M2
  msettype(E8, M2, BA);
  msettileni(8);
  msettilemi(8);
  mint8m2_t i8_td_m2 = mlce8_m2(i8_rs1_m2, 8 * sizeof(int8_t));
  mscte8_m(i8_td_m2, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSCTE INT8   M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  mint16m2_t i16_td_m2 = mlce16_m2(i16_rs1_m2, 8 * sizeof(int16_t));
  mscte16_m(i16_td_m2, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSCTE INT16  M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  mint32m2_t i32_td_m2 = mlce32_m2(i32_rs1_m2, 4 * sizeof(int32_t));
  mscte32_m(i32_td_m2, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSCTE INT32  M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettilemi(2);
  mint64m2_t i64_td_m2 = mlce64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  mscte64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSCTE INT64  M2");

  msettype(E8, M2, BA);
  msettileni(8);
  msettilemi(8);
  muint8m2_t u8_td_m2 = mlce8_m2(u8_rs1_m2, 8 * sizeof(uint8_t));
  mscte8_m(u8_td_m2, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSCTE UINT8  M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  muint16m2_t u16_td_m2 = mlce16_m2(u16_rs1_m2, 8 * sizeof(uint16_t));
  mscte16_m(u16_td_m2, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSCTE UINT16 M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  muint32m2_t u32_td_m2 = mlce32_m2(u32_rs1_m2, 4 * sizeof(uint32_t));
  mscte32_m(u32_td_m2, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSCTE UINT32 M2");

  msettype(E64, M2, BA);
  msettileni(2);
  msettilemi(2);
  muint64m2_t u64_td_m2 = mlce64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  mscte64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSCTE UINT64 M2");

  msettype(E16, M2, BA);
  msettileni(8);
  msettilemi(8);
  mfloat16m2_t fp16_td_m2 = mlce16_m2(fp16_rs1_m2, 8 * sizeof(fp16_t));
  mscte16_m(fp16_td_m2, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSCTE FP16   M2");

  msettype(E32, M2, BA);
  msettileni(4);
  msettilemi(4);
  mfloat32m2_t fp32_td_m2 = mlce32_m2(fp32_rs1_m2, 4 * sizeof(fp32_t));
  mscte32_m(fp32_td_m2, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSCTE FP32   M2");

  msettype(E32, M2, BA);
  msettileni(2);
  msettilemi(2);
  mfloat64m2_t fp64_td_m2 = mlce64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  mscte64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSCTE FP64   M2");
  // M4
  msettype(E8, M4, BA);
  msettileni(8);
  msettilemi(8);
  mint8m4_t i8_td_m4 = mlce8_m4(i8_rs1_m2, 8 * sizeof(int8_t));
  mscte8_m(i8_td_m4, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2_tp, i8_buffer, 8 * 8, "MSCTE INT8   M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  mint16m4_t i16_td_m4 = mlce16_m4(i16_rs1_m2, 8 * sizeof(int16_t));
  mscte16_m(i16_td_m4, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2_tp, i16_buffer, 8 * 8, "MSCTE INT16  M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  mint32m4_t i32_td_m4 = mlce32_m4(i32_rs1_m2, 4 * sizeof(int32_t));
  mscte32_m(i32_td_m4, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2_tp, i32_buffer, 4 * 4, "MSCTE INT32  M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettilemi(2);
  mint64m4_t i64_td_m4 = mlce64_m4(i64_rs1_m2, 2 * sizeof(int64_t));
  mscte64_m(i64_td_m4, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2_tp, i64_buffer, 2 * 2, "MSCTE INT64  M4");

  msettype(E8, M4, BA);
  msettileni(8);
  msettilemi(8);
  muint8m4_t u8_td_m4 = mlce8_m4(u8_rs1_m2, 8 * sizeof(uint8_t));
  mscte8_m(u8_td_m4, u8_buffer, 8 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2_tp, u8_buffer, 8 * 8, "MSCTE UINT8  M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  muint16m4_t u16_td_m4 = mlce16_m4(u16_rs1_m2, 8 * sizeof(uint16_t));
  mscte16_m(u16_td_m4, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2_tp, u16_buffer, 8 * 8, "MSCTE UINT16 M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  muint32m4_t u32_td_m4 = mlce32_m4(u32_rs1_m2, 4 * sizeof(uint32_t));
  mscte32_m(u32_td_m4, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2_tp, u32_buffer, 4 * 4, "MSCTE UINT32 M4");

  msettype(E64, M4, BA);
  msettileni(2);
  msettilemi(2);
  muint64m4_t u64_td_m4 = mlce64_m4(u64_rs1_m2, 2 * sizeof(uint64_t));
  mscte64_m(u64_td_m4, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2_tp, u64_buffer, 2 * 2, "MSCTE UINT64 M4");

  msettype(E16, M4, BA);
  msettileni(8);
  msettilemi(8);
  mfloat16m4_t fp16_td_m4 = mlce16_m4(fp16_rs1_m2, 8 * sizeof(fp16_t));
  mscte16_m(fp16_td_m4, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_rs1_m2_tp, fp16_buffer, 8 * 8, "MSCTE FP16   M4");

  msettype(E32, M4, BA);
  msettileni(4);
  msettilemi(4);
  mfloat32m4_t fp32_td_m4 = mlce32_m4(fp32_rs1_m2, 4 * sizeof(fp32_t));
  mscte32_m(fp32_td_m4, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_rs1_m2_tp, fp32_buffer, 4 * 4, "MSCTE FP32   M4");

  msettype(E32, M4, BA);
  msettileni(2);
  msettilemi(2);
  mfloat64m4_t fp64_td_m4 = mlce64_m4(fp64_rs1_m2, 2 * sizeof(fp64_t));
  mscte64_m(fp64_td_m4, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_rs1_m2_tp, fp64_buffer, 2 * 2, "MSCTE FP64   M4");
}

static void test_mlre_and_msre() {
  // M1
  msettype(E8, M1, BA);
  mint8m1_t i8_td = mlre8_m1(i8_rs1, 2 * sizeof(int8_t));
  msre8_m(i8_td, i8_buffer, 2 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1, i8_buffer, 4, "MLRE & MSRE INT8   M1");

  msettype(E8, M1, BA);
  muint8m1_t u8_td = mlre8_m1(u8_rs1, 2 * sizeof(uint8_t));
  msre8_m(u8_td, u8_buffer, 2 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1, u8_buffer, 4, "MLRE & MSRE UINT8  M1");

  msettype(E16, M1, BA);
  mint16m1_t i16_td = mlre16_m1(i16_rs1, 2 * sizeof(int16_t));
  msre16_m(i16_td, i16_buffer, 2 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1, i16_buffer, 4, "MLRE & MSRE INT16  M1");

  msettype(E16, M1, BA);
  muint16m1_t u16_td = mlre16_m1(u16_rs1, 2 * sizeof(uint16_t));
  msre16_m(u16_td, u16_buffer, 2 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1, u16_buffer, 4, "MLRE & MSRE UINT16 M1");

  msettype(E16, M1, BA);
  mfloat16m1_t fp16_td = mlre16_m1(fp16_rs1, 2 * sizeof(fp16_t));
  msre16_m(fp16_td, fp16_buffer, 2 * sizeof(fp16_t));
  EXCEPT_U16_ARRAY_EQ(fp16_rs1, fp16_buffer, 4, "MLRE & MSRE FP16   M1");

  msettype(E32, M1, BA);
  mint32m1_t i32_td = mlre32_m1(i32_rs1, 2 * sizeof(int32_t));
  msre32_m(i32_td, i32_buffer, 2 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1, i32_buffer, 4, "MLRE & MSRE INT32  M1");

  msettype(E32, M1, BA);
  muint32m1_t u32_td = mlre32_m1(u32_rs1, 2 * sizeof(uint32_t));
  msre32_m(u32_td, u32_buffer, 2 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1, u32_buffer, 4, "MLRE & MSRE UINT32 M1");

  msettype(E32, M1, BA);
  mfloat32m1_t fp32_td = mlre32_m1(fp32_rs1, 2 * sizeof(fp32_t));
  msre32_m(fp32_td, fp32_buffer, 2 * sizeof(fp32_t));
  EXCEPT_U32_ARRAY_EQ(fp32_rs1, fp32_buffer, 4, "MLRE & MSRE FP32   M1");

  msettype(E64, M1, BA);
  mint64m1_t i64_td = mlre64_m1(i64_rs1, 2 * sizeof(int64_t));
  msre64_m(i64_td, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1, i64_buffer, 4, "MLRE & MSRE INT64  M1");

  msettype(E64, M1, BA);
  muint64m1_t u64_td = mlre64_m1(u64_rs1, 2 * sizeof(uint64_t));
  msre64_m(u64_td, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1, u64_buffer, 4, "MLRE & MSRE UINT64 M1");

  msettype(E64, M1, BA);
  mfloat64m1_t fp64_td = mlre64_m1(fp64_rs1, 2 * sizeof(fp64_t));
  msre64_m(fp64_td, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_U64_ARRAY_EQ(fp64_rs1, fp64_buffer, 4, "MLRE & MSRE FP64   M1");
  // M2
  msettype(E8, M2, BA);
  mint8m2_t i8_td_m2 = mlre8_m2(i8_rs1_m2, 32 * sizeof(int8_t));
  msre8_m(i8_td_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2, i8_buffer, 2 * 32, "MLRE & MSRE INT8   M2");

  msettype(E8, M2, BA);
  muint8m2_t u8_td_m2 = mlre8_m2(u8_rs1_m2, 32 * sizeof(uint8_t));
  msre8_m(u8_td_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2, u8_buffer, 2 * 32, "MLRE & MSRE UINT8  M2");

  msettype(E16, M2, BA);
  mint16m2_t i16_td_m2 = mlre16_m2(i16_rs1_m2, 16 * sizeof(int16_t));
  msre16_m(i16_td_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2, i16_buffer, 4 * 16, "MLRE & MSRE INT16  M2");

  msettype(E16, M2, BA);
  muint16m2_t u16_td_m2 = mlre16_m2(u16_rs1_m2, 16 * sizeof(uint16_t));
  msre16_m(u16_td_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2, u16_buffer, 4 * 16, "MLRE & MSRE UINT16 M2");

  msettype(E16, M2, BA);
  mfloat16m2_t fp16_td_m2 = mlre16_m2(fp16_rs1_m2, 16 * sizeof(fp16_t));
  msre16_m(fp16_td_m2, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_U16_ARRAY_EQ(fp16_rs1_m2, fp16_buffer, 4 * 16,
                      "MLRE & MSRE FP16   M2");

  msettype(E32, M2, BA);
  mint32m2_t i32_td_m2 = mlre32_m2(i32_rs1_m2, 8 * sizeof(int32_t));
  msre32_m(i32_td_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2, i32_buffer, 8 * 8, "MLRE & MSRE INT32  M2");

  msettype(E32, M2, BA);
  muint32m2_t u32_td_m2 = mlre32_m2(u32_rs1_m2, 8 * sizeof(uint32_t));
  msre32_m(u32_td_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2, u32_buffer, 8 * 8, "MLRE & MSRE UINT32 M2");

  msettype(E32, M2, BA);
  mfloat32m2_t fp32_td_m2 = mlre32_m2(fp32_rs1_m2, 8 * sizeof(fp32_t));
  msre32_m(fp32_td_m2, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_U32_ARRAY_EQ(fp32_rs1_m2, fp32_buffer, 8 * 8, "MLRE & MSRE FP32   M2");

  msettype(E64, M2, BA);
  mint64m2_t i64_td_m2 = mlre64_m2(i64_rs1_m2, 2 * sizeof(int64_t));
  msre64_m(i64_td_m2, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2, i64_buffer, 2 * 2, "MLRE & MSRE INT64  M2");

  msettype(E64, M2, BA);
  muint64m2_t u64_td_m2 = mlre64_m2(u64_rs1_m2, 2 * sizeof(uint64_t));
  msre64_m(u64_td_m2, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2, u64_buffer, 2 * 2, "MLRE & MSRE UINT64 M2");

  msettype(E64, M2, BA);
  mfloat64m2_t fp64_td_m2 = mlre64_m2(fp64_rs1_m2, 2 * sizeof(fp64_t));
  msre64_m(fp64_td_m2, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_U64_ARRAY_EQ(fp64_rs1_m2, fp64_buffer, 2 * 2, "MLRE & MSRE FP32   M2");
  // M2
  msettype(E8, M4, BA);
  mint8m4_t i8_td_m4 = mlre8_m4(i8_rs1_m2, 64 * sizeof(int8_t));
  msre8_m(i8_td_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_rs1_m2, i8_buffer, 1 * 64, "MLRE & MSRE INT8   M4");

  msettype(E8, M4, BA);
  muint8m4_t u8_td_m4 = mlre8_m4(u8_rs1_m2, 64 * sizeof(uint8_t));
  msre8_m(u8_td_m4, u8_buffer, 64 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_rs1_m2, u8_buffer, 1 * 64, "MLRE & MSRE UINT8  M4");

  msettype(E16, M4, BA);
  mint16m4_t i16_td_m4 = mlre16_m4(i16_rs1_m2, 32 * sizeof(int16_t));
  msre16_m(i16_td_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_rs1_m2, i16_buffer, 2 * 32, "MLRE & MSRE INT16  M4");

  msettype(E16, M4, BA);
  muint16m4_t u16_td_m4 = mlre16_m4(u16_rs1_m2, 32 * sizeof(uint16_t));
  msre16_m(u16_td_m4, u16_buffer, 32 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_rs1_m2, u16_buffer, 2 * 32, "MLRE & MSRE UINT16 M4");

  msettype(E16, M4, BA);
  mfloat16m4_t fp16_td_m4 = mlre16_m4(fp16_rs1_m2, 32 * sizeof(fp16_t));
  msre16_m(fp16_td_m4, fp16_buffer, 32 * sizeof(fp16_t));
  EXCEPT_U16_ARRAY_EQ(fp16_rs1_m2, fp16_buffer, 2 * 32,
                      "MLRE & MSRE FP16   M4");

  msettype(E32, M4, BA);
  mint32m4_t i32_td_m4 = mlre32_m4(i32_rs1_m2, 16 * sizeof(int32_t));
  msre32_m(i32_td_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_rs1_m2, i32_buffer, 4 * 16, "MLRE & MSRE INT32  M4");

  msettype(E32, M4, BA);
  muint32m4_t u32_td_m4 = mlre32_m4(u32_rs1_m2, 16 * sizeof(uint32_t));
  msre32_m(u32_td_m4, u32_buffer, 16 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_rs1_m2, u32_buffer, 4 * 16, "MLRE & MSRE UINT32 M4");

  msettype(E32, M4, BA);
  mfloat32m4_t fp32_td_m4 = mlre32_m4(fp32_rs1_m2, 16 * sizeof(fp32_t));
  msre32_m(fp32_td_m4, fp32_buffer, 16 * sizeof(fp32_t));
  EXCEPT_U32_ARRAY_EQ(fp32_rs1_m2, fp32_buffer, 4 * 16,
                      "MLRE & MSRE FP32   M4");

  msettype(E64, M4, BA);
  mint64m4_t i64_td_m4 = mlre64_m4(i64_rs1_m2, 4 * sizeof(int64_t));
  msre64_m(i64_td_m4, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_rs1_m2, i64_buffer, 1 * 4, "MLRE & MSRE INT64  M4");

  msettype(E64, M4, BA);
  muint64m4_t u64_td_m4 = mlre64_m4(u64_rs1_m2, 4 * sizeof(uint64_t));
  msre64_m(u64_td_m4, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_rs1_m2, u64_buffer, 1 * 4, "MLRE & MSRE UINT64 M4");

  msettype(E64, M4, BA);
  mfloat64m4_t fp64_td_m4 = mlre64_m4(fp64_rs1_m2, 4 * sizeof(fp64_t));
  msre64_m(fp64_td_m4, fp64_buffer, 4 * sizeof(fp64_t));
  EXCEPT_U64_ARRAY_EQ(fp64_rs1_m2, fp64_buffer, 1 * 4, "MLRE & MSRE FP32   M4");
}

int main() {
  test_mlae();
  test_mlbe();
  test_mlce();
  test_mlate();
  test_mlbte();
  test_mlcte();
  test_msate();
  test_msbte();
  test_mscte();
  test_mlre_and_msre();
  return 0;
}
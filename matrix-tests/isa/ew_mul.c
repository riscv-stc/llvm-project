#include "utils.h"
#include <riscv_matrix.h>

static void test_mfmul_mm() {
  // M1
  // fp16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const fp16_t fp16_src1[] = {3.105,  -3.545, 3.293, 1.484,   3.518, -4.93,
                              3.584,  -1.117, 1.079, 4.77,    0.479, 4.516,
                              1.332,  -2.604, 2.248, -0.6294, 2.111, 3.541,
                              0.2886, 3.723,  2.527, 3.336,   1.009, -0.1783};
  const fp16_t fp16_src2[] = {0.522,  1.1875, -4.715, 0.351,  -1.23,  -3.299,
                              2.152,  4.258,  3.057,  3.68,   4.14,   -1.957,
                              -4.223, 3.904,  -0.636, -2.389, -1.282, -2.271,
                              -3.014, 0.601,  3.467,  4.996,  -2.,    -1.054};
  const fp16_t fp16_ans[] = {1.621,   -4.21,   -15.52, 0.521, -4.33,  16.27,
                             7.715,   -4.758,  3.299,  17.55, 1.983,  -8.836,
                             -5.625,  -10.164, -1.431, 1.503, -2.707, -8.05,
                             -0.8696, 2.238,   8.766,  16.67, -2.018, 0.1879};
  mfloat16m1_t fp16_ts1 = mlce16_m1(fp16_src1, 8 * sizeof(fp16_t));
  mfloat16m1_t fp16_ts2 = mlce16_m1(fp16_src2, 8 * sizeof(fp16_t));
  mfloat16m1_t fp16_out = mfmul_mm(fp16_ts1, fp16_ts2);
  msce16_m(fp16_out, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_LAX_EQ(fp16_ans, fp16_buffer, 24, "  MFMUL.MM  FP16   M1");
  // fp32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const fp32_t fp32_src1[] = {8.186389,   7.0173316,  8.328329,   3.6241052,
                              -4.5843716, -5.147129,  0.43098143, -7.3827243,
                              -3.64494,   -5.6412024, -7.4595513, 1.4888712,
                              -9.316315,  -1.790457,  -2.2153025, 3.8133435};
  const fp32_t fp32_src2[] = {-7.510968,  -4.912936, -5.7099075, -2.2144978,
                              -2.9207463, 8.592498,  -2.41268,   8.856145,
                              -5.7001686, -7.507826, -2.7483585, -1.9039016,
                              0.955183,   -7.115132, -5.8410096, -1.5155557};
  const fp32_t fp32_ans[] = {-61.48771, -34.475704, -47.55399,  -8.025573,
                             13.389787, -44.226696, -1.0398202, -65.38248,
                             20.776772, 42.353165,  20.501522,  -2.8346643,
                             -8.898786, 12.739338,  12.939603,  -5.7793345};
  mfloat32m1_t fp32_ts1 = mlce32_m1(fp32_src1, 4 * sizeof(fp32_t));
  mfloat32m1_t fp32_ts2 = mlce32_m1(fp32_src2, 4 * sizeof(fp32_t));
  mfloat32m1_t fp32_out = mfmul_mm(fp32_ts1, fp32_ts2);
  msce32_m(fp32_out, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_LAX_EQ(fp32_ans, fp32_buffer, 16, "  MFMUL.MM  FP32   M1");
  // fp64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const fp64_t fp64_src1[] = {
      -6.22579119, -11.82442455, 2.85886163, -18.07005741, -11.02285646,
      0.12212829,  -14.07488611, 2.26714736, -14.49574705, -8.58553039};
  const fp64_t fp64_src2[] = {
      9.33328866,   9.19792727, -16.10315995, -16.09840026, 3.72660863,
      -12.88092401, 0.25234218, 15.08397118,  -14.71517812, -11.1964807};
  const fp64_t fp64_ans[] = {
      -58.10710635, -108.76019704, -46.03670602, 290.89901687, -41.07787202,
      -1.57312527,  -3.55168745,   34.19758544,  213.30749989, 96.12772528};
  mfloat64m1_t fp64_ts1 = mlce64_m1(fp64_src1, 2 * sizeof(fp64_t));
  mfloat64m1_t fp64_ts2 = mlce64_m1(fp64_src2, 2 * sizeof(fp64_t));
  mfloat64m1_t fp64_out = mfmul_mm(fp64_ts1, fp64_ts2);
  msce64_m(fp64_out, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_LAX_EQ(fp64_ans, fp64_buffer, 10, "  MFMUL.MM  FP64   M1");
  // M2
  // fp16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const fp16_t fp16_src1_m2[] = {
      -8.89,  -6.363, -9.64,  -1.023, 4.992,   -6.1,   -5.824, -0.9336,
      -8.414, -2.488, 3.893,  -5.934, 1.754,   3.861,  9.55,   -0.0415,
      -8.02,  -9.93,  8.66,   7.688,  -0.5093, 5.547,  -1.536, -8.43,
      -1.033, -4.234, -1.115, 2.059,  -6.562,  -9.13,  -5.02,  8.92,
      -1.552, -9.33,  -4.99,  2.762,  1.193,   -3.127, -6.906, 4.36,
      -7.027, 8.38,   8.54,   4.,     2.932,   -7.52,  -8.77,  -3.658};
  const fp16_t fp16_src2_m2[] = {
      2.488,  9.88,   -0.7793, 3.887,  -7.344, 1.938,  1.561,  0.4358,
      7.516,  6.516,  -0.1738, -7.27,  4.727,  -7.5,   2.006,  8.695,
      0.2744, -3.344, 4.1,     4.246,  7.793,  -8.7,   6.98,   8.16,
      -4.2,   5.92,   -8.11,   -2.42,  5.234,  0.2179, 1.3955, 4.56,
      -5.48,  2.807,  5.,      -7.242, -2.291, -9.97,  -1.926, -8.375,
      7.69,   -9.43,  0.631,   -7.434, 9.63,   -6.156, 9.08,   -2.766};
  const fp16_t fp16_ans_m2[] = {
      -22.12, -62.88, 7.51,   -3.979, -36.66, -11.83, -9.086, -0.4067,
      -63.25, -16.22, -0.677, 43.12,  8.29,   -28.95, 19.16,  -0.3608,
      -2.201, 33.2,   35.5,   32.66,  -3.969, -48.28, -10.73, -68.75,
      4.34,   -25.08, 9.05,   -4.98,  -34.34, -1.99,  -7.004, 40.66,
      8.51,   -26.19, -24.94, -20.,   -2.734, 31.17,  13.3,   -36.5,
      -54.06, -79.06, 5.387,  -29.73, 28.23,  46.28,  -79.6,  10.12};
  mfloat16m2_t fp16_ts1_m2 = mlce16_m2(fp16_src1_m2, 16 * sizeof(fp16_t));
  mfloat16m2_t fp16_ts2_m2 = mlce16_m2(fp16_src2_m2, 16 * sizeof(fp16_t));
  mfloat16m2_t fp16_out_m2 = mfmul_mm(fp16_ts1_m2, fp16_ts2_m2);
  msce16_m(fp16_out_m2, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_LAX_EQ(fp16_ans_m2, fp16_buffer, 3 * 16,
                           "  MFMUL.MM  FP16   M2");
  // fp32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const fp32_t fp32_src1_m2[] = {
      7.8821383,  9.232084,   -5.4565473, -1.3487791, 4.1979527,  -9.814619,
      5.482651,   -2.5602784, 5.8320875,  -2.635505,  -7.57904,   3.4902146,
      9.624275,   -6.387117,  1.7435043,  1.4501841,  7.9469056,  7.6759086,
      -6.3022776, 4.1484957,  8.215124,   4.700311,   8.035836,   8.928408,
      3.6107924,  4.0193405,  -7.260769,  1.9517308,  -3.3527954, 7.9587135,
      0.96866477, -2.6345613};
  const fp32_t fp32_src2_m2[] = {
      -9.510032,  6.323288,  0.7019268,  5.388815,   0.94731367, -7.705523,
      -9.270418,  -9.013579, -0.4222243, -2.3210266, -9.150311,  0.7149334,
      -1.5170958, 9.665048,  4.5205135,  5.2809005,  2.1588197,  -5.150414,
      -6.1617165, 3.9335802, 7.253381,   0.33531842, -0.4991992, -3.528561,
      -7.2851257, 8.919906,  6.9812264,  3.6882362,  1.4009489,  0.9923623,
      7.537077,   -2.0087898};
  const fp32_t fp32_ans_m2[] = {
      -74.95938,  58.37713,  -3.830097, -7.268321, 3.976778,  75.62677,
      -50.82647,  23.077272, -2.462449, 6.117077,  69.35058,  2.495271,
      -14.600947, -61.73179, 7.8815346, 7.658278,  17.155935, -39.534107,
      38.832848,  16.31844,  59.587425, 1.576101,  -4.011483, -31.504433,
      -26.305077, 35.85214,  -50.68907, 7.1984444, -4.697095, 7.8979273,
      7.300901,   5.2922797};
  mfloat32m2_t fp32_ts1_m2 = mlce32_m2(fp32_src1_m2, 8 * sizeof(fp32_t));
  mfloat32m2_t fp32_ts2_m2 = mlce32_m2(fp32_src2_m2, 8 * sizeof(fp32_t));
  mfloat32m2_t fp32_out_m2 = mfmul_mm(fp32_ts1_m2, fp32_ts2_m2);
  msce32_m(fp32_out_m2, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_LAX_EQ(fp32_ans_m2, fp32_buffer, 4 * 8,
                           " MFMUL.MM  FP32   M2");
  // fp64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const fp64_t fp64_src1_m2[] = {
      -6.67740169, -6.91132334, -6.71184366, 0.22923339,  5.21999202,
      -9.74932062, 0.233341,    -3.64970497, 0.07386592,  2.88623562,
      2.70090608,  0.05436883,  -5.85018663, 1.69231711,  -9.36984832,
      7.78284186,  -3.73094618, 7.87645738,  -5.04869427, 3.75478798};
  const fp64_t fp64_src2_m2[] = {
      9.65921394,  -2.38632604, -8.73641425, -2.99338646, 5.70742941,
      4.75889269,  -9.22949135, -4.50291607, 4.13171878,  6.70904663,
      9.82672413,  5.73484158,  -8.00967859, 1.84512487,  -0.97075216,
      -8.70759183, -7.12993169, 4.41212053,  1.92208404,  9.82510975};
  const fp64_t fp64_ans_m2[] = {
      -64.4984515,  16.49267089, 58.6374466,  -0.68618411, 29.79273599,
      -46.39597058, -2.15361877, 16.43431518, 0.3051932,   19.36388934,
      26.54105898,  0.31179664,  46.8581146,  3.12253639,  9.09580047,
      -67.76981019, 26.6013914,  34.75187934, -9.70401469, 36.89120399};
  mfloat64m2_t fp64_ts1_m2 = mlce64_m2(fp64_src1_m2, 4 * sizeof(fp64_t));
  mfloat64m2_t fp64_ts2_m2 = mlce64_m2(fp64_src2_m2, 4 * sizeof(fp64_t));
  mfloat64m2_t fp64_out_m2 = mfmul_mm(fp64_ts1_m2, fp64_ts2_m2);
  msce64_m(fp64_out_m2, fp64_buffer, 4 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_LAX_EQ(fp64_ans_m2, fp64_buffer, 5 * 4,
                           " MFMUL.MM  FP64   M2");
  // M4
  // fp16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(17);
  const fp16_t fp16_src1_m4[] = {
      -2.549, -5.844, -9.48,   7.098,   1.06,    5.242,  3.424,   -2.85,  4.727,
      4.28,   -0.469, 2.033,   3.438,   -0.1053, -6.49,  -0.4385, -7.695, -6.68,
      -1.535, 5.47,   -6.438,  -8.125,  -4.62,   -8.69,  -3.139,  -1.209, -4.95,
      -5.285, 0.1393, -0.2793, -0.1137, -9.836,  -3.557, 6.473,   -4.383, 9.625,
      8.13,   9.03,   -3.59,   -5.29,   5.53,    -2.541, 1.057,   -4.28,  -4.63,
      5.566,  -5.5,   -5.207,  -0.1986, 0.8066,  4.688};
  const fp16_t fp16_src2_m4[] = {
      2.676,  -4.875, -1.003, -0.568, 4.52,   -1.214, -3.523, -1.955,  -9.164,
      -4.656, 2.363,  -5.805, 2.06,   -6.977, -9.16,  8.99,   -9.625,  7.168,
      -8.82,  8.26,   9.484,  -8.625, -5.934, -7.09,  -7.188, 5.48,    -0.3923,
      1.5625, -7.94,  7.156,  -5.473, -1.712, 7.445,  7.895,  -0.9214, 8.31,
      3.127,  -3.09,  -4.6,   -4.137, -7.51,  -4.,    3.871,  5.887,   -4.9,
      -8.9,   -7.336, -2.625, -1.432, 2.365,  -4.645};
  const fp16_t fp16_ans_m4[] = {
      -6.82,  28.48,  9.51,    -4.03,  4.79,   -6.363, -12.06, 5.57,   -43.3,
      -19.94, -1.108, -11.805, 7.082,  0.7344, 59.4,   -3.943, 74.06,  -47.88,
      13.54,  45.16,  -61.06,  70.06,  27.42,  61.6,   22.56,  -6.625, 1.941,
      -8.26,  -1.106, -1.999,  0.622,  16.84,  -26.48, 51.1,   4.04,   80.,
      25.44,  -27.9,  16.52,   21.88,  -41.56, 10.164, 4.09,   -25.2,  22.67,
      -49.53, 40.34,  13.67,   0.2844, 1.908,  -21.77};
  mfloat16m4_t fp16_ts1_m4 = mlce16_m4(fp16_src1_m4, 17 * sizeof(fp16_t));
  mfloat16m4_t fp16_ts2_m4 = mlce16_m4(fp16_src2_m4, 17 * sizeof(fp16_t));
  mfloat16m4_t fp16_out_m4 = mfmul_mm(fp16_ts1_m4, fp16_ts2_m4);
  msce16_m(fp16_out_m4, fp16_buffer, 17 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_LAX_EQ(fp16_ans_m4, fp16_buffer, 3 * 17,
                           " MFMUL.MM  FP16   M4");
  // fp32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(9);
  const fp32_t fp32_src1_m4[] = {
      1.5379399,  -5.622694,  -5.4891434, 9.246974,   8.510312,   -0.92981774,
      -2.2192256, 5.084979,   4.5249586,  -2.322958,  4.1893225,  -1.3601037,
      -2.750263,  1.866929,   3.5148582,  -0.3652008, 1.3721509,  -2.7384415,
      4.965625,   -4.81689,   1.1382338,  8.74096,    7.800796,   -8.496881,
      -9.336906,  5.4363413,  -8.514624,  7.431496,   -5.751816,  -5.241992,
      1.0279509,  -2.1235251, 8.699498,   -1.9779872, -2.6496677, -6.5943317};
  const fp32_t fp32_src2_m4[] = {
      -6.388244, 7.4510207,  1.1740433, 3.6509256,  2.3337862,  9.584587,
      0.6778052, -9.247416,  2.4729114, -8.777098,  -2.3767858, -6.0142927,
      8.65826,   9.843366,   3.68343,   1.8531607,  4.778939,   -4.459861,
      7.244602,  -3.4130645, 9.197899,  -7.3797607, -7.629577,  4.72705,
      -9.166569, 1.1560222,  -9.487505, 7.927494,   1.8098946,  -0.82760185,
      2.9040198, 4.4503202,  6.8798404, 5.0290003,  -2.1549306, -8.555665};
  const fp32_t fp32_ans_m4[] = {
      -9.824736,  -41.89481,  -6.444492, 33.760014,   19.86125,   -8.911919,
      -1.5042026, -47.022915, 11.189821, 20.38883,    -9.957122,  8.180062,
      -23.812492, 18.376865,  12.946734, -0.67677575, 6.557425,   12.213068,
      35.973976,  16.440355,  10.469359, -64.506195,  -59.516777, -40.165176,
      85.587395,  6.284531,   80.78253,  58.913143,   -10.41018,  4.338282,
      2.9851897,  -9.450367,  59.85116,  -9.947298,   5.70985,    56.41889};
  mfloat32m4_t fp32_ts1_m4 = mlce32_m4(fp32_src1_m4, 9 * sizeof(fp32_t));
  mfloat32m4_t fp32_ts2_m4 = mlce32_m4(fp32_src2_m4, 9 * sizeof(fp32_t));
  mfloat32m4_t fp32_out_m4 = mfmul_mm(fp32_ts1_m4, fp32_ts2_m4);
  msce32_m(fp32_out_m4, fp32_buffer, 9 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_LAX_EQ(fp32_ans_m4, fp32_buffer, 4 * 9,
                           " MFMUL.MM  FP32   M4");
  // fp64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(5);
  const fp64_t fp64_src1_m4[] = {
      9.59398079,  4.63604375,  -0.20692822, 4.44748669,  -1.71053384,
      -8.50666223, -8.68674933, 2.1676419,   2.63709639,  0.81112792,
      -1.31899741, -6.52498076, -8.48736641, 0.73736633,  -7.49292715,
      3.3184261,   8.06963769,  -3.75465095, 9.55837975,  8.02353472,
      -4.89291899, -2.4508872,  -6.61328863, -1.30019366, -1.87486164};
  const fp64_t fp64_src2_m4[] = {
      2.65851681e-03,  4.39019034e+00,  -9.99225613e+00, -1.96264833e+00,
      -3.69619814e+00, 9.65679694e+00,  -3.20918389e+00, -5.53552282e+00,
      4.60947534e+00,  7.44955917e+00,  7.50115827e+00,  -8.00485709e+00,
      2.02762587e+00,  6.67602052e+00,  -7.68096522e+00, -5.47972912e+00,
      8.16949997e+00,  -2.64839972e+00, 1.51410592e-01,  2.80618948e+00,
      1.32730938e+00,  1.54344010e+00,  -6.96790975e-01, 6.14633417e+00,
      -4.51950158e+00};
  const fp64_t fp64_ans_m4[] = {
      2.55057592e-02,  2.03531145e+01,  2.06767981e+00,  -8.72885236e+00,
      6.32247201e+00,  -8.21471098e+01, 2.78773760e+01,  -1.19990312e+01,
      1.21556308e+01,  6.04254545e+00,  -9.89400836e+00, 5.22315385e+01,
      -1.72092037e+01, 4.92267277e+00,  5.75529128e+01,  -1.81840762e+01,
      6.59249049e+01,  9.94381655e+00,  1.44723994e+00,  2.25155587e+01,
      -6.49441729e+00, -3.78279759e+00, 4.60807983e+00,  -7.99142473e+00,
      8.47344014e+00};
  mfloat64m4_t fp64_ts1_m4 = mlce64_m4(fp64_src1_m4, 5 * sizeof(fp64_t));
  mfloat64m4_t fp64_ts2_m4 = mlce64_m4(fp64_src2_m4, 5 * sizeof(fp64_t));
  mfloat64m4_t fp64_out_m4 = mfmul_mm(fp64_ts1_m4, fp64_ts2_m4);
  msce64_m(fp64_out_m4, fp64_buffer, 5 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_LAX_EQ(fp64_ans_m4, fp64_buffer, 5 * 5,
                           " MFMUL.MM  FP64   M4");
}

static void test_msmul_mm() {
  // M1
  // int8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(16);
  const int8_t i8_src1[] = {-76, 62,  51,  42,  112, -127, 47, -3,
                            -22, 91,  49,  42,  -86, -125, 14, -54,
                            27,  124, -43, 88,  -79, -97,  85, -18,
                            -47, -80, -33, -88, 35,  53,   16, 35};
  const int8_t i8_src2[] = {116, 85,  -66, 12,  74,  1,   72,  -62,
                            101, 65,  -70, 109, -72, 40,  -54, -72,
                            59,  -69, -70, -9,  40,  -30, 106, -118,
                            43,  -67, 39,  110, -82, 92,  64,  -99};
  const int8_t i8_ans[] = {-128, 127,  -128, 127,  127,  -127, 127,  127,
                           -128, 127,  -128, 127,  127,  -128, -128, 127,
                           127,  -128, 127,  -128, -128, 127,  127,  127,
                           -128, 127,  -128, -128, -128, 127,  127,  -128};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 16 * sizeof(int8_t));
  mint8m1_t i8_ts2 = mlce8_m1(i8_src2, 16 * sizeof(int8_t));
  mint8m1_t i8_out = msmul_mm(i8_ts1, i8_ts2);
  msce8_m(i8_out, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 32, " MSMUL.MM  INT8   M1");
  // int16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const int16_t i16_src1[] = {-107,   27322,  14236,  -14616, -7951,  -23334,
                              19144,  -26164, -6319,  15656,  -17200, 17232,
                              9802,   11091,  -30329, -25263, 81,     -23832,
                              -16201, -25420, -8655,  28837,  2832,   -15666};
  const int16_t i16_src2[] = {17866, 28490,  8631,  1475,   26474, -9093,
                              -9813, -19807, 21390, -26935, -4919, 26333,
                              8040,  -754,   21905, -17301, 32576, -6628,
                              6490,  -25713, 27450, -4141,  2472,  -5352};
  const int16_t i16_ans[] = {-32768, 32767,  32767,  -32768, -32768, 32767,
                             -32768, 32767,  -32768, -32768, 32767,  32767,
                             32767,  -32768, -32768, 32767,  32767,  32767,
                             -32768, 32767,  -32768, -32768, 32767,  32767};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 8 * sizeof(int16_t));
  mint16m1_t i16_ts2 = mlce16_m1(i16_src2, 8 * sizeof(int16_t));
  mint16m1_t i16_out = msmul_mm(i16_ts1, i16_ts2);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 24, " MSMUL.MM  INT16  M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const int32_t i32_src1[] = {-263605639, 510204491,   -507737612,  -1774080425,
                              10985868,   -1070690260, -1455410698, 981441527,
                              -622451711, -5799642,    731036793,   -1810380345,
                              418458979,  1294923848,  32385269,    1291051002};
  const int32_t i32_src2[] = {
      -184709674,  -1374088067, -238005008,  -981718552,
      584099231,   -1598300297, 737158782,   862167073,
      -2035852743, 417972562,   -1038691253, 95249039,
      1554653168,  960326125,   46206914,    2060421418};
  const int32_t i32_ans[] = {2147483647, -2147483648, 2147483647,  2147483647,
                             2147483647, 2147483647,  -2147483648, 2147483647,
                             2147483647, -2147483648, -2147483648, -2147483648,
                             2147483647, 2147483647,  2147483647,  2147483647};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 4 * sizeof(int32_t));
  mint32m1_t i32_ts2 = mlce32_m1(i32_src2, 4 * sizeof(int32_t));
  mint32m1_t i32_out = msmul_mm(i32_ts1, i32_ts2);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 16, " MSMUL.MM  INT32  M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const int64_t i64_src1[] = {3753418948497579440,  -1085496022898124710,
                              -7463301005853026678, -1843099728390650563,
                              897457457809234443,   2386690635629474477,
                              -1515374827062425490, -8008976934488701710,
                              -6929739669600487972, -1460742897544695920};
  const int64_t i64_src2[] = {3753418948497579440,  -1085496022898124710,
                              -7463301005853026678, -1843099728390650563,
                              897457457809234443,   -2386690635629474477,
                              1515374827062425490,  8008976934488701710,
                              6929739669600487972,  1460742897544695920};
  const int64_t i64_ans[] = {9223372036854775807,  9223372036854775807,
                             9223372036854775807,  9223372036854775807,
                             9223372036854775807,  -9223372036854775808,
                             -9223372036854775808, -9223372036854775808,
                             -9223372036854775808, -9223372036854775808};
  mint64m1_t i64_ts1 = mlce64_m1(i64_src1, 2 * sizeof(int64_t));
  mint64m1_t i64_ts2 = mlce64_m1(i64_src2, 2 * sizeof(int64_t));
  mint64m1_t i64_out = msmul_mm(i64_ts1, i64_ts2);
  msce64_m(i64_out, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 10, " MSMUL.MM  INT64  M1");
  // M2
  // int8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      108, 0,   -26, -74, 105,  100, 32,   -105, 3,   -75, 122,  -92,  9,
      47,  43,  97,  -48, 51,   -93, 75,   29,   -47, -76, -37,  11,   -121,
      84,  38,  26,  -43, -23,  -72, -123, 6,    41,  82,  110,  -102, -41,
      -81, -85, 50,  66,  -117, -19, -37,  -72,  105, 31,  -100, -66,  -110,
      49,  -26, 14,  -15, -2,   -84, 64,   -58,  60,  -35, -15,  72};
  const int8_t i8_src2_m2[] = {
      88,  123,  54,   -33, 32,   -125, -21,  -69, -114, -110, 92,  114,  48,
      114, -103, -122, 47,  -26,  -29,  -5,   -39, -47,  -77,  117, -26,  89,
      84,  -67,  -59,  103, -125, 53,   -38,  52,  98,   6,    -39, 61,   73,
      16,  104,  115,  71,  -29,  -111, -66,  -62, -82,  125,  -99, -121, 28,
      4,   -69,  22,   24,  37,   -102, -124, -40, -108, 15,   -41, 110};
  const int8_t i8_ans_m2[] = {
      127,  0,    -128, 127,  127,  -128, -128, 127,  -128, 127,  127,
      -128, 127,  127,  -128, -128, -128, -128, 127,  -128, -128, 127,
      127,  -128, -128, -128, 127,  -128, -128, -128, 127,  -128, 127,
      127,  127,  127,  -128, -128, -128, -128, -128, 127,  127,  127,
      127,  127,  127,  -128, 127,  127,  127,  -128, 127,  127,  127,
      -128, -74,  127,  -128, 127,  -128, -128, 127,  127};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_ts2_m2 = mlce8_m2(i8_src2_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_out_m2 = msmul_mm(i8_ts1_m2, i8_ts2_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 2 * 32, " MSMUL.MM  INT8   M2");
  // int16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const int16_t i16_src1_m2[] = {
      14303,  -25612, 8777,   32357,  -15786, -10335, -29106, -7334,
      6399,   -6805,  32128,  -26726, -336,   28946,  -4853,  -9214,
      1162,   -14996, -6329,  9114,   -15147, -20873, 1963,   21337,
      -29382, 8658,   -14822, 31643,  13259,  -6074,  -6771,  16114,
      9960,   -16013, 19404,  27504,  29628,  30601,  20268,  -301,
      -29714, 11658,  -5812,  -18361, 4374,   -19126, 16850,  -1866};
  const int16_t i16_src2_m2[] = {
      -2196,  10617,  -10242, 20008,  20495,  -4463,  30934,  6457,
      28919,  28940,  4477,   17043,  19520,  26903,  23297,  27825,
      -2675,  -26546, 18954,  24424,  -4430,  4387,   -32062, 214,
      -16693, 3130,   -25606, -30815, 27514,  -14363, 13571,  -26681,
      854,    7626,   -32183, -25277, -31487, 29249,  25044,  12527,
      -12325, 943,    15728,  -17248, 22379,  -17861, -15721, 23780};
  const int16_t i16_ans_m2[] = {
      -32768, -32768, -32768, 32767,  -32768, 32767,  -32768, -32768,
      32767,  -32768, 32767,  -32768, -32768, 32767,  -32768, -32768,
      -32768, 32767,  -32768, 32767,  32767,  -32768, -32768, 32767,
      32767,  32767,  32767,  -32768, 32767,  32767,  -32768, -32768,
      32767,  -32768, -32768, -32768, -32768, 32767,  32767,  -32768,
      32767,  32767,  -32768, 32767,  32767,  32767,  -32768, -32768};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_ts2_m2 = mlce16_m2(i16_src2_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_out_m2 = msmul_mm(i16_ts1_m2, i16_ts2_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 3 * 16, " MSMUL.MM  INT16  M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const int32_t i32_src1_m2[] = {
      66123367,    491167560,   819134778,  1910097559, -672913657, -856269691,
      -115327070,  381723325,   296493495,  760790490,  852671787,  -1198105470,
      -684737016,  -1417431790, 1190183684, -385699417, 2088866313, 1394629409,
      -364621030,  398520627,   580249633,  290326613,  432398980,  2007219443,
      -397552995,  1044839790,  904961016,  552157890,  643095516,  -749523318,
      -1884057886, -827959040};
  const int32_t i32_src2_m2[] = {
      1290586042,  861779553,   -2093859271, 1128909572, 468608649,
      -721632041,  -913738168,  2011583552,  1023376773, 1030671350,
      -138653176,  621402302,   2102359191,  -737029597, 227596346,
      -1927161956, -165994675,  -1194830661, 511467741,  424032955,
      494616718,   -1880867287, -1483341711, 330236097,  947505054,
      -1804791784, 2138201908,  1168171058,  1358201712, 149787080,
      -654836751,  -691571179};
  const int32_t i32_ans_m2[] = {
      2147483647,  2147483647,  -2147483648, 2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
      -2147483648, -2147483648, -2147483648, 2147483647,  2147483647,
      2147483647,  -2147483648, -2147483648, -2147483648, 2147483647,
      2147483647,  -2147483648, -2147483648, 2147483647,  -2147483648,
      -2147483648, 2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  2147483647};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_ts2_m2 = mlce32_m2(i32_src2_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_out_m2 = msmul_mm(i32_ts1_m2, i32_ts2_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 4 * 8, " MSMUL.MM  INT32  M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const int64_t i64_src1_m2[] = {2, -2, 2, -2, 2, -2, 2, -2, 2, -2,
                                 2, -2, 2, -2, 2, -2, 2, -2, 2, -2};
  const int64_t i64_src2_m2[] = {
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808};
  const int64_t i64_ans_m2[] = {
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807};
  mint64m2_t i64_ts1_m2 = mlce64_m2(i64_src1_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_ts2_m2 = mlce64_m2(i64_src2_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_out_m2 = msmul_mm(i64_ts1_m2, i64_ts2_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 5 * 4, " MSMUL.MM  INT64  M2");
  // M2
  // int8
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(64);
  const int8_t i8_src1_m4[] = {
      108, 0,   -26, -74,  105,  100,  32,   -105, 3,   -75,  122,  -92,  9,
      47,  43,  97,  -48,  51,   -93,  75,   29,   -47, -76,  -37,  11,   -121,
      84,  38,  26,  -43,  -23,  -72,  -123, 6,    41,  82,   110,  -102, -41,
      -81, -85, 50,  66,   -117, -19,  -37,  -72,  105, 31,   -100, -66,  -110,
      49,  -26, 14,  -15,  -2,   -84,  64,   -58,  60,  -35,  -15,  72,   108,
      0,   -26, -74, 105,  100,  32,   -105, 3,    -75, 122,  -92,  9,    47,
      43,  97,  -48, 51,   -93,  75,   29,   -47,  -76, -37,  11,   -121, 84,
      38,  26,  -43, -23,  -72,  -123, 6,    41,   82,  110,  -102, -41,  -81,
      -85, 50,  66,  -117, -19,  -37,  -72,  105,  31,  -100, -66,  -110, 49,
      -26, 14,  -15, -2,   -84,  64,   -58,  60,   -35, -15,  72};
  const int8_t i8_src2_m4[] = {
      88,   123,  54,   -33,  32,   -125, -21,  -69,  -114, -110, 92,   114,
      48,   114,  -103, -122, 47,   -26,  -29,  -5,   -39,  -47,  -77,  117,
      -26,  89,   84,   -67,  -59,  103,  -125, 53,   -38,  52,   98,   6,
      -39,  61,   73,   16,   104,  115,  71,   -29,  -111, -66,  -62,  -82,
      125,  -99,  -121, 28,   4,    -69,  22,   24,   37,   -102, -124, -40,
      -108, 15,   -41,  110,  88,   123,  54,   -33,  32,   -125, -21,  -69,
      -114, -110, 92,   114,  48,   114,  -103, -122, 47,   -26,  -29,  -5,
      -39,  -47,  -77,  117,  -26,  89,   84,   -67,  -59,  103,  -125, 53,
      -38,  52,   98,   6,    -39,  61,   73,   16,   104,  115,  71,   -29,
      -111, -66,  -62,  -82,  125,  -99,  -121, 28,   4,    -69,  22,   24,
      37,   -102, -124, -40,  -108, 15,   -41,  110};
  const int8_t i8_ans_m4[] = {
      127,  0,    -128, 127,  127,  -128, -128, 127,  -128, 127,  127,  -128,
      127,  127,  -128, -128, -128, -128, 127,  -128, -128, 127,  127,  -128,
      -128, -128, 127,  -128, -128, -128, 127,  -128, 127,  127,  127,  127,
      -128, -128, -128, -128, -128, 127,  127,  127,  127,  127,  127,  -128,
      127,  127,  127,  -128, 127,  127,  127,  -128, -74,  127,  -128, 127,
      -128, -128, 127,  127,  127,  0,    -128, 127,  127,  -128, -128, 127,
      -128, 127,  127,  -128, 127,  127,  -128, -128, -128, -128, 127,  -128,
      -128, 127,  127,  -128, -128, -128, 127,  -128, -128, -128, 127,  -128,
      127,  127,  127,  127,  -128, -128, -128, -128, -128, 127,  127,  127,
      127,  127,  127,  -128, 127,  127,  127,  -128, 127,  127,  127,  -128,
      -74,  127,  -128, 127,  -128, -128, 127,  127};
  mint8m4_t i8_ts1_m4 = mlce8_m4(i8_src1_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_ts2_m4 = mlce8_m4(i8_src2_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_out_m4 = msmul_mm(i8_ts1_m4, i8_ts2_m4);
  msce8_m(i8_out_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m4, i8_buffer, 2 * 64, " MSMUL.MM  INT8   M4");
  // int16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(32);
  const int16_t i16_src1_m4[] = {
      14303,  -25612, 8777,   32357,  -15786, -10335, -29106, -7334,  6399,
      -6805,  32128,  -26726, -336,   28946,  -4853,  -9214,  1162,   -14996,
      -6329,  9114,   -15147, -20873, 1963,   21337,  -29382, 8658,   -14822,
      31643,  13259,  -6074,  -6771,  16114,  9960,   -16013, 19404,  27504,
      29628,  30601,  20268,  -301,   -29714, 11658,  -5812,  -18361, 4374,
      -19126, 16850,  -1866,  14303,  -25612, 8777,   32357,  -15786, -10335,
      -29106, -7334,  6399,   -6805,  32128,  -26726, -336,   28946,  -4853,
      -9214,  1162,   -14996, -6329,  9114,   -15147, -20873, 1963,   21337,
      -29382, 8658,   -14822, 31643,  13259,  -6074,  -6771,  16114,  9960,
      -16013, 19404,  27504,  29628,  30601,  20268,  -301,   -29714, 11658,
      -5812,  -18361, 4374,   -19126, 16850,  -1866};
  const int16_t i16_src2_m4[] = {
      -2196,  10617,  -10242, 20008,  20495,  -4463,  30934,  6457,   28919,
      28940,  4477,   17043,  19520,  26903,  23297,  27825,  -2675,  -26546,
      18954,  24424,  -4430,  4387,   -32062, 214,    -16693, 3130,   -25606,
      -30815, 27514,  -14363, 13571,  -26681, 854,    7626,   -32183, -25277,
      -31487, 29249,  25044,  12527,  -12325, 943,    15728,  -17248, 22379,
      -17861, -15721, 23780,  -2196,  10617,  -10242, 20008,  20495,  -4463,
      30934,  6457,   28919,  28940,  4477,   17043,  19520,  26903,  23297,
      27825,  -2675,  -26546, 18954,  24424,  -4430,  4387,   -32062, 214,
      -16693, 3130,   -25606, -30815, 27514,  -14363, 13571,  -26681, 854,
      7626,   -32183, -25277, -31487, 29249,  25044,  12527,  -12325, 943,
      15728,  -17248, 22379,  -17861, -15721, 23780};
  const int16_t i16_ans_m4[] = {
      -32768, -32768, -32768, 32767,  -32768, 32767,  -32768, -32768, 32767,
      -32768, 32767,  -32768, -32768, 32767,  -32768, -32768, -32768, 32767,
      -32768, 32767,  32767,  -32768, -32768, 32767,  32767,  32767,  32767,
      -32768, 32767,  32767,  -32768, -32768, 32767,  -32768, -32768, -32768,
      -32768, 32767,  32767,  -32768, 32767,  32767,  -32768, 32767,  32767,
      32767,  -32768, -32768, -32768, -32768, -32768, 32767,  -32768, 32767,
      -32768, -32768, 32767,  -32768, 32767,  -32768, -32768, 32767,  -32768,
      -32768, -32768, 32767,  -32768, 32767,  32767,  -32768, -32768, 32767,
      32767,  32767,  32767,  -32768, 32767,  32767,  -32768, -32768, 32767,
      -32768, -32768, -32768, -32768, 32767,  32767,  -32768, 32767,  32767,
      -32768, 32767,  32767,  32767,  -32768, -32768};
  mint16m4_t i16_ts1_m4 = mlce16_m4(i16_src1_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_ts2_m4 = mlce16_m4(i16_src2_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_out_m4 = msmul_mm(i16_ts1_m4, i16_ts2_m4);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 3 * 32, " MSMUL.MM  INT16  M4");
  // int32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(16);
  const int32_t i32_src1_m4[] = {
      66123367,    491167560,   819134778,   1910097559,  -672913657,
      -856269691,  -115327070,  381723325,   296493495,   760790490,
      852671787,   -1198105470, -684737016,  -1417431790, 1190183684,
      -385699417,  2088866313,  1394629409,  -364621030,  398520627,
      580249633,   290326613,   432398980,   2007219443,  -397552995,
      1044839790,  904961016,   552157890,   643095516,   -749523318,
      -1884057886, -827959040,  66123367,    491167560,   819134778,
      1910097559,  -672913657,  -856269691,  -115327070,  381723325,
      296493495,   760790490,   852671787,   -1198105470, -684737016,
      -1417431790, 1190183684,  -385699417,  2088866313,  1394629409,
      -364621030,  398520627,   580249633,   290326613,   432398980,
      2007219443,  -397552995,  1044839790,  904961016,   552157890,
      643095516,   -749523318,  -1884057886, -827959040};
  const int32_t i32_src2_m4[] = {
      1290586042,  861779553,   -2093859271, 1128909572,  468608649,
      -721632041,  -913738168,  2011583552,  1023376773,  1030671350,
      -138653176,  621402302,   2102359191,  -737029597,  227596346,
      -1927161956, -165994675,  -1194830661, 511467741,   424032955,
      494616718,   -1880867287, -1483341711, 330236097,   947505054,
      -1804791784, 2138201908,  1168171058,  1358201712,  149787080,
      -654836751,  -691571179,  1290586042,  861779553,   -2093859271,
      1128909572,  468608649,   -721632041,  -913738168,  2011583552,
      1023376773,  1030671350,  -138653176,  621402302,   2102359191,
      -737029597,  227596346,   -1927161956, -165994675,  -1194830661,
      511467741,   424032955,   494616718,   -1880867287, -1483341711,
      330236097,   947505054,   -1804791784, 2138201908,  1168171058,
      1358201712,  149787080,   -654836751,  -691571179};
  const int32_t i32_ans_m4[] = {
      2147483647,  2147483647,  -2147483648, 2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
      -2147483648, -2147483648, -2147483648, 2147483647,  2147483647,
      2147483647,  -2147483648, -2147483648, -2147483648, 2147483647,
      2147483647,  -2147483648, -2147483648, 2147483647,  -2147483648,
      -2147483648, 2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  -2147483648, 2147483647,  2147483647,  2147483647,
      2147483647,  2147483647,  -2147483648, -2147483648, -2147483648,
      2147483647,  2147483647,  2147483647,  -2147483648, -2147483648,
      -2147483648, 2147483647,  2147483647,  -2147483648, -2147483648,
      2147483647,  -2147483648, -2147483648, 2147483647,  2147483647,
      2147483647,  -2147483648, 2147483647,  2147483647};
  mint32m4_t i32_ts1_m4 = mlce32_m4(i32_src1_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_ts2_m4 = mlce32_m4(i32_src2_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_out_m4 = msmul_mm(i32_ts1_m4, i32_ts2_m4);
  msce32_m(i32_out_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 4 * 16, " MSMUL.MM  INT32  M4");
  // int64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(8);
  const int64_t i64_src1_m4[] = {
      2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2,
      2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2, 2, -2};
  const int64_t i64_src2_m4[] = {
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808};
  const int64_t i64_ans_m4[] = {
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807};
  mint64m4_t i64_ts1_m4 = mlce64_m4(i64_src1_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_ts2_m4 = mlce64_m4(i64_src2_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_out_m4 = msmul_mm(i64_ts1_m4, i64_ts2_m4);
  msce64_m(i64_out_m4, i64_buffer, 8 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 5 * 8, " MSMUL.MM  INT64  M4");
}

static void test_msmulu_mm() {
  // M1
  // uint8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(16);
  const uint8_t u8_src1[] = {
      104, 27,  127, 88, 150, 146, 100, 54,  74,  239, 47, 8, 70, 26, 111, 156,
      106, 163, 221, 97, 3,   186, 232, 183, 184, 203, 46, 1, 5,  23, 198, 16};
  const uint8_t u8_src2[] = {38,  19,  228, 35,  2,   123, 135, 15,
                             121, 2,   103, 135, 105, 31,  126, 196,
                             118, 201, 105, 12,  194, 46,  147, 4,
                             245, 152, 183, 189, 48,  190, 28,  137};
  const uint8_t u8_ans[] = {255, 255, 255, 255, 255, 255, 255, 255,
                            255, 255, 255, 255, 255, 255, 255, 255,
                            255, 255, 255, 255, 255, 255, 255, 255,
                            255, 255, 255, 189, 240, 255, 255, 255};
  muint8m1_t u8_ts1 = mlce8_m1(u8_src1, 16 * sizeof(uint8_t));
  muint8m1_t u8_ts2 = mlce8_m1(u8_src2, 16 * sizeof(uint8_t));
  muint8m1_t u8_out = msmulu_mm(u8_ts1, u8_ts2);
  msce8_m(u8_out, u8_buffer, 16 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans, u8_buffer, 32, " MSMULU.MM UINT8  M1");
  // uint16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const uint16_t u16_src1[] = {3502,  52112, 18838, 34035, 20381, 55586,
                               31901, 18486, 32857, 49374, 18156, 46940,
                               52700, 34787, 49000, 25519, 31314, 32612,
                               47933, 21342, 38258, 43269, 63017, 60809};
  const uint16_t u16_src2[] = {31326, 21144, 55460, 59142, 48656, 59742,
                               29675, 20631, 8823,  24698, 59627, 20861,
                               11908, 30275, 34841, 31143, 9215,  31420,
                               13900, 61700, 33512, 2475,  33348, 16312};
  const uint16_t u16_ans[] = {65535, 65535, 65535, 65535, 65535, 65535,
                              65535, 65535, 65535, 65535, 65535, 65535,
                              65535, 65535, 65535, 65535, 65535, 65535,
                              65535, 65535, 65535, 65535, 65535, 65535};
  muint16m1_t u16_ts1 = mlce16_m1(u16_src1, 8 * sizeof(uint16_t));
  muint16m1_t u16_ts2 = mlce16_m1(u16_src2, 8 * sizeof(uint16_t));
  muint16m1_t u16_out = msmulu_mm(u16_ts1, u16_ts2);
  msce16_m(u16_out, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans, u16_buffer, 24, " MSMULU.MM UINT16 M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const uint32_t u32_src1[] = {1634608127, 4068385983, 1466966478, 1279653287,
                               701470534,  2906321757, 671304590,  3146323227,
                               1617641939, 1903393931, 4115286079, 329149189,
                               2001526958, 4011544195, 743150456,  256149634};
  const uint32_t u32_src2[] = {2424795572, 3529094572, 2467745112, 1160487951,
                               1252875333, 56928983,   3117105460, 2329600748,
                               2967704120, 4131831074, 2586504443, 384494040,
                               3010285382, 450200905,  2485819821, 3219234084};
  const uint32_t u32_ans[] = {4294967295, 4294967295, 4294967295, 4294967295,
                              4294967295, 4294967295, 4294967295, 4294967295,
                              4294967295, 4294967295, 4294967295, 4294967295,
                              4294967295, 4294967295, 4294967295, 4294967295};
  muint32m1_t u32_ts1 = mlce32_m1(u32_src1, 4 * sizeof(uint32_t));
  muint32m1_t u32_ts2 = mlce32_m1(u32_src2, 4 * sizeof(uint32_t));
  muint32m1_t u32_out = msmulu_mm(u32_ts1, u32_ts2);
  msce32_m(u32_out, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans, u32_buffer, 16, " MSMULU.MM UINT32 M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const uint64_t u64_src1[] = {18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615};
  const uint64_t u64_src2[] = {18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615,
                               18446744073709551615, 18446744073709551615};
  const uint64_t u64_ans[] = {18446744073709551615, 18446744073709551615,
                              18446744073709551615, 18446744073709551615,
                              18446744073709551615, 18446744073709551615,
                              18446744073709551615, 18446744073709551615,
                              18446744073709551615, 18446744073709551615};
  muint64m1_t u64_ts1 = mlce64_m1(u64_src1, 2 * sizeof(uint64_t));
  muint64m1_t u64_ts2 = mlce64_m1(u64_src2, 2 * sizeof(uint64_t));
  muint64m1_t u64_out = msmulu_mm(u64_ts1, u64_ts2);
  msce64_m(u64_out, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_I64_ARRAY_EQ(u64_ans, u64_buffer, 10, " MSMULU.MM UINT64 M1");
  // M2
  // uint8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const uint8_t u8_src1_m2[] = {
      199, 107, 130, 63,  125, 132, 112, 56,  170, 242, 20,  164, 85,
      149, 177, 185, 196, 74,  188, 116, 235, 35,  148, 114, 109, 220,
      177, 249, 241, 226, 197, 91,  139, 44,  213, 177, 4,   253, 67,
      60,  76,  2,   192, 54,  24,  133, 184, 181, 177, 0,   166, 0,
      231, 196, 245, 237, 159, 207, 224, 130, 184, 69,  228, 235};
  const uint8_t u8_src2_m2[] = {
      66,  72,  182, 32,  194, 156, 212, 116, 146, 244, 240, 11, 50,
      84,  102, 247, 84,  227, 43,  112, 185, 197, 18,  192, 16, 24,
      208, 75,  82,  86,  103, 209, 224, 197, 230, 147, 96,  57, 64,
      36,  144, 36,  246, 173, 65,  83,  24,  130, 124, 71,  83, 147,
      121, 207, 156, 31,  89,  235, 26,  29,  69,  148, 56,  38};
  const uint8_t u8_ans_m2[] = {
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 72,  255, 255, 255, 255, 255, 255, 255, 0,   255, 0,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255};
  muint8m2_t u8_ts1_m2 = mlce8_m2(u8_src1_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_ts2_m2 = mlce8_m2(u8_src2_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_out_m2 = msmulu_mm(u8_ts1_m2, u8_ts2_m2);
  msce8_m(u8_out_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m2, u8_buffer, 2 * 32, " MSMULU.MM UINT8  M2");
  // uint16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const uint16_t u16_src1_m2[] = {
      4835,  16984, 33169, 31040, 561,   64079, 43462, 64249, 31983, 63046,
      64415, 65524, 14527, 52009, 5971,  36512, 41608, 45699, 44069, 17742,
      12443, 8304,  14508, 53776, 21987, 257,   63,    57713, 50965, 50614,
      36911, 58673, 29060, 19194, 6505,  7837,  14412, 63830, 47556, 54358,
      11714, 28201, 25537, 33788, 32650, 25453, 377,   13430};
  const uint16_t u16_src2_m2[] = {
      41707, 51408, 24228, 18495, 55993, 26400, 28248, 16037, 1714,  58453,
      22838, 10170, 23079, 14564, 1197,  34618, 62974, 47112, 2377,  31559,
      7048,  45945, 51493, 7734,  4658,  1569,  63912, 36483, 50019, 43687,
      65251, 20040, 46887, 13869, 57738, 58228, 20447, 12977, 15146, 44095,
      56235, 64831, 12855, 63043, 46014, 6283,  51835, 7345};
  const uint16_t u16_ans_m2[] = {
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535};
  muint16m2_t u16_ts1_m2 = mlce16_m2(u16_src1_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_ts2_m2 = mlce16_m2(u16_src2_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_out_m2 = msmulu_mm(u16_ts1_m2, u16_ts2_m2);
  msce16_m(u16_out_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m2, u16_buffer, 3 * 16, " MSMULU.MM UINT16 M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const uint32_t u32_src1_m2[] = {
      13847899, 39930369, 18731493, 19686097, 2057824,  21606703, 39353868,
      3551685,  29580331, 18763347, 5367879,  8482612,  13748098, 30667810,
      10285088, 26997745, 3634568,  18462724, 29579738, 5085738,  8185704,
      14950517, 6972919,  39900345, 6838104,  29994318, 8180085,  9903226,
      23847931, 29934475, 17718641, 16803094};
  const uint32_t u32_src2_m2[] = {
      38121308, 6999947,  34378981, 11249840, 34776710, 14086584, 21503475,
      29328482, 19902353, 20321859, 4455495,  3323079,  31777123, 20684476,
      37080603, 26669629, 30536140, 9342186,  30114015, 13051472, 10128389,
      42644708, 31217466, 41741580, 41512762, 16012389, 30554719, 7953897,
      32333834, 7995009,  22404453, 4785190};
  const uint32_t u32_ans_m2[] = {
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295};
  muint32m2_t u32_ts1_m2 = mlce32_m2(u32_src1_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_ts2_m2 = mlce32_m2(u32_src2_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_out_m2 = msmulu_mm(u32_ts1_m2, u32_ts2_m2);
  msce32_m(u32_out_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m2, u32_buffer, 4 * 8, " MSMULU.MM UINT32 M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const uint64_t u64_src1_m2[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  const uint64_t u64_src2_m2[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  const uint64_t u64_ans_m2[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  muint64m2_t u64_ts1_m2 = mlce64_m2(u64_src1_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_ts2_m2 = mlce64_m2(u64_src2_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_out_m2 = msmulu_mm(u64_ts1_m2, u64_ts2_m2);
  msce64_m(u64_out_m2, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_I64_ARRAY_EQ(u64_ans_m2, u64_buffer, 5 * 4, " MSMULU.MM UINT64 M2");
  // M4
  // uint8
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(33);
  const uint8_t u8_src1_m4[] = {
      253, 53,  38,  19,  176, 250, 119, 89,  245, 116, 148, 254, 3,   105,
      218, 215, 21,  80,  156, 208, 187, 55,  83,  195, 43,  37,  209, 243,
      163, 48,  66,  165, 88,  249, 248, 48,  174, 163, 50,  75,  131, 141,
      116, 90,  189, 210, 156, 195, 185, 88,  111, 72,  217, 80,  55,  11,
      100, 44,  16,  4,   240, 176, 91,  193, 27,  43};
  const uint8_t u8_src2_m4[] = {
      152, 30,  32,  244, 219, 155, 85,  51,  213, 7,   68,  24,  215, 95,
      227, 201, 121, 141, 177, 155, 66,  179, 133, 97,  154, 28,  235, 53,
      151, 61,  74,  203, 81,  167, 122, 18,  99,  19,  128, 54,  9,   166,
      214, 57,  171, 246, 118, 179, 83,  198, 207, 229, 140, 177, 106, 160,
      34,  23,  36,  79,  0,   40,  48,  118, 153, 167};
  const uint8_t u8_ans_m4[] = {
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
      255, 255, 255, 255, 0,   255, 255, 255, 255, 255};
  muint8m4_t u8_ts1_m4 = mlce8_m4(u8_src1_m4, 33 * sizeof(uint8_t));
  muint8m4_t u8_ts2_m4 = mlce8_m4(u8_src2_m4, 33 * sizeof(uint8_t));
  muint8m4_t u8_out_m4 = msmulu_mm(u8_ts1_m4, u8_ts2_m4);
  msce8_m(u8_out_m4, u8_buffer, 33 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m4, u8_buffer, 2 * 33, " MSMULU.MM UINT8  M4");
  // uint16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(17);
  const uint16_t u16_src1_m4[] = {
      7106,  8996,  35243, 2211,  31185, 64663, 2143,  2755,  26070,
      31105, 6054,  990,   47264, 23305, 9029,  11964, 834,   50084,
      61816, 2505,  17015, 59555, 59991, 10600, 54836, 36765, 42761,
      60228, 13594, 19039, 45498, 57017, 51389, 31344, 42733, 46115,
      6837,  27079, 14717, 63860, 60583, 39096, 32580, 49214, 2110,
      39935, 10809, 700,   14585, 18611, 41627};
  const uint16_t u16_src2_m4[] = {
      57776, 30493, 2863,  35330, 37680, 28802, 29604, 57827, 22569,
      14243, 5962,  55160, 33076, 46817, 18462, 62983, 9990,  2674,
      24410, 54572, 43957, 15175, 34922, 61136, 62823, 35913, 15048,
      64992, 55127, 56356, 29621, 29351, 43001, 6547,  22916, 55421,
      9658,  49372, 61051, 23590, 53981, 22766, 51374, 41409, 21980,
      57062, 57764, 36214, 50277, 272,   3424};
  const uint16_t u16_ans_m4[] = {
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
      65535, 65535, 65535, 65535, 65535, 65535};
  muint16m4_t u16_ts1_m4 = mlce16_m4(u16_src1_m4, 17 * sizeof(uint16_t));
  muint16m4_t u16_ts2_m4 = mlce16_m4(u16_src2_m4, 17 * sizeof(uint16_t));
  muint16m4_t u16_out_m4 = msmulu_mm(u16_ts1_m4, u16_ts2_m4);
  msce16_m(u16_out_m4, u16_buffer, 17 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m4, u16_buffer, 3 * 17, " MSMULU.MM UINT16 M4");
  // int32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(9);
  const uint32_t u32_src1_m4[] = {
      19409306, 10818225, 23439123, 22526388, 36994677, 13039929,
      18818844, 34017079, 20093622, 5862819,  22578151, 21072630,
      9184095,  33724727, 17115252, 35836579, 15060415, 22910954,
      35195902, 4892504,  17686510, 32221618, 32921277, 15865516,
      34307171, 42134428, 25134241, 31080385, 4096569,  34525814,
      29693728, 38919359, 1025247,  11010752, 17601654, 30656080};
  const uint32_t u32_src2_m4[] = {
      22426388, 40204284, 23153248, 19997925, 39917982, 13190226,
      24594163, 10710783, 37321541, 36837046, 38755965, 3854234,
      17576315, 6001570,  5366054,  2181313,  32536035, 31342450,
      38137212, 3429474,  11603486, 5539746,  41477394, 16000668,
      11346589, 21666002, 20595097, 8329090,  19098338, 3932921,
      22606776, 13348414, 42276325, 33342499, 12490506, 2243574};
  const uint32_t u32_ans_m4[] = {
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
      4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295};
  muint32m4_t u32_ts1_m4 = mlce32_m4(u32_src1_m4, 9 * sizeof(uint32_t));
  muint32m4_t u32_ts2_m4 = mlce32_m4(u32_src2_m4, 9 * sizeof(uint32_t));
  muint32m4_t u32_out_m4 = msmulu_mm(u32_ts1_m4, u32_ts2_m4);
  msce32_m(u32_out_m4, u32_buffer, 9 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m4, u32_buffer, 4 * 9, " MSMULU.MM UINT32 M4");
  // int64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(5);
  const uint64_t u64_src1_m4[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  const uint64_t u64_src2_m4[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  const uint64_t u64_ans_m4[] = {
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615, 18446744073709551615,
      18446744073709551615, 18446744073709551615};
  muint64m4_t u64_ts1_m4 = mlce64_m4(u64_src1_m4, 5 * sizeof(uint64_t));
  muint64m4_t u64_ts2_m4 = mlce64_m4(u64_src2_m4, 5 * sizeof(uint64_t));
  muint64m4_t u64_out_m4 = msmulu_mm(u64_ts1_m4, u64_ts2_m4);
  msce64_m(u64_out_m4, u64_buffer, 5 * sizeof(uint64_t));
  EXCEPT_I64_ARRAY_EQ(u64_ans_m4, u64_buffer, 5 * 5, " MSMULU.MM UINT64 M4");
}

static void test_msmulsu_mm() {
  // M1
  // int8 * uint8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(16);
  const int8_t i8_src1[] = {119, 80,  -118, 64,  -57, -115, 102,  -127,
                            -76, -83, 43,   117, -4,  41,   -59,  -42,
                            14,  -90, 92,   37,  11,  104,  -49,  35,
                            48,  -97, -71,  -9,  -77, -97,  -113, 20};
  const uint8_t u8_src2[] = {3,   240, 85,  24,  244, 18,  250, 230,
                             141, 153, 154, 149, 156, 120, 63,  167,
                             28,  16,  42,  101, 153, 63,  181, 174,
                             169, 183, 134, 164, 44,  60,  37,  38};
  const int8_t i8_ans[] = {127,  127,  -128, 127,  -128, -128, 127,  -128,
                           -128, -128, 127,  127,  -128, 127,  -128, -128,
                           127,  -128, 127,  127,  127,  127,  -128, 127,
                           127,  -128, -128, -128, -128, -128, -128, 127};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 16 * sizeof(int8_t));
  muint8m1_t u8_ts2 = mlce8_m1(u8_src2, 16 * sizeof(uint8_t));
  mint8m1_t i8_out = msmulsu_mm(i8_ts1, u8_ts2);
  msce8_m(i8_out, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 32, " MSMULSU.MM E8    M1");
  // int16 * uint16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const int16_t i16_src1[] = {12570, -4182,  -12948, -6352,  -16061, -6522,
                              21739, -6619,  17381,  -14151, 16962,  -20551,
                              -5469, -13500, 7955,   -20216, 32108,  -31408,
                              -6174, 23767,  -29594, -8618,  -19535, -26600};
  const uint16_t u16_src2[] = {44384, 58678, 3553,  60908, 47270, 63079,
                               60860, 17808, 44454, 53379, 59179, 36968,
                               23005, 24397, 2231,  21756, 32019, 37014,
                               12897, 45225, 41995, 47049, 8203,  57241};
  const int16_t i16_ans[] = {32767,  -32768, -32768, -32768, -32768, -32768,
                             32767,  -32768, 32767,  -32768, 32767,  -32768,
                             -32768, -32768, 32767,  -32768, 32767,  -32768,
                             -32768, 32767,  -32768, -32768, -32768, -32768};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 8 * sizeof(int16_t));
  muint16m1_t u16_ts2 = mlce16_m1(u16_src2, 8 * sizeof(uint16_t));
  mint16m1_t i16_out = msmulsu_mm(i16_ts1, u16_ts2);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 24, "MSMULSU.MM E16   M1");
  // int32 * uint32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const int32_t i32_src1[] = {525950382,  35933534,    -2082280113, 212601511,
                              2130135820, 885633054,   410308700,   1745774321,
                              1667970820, -2082882220, -135817237,  836449302,
                              1825651948, 1843995390,  -478014602,  693390629};
  const uint32_t u32_src2[] = {762462384,  2566111694, 3986252303, 2873400204,
                               2192248108, 2704940799, 3322736292, 2125716816,
                               3992748658, 2035863641, 3096972725, 3108907365,
                               1045945482, 909580421,  799901707,  519090295};
  const int32_t i32_ans[] = {2147483647, 2147483647,  -2147483648, 2147483647,
                             2147483647, 2147483647,  2147483647,  2147483647,
                             2147483647, -2147483648, -2147483648, 2147483647,
                             2147483647, 2147483647,  -2147483648, 2147483647};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 4 * sizeof(int32_t));
  muint32m1_t u32_ts2 = mlce32_m1(u32_src2, 4 * sizeof(uint32_t));
  mint32m1_t i32_out = msmulsu_mm(i32_ts1, u32_ts2);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 16, "MSMULSU.MM E32   M1");
  // int64 * uint64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const int64_t i64_src1[] = {-557083716674211123,  -2205221404755972203,
                              8746798442008181958,  -3294148451662967088,
                              -2713815140279497021, -4321929023793918143,
                              8352848781433507242,  -1558240372368333550,
                              -8913847676019468474, 5989545924917948690};
  const uint64_t u64_src2[] = {481396561439124149,   2605661888422107903,
                               16522193339830260486, 12340647094999714009,
                               12696871045608379226, 7640334777117278173,
                               10686427431294166339, 14741961379003308057,
                               379264457081233260,   1173009046292533656};
  const int64_t i64_ans[] = {-9223372036854775808, -9223372036854775808,
                             9223372036854775807,  -9223372036854775808,
                             -9223372036854775808, -9223372036854775808,
                             9223372036854775807,  -9223372036854775808,
                             -9223372036854775808, 9223372036854775807};
  mint64m1_t i64_ts1 = mlce64_m1(i64_src1, 2 * sizeof(int64_t));
  muint64m1_t u64_ts2 = mlce64_m1(u64_src2, 2 * sizeof(uint64_t));
  mint64m1_t i64_out = msmulsu_mm(i64_ts1, u64_ts2);
  msce64_m(i64_out, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 10, "MSMULSU.MM E64   M1");
  // M2
  // int8 * uint8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      119,  80,  -118, 64,  -57,  -115, 102, -127, -76,  -83, 43,   117,  -4,
      41,   -59, -42,  14,  -90,  92,   37,  11,   104,  -49, 35,   48,   -97,
      -71,  -9,  -77,  -97, -113, 20,   119, 80,   -118, 64,  -57,  -115, 102,
      -127, -76, -83,  43,  117,  -4,   41,  -59,  -42,  14,  -90,  92,   37,
      11,   104, -49,  35,  48,   -97,  -71, -9,   -77,  -97, -113, 20};
  const uint8_t u8_src2_m2[] = {
      3,   240, 85,  24,  244, 18,  250, 230, 141, 153, 154, 149, 156,
      120, 63,  167, 28,  16,  42,  101, 153, 63,  181, 174, 169, 183,
      134, 164, 44,  60,  37,  38,  3,   240, 85,  24,  244, 18,  250,
      230, 141, 153, 154, 149, 156, 120, 63,  167, 28,  16,  42,  101,
      153, 63,  181, 174, 169, 183, 134, 164, 44,  60,  37,  38};
  const int8_t i8_ans_m2[] = {
      127,  127,  -128, 127,  -128, -128, 127,  -128, -128, -128, 127,
      127,  -128, 127,  -128, -128, 127,  -128, 127,  127,  127,  127,
      -128, 127,  127,  -128, -128, -128, -128, -128, -128, 127,  127,
      127,  -128, 127,  -128, -128, 127,  -128, -128, -128, 127,  127,
      -128, 127,  -128, -128, 127,  -128, 127,  127,  127,  127,  -128,
      127,  127,  -128, -128, -128, -128, -128, -128, 127};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  muint8m2_t u8_ts2_m2 = mlce8_m2(u8_src2_m2, 32 * sizeof(uint8_t));
  mint8m2_t i8_out_m2 = msmulsu_mm(i8_ts1_m2, u8_ts2_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 2 * 32, "MSMULSU.MM E8    M2");
  // int16 * uint16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const int16_t i16_src1_m2[] = {
      12570, -4182,  -12948, -6352,  -16061, -6522,  21739,  -6619,
      17381, -14151, 16962,  -20551, -5469,  -13500, 7955,   -20216,
      32108, -31408, -6174,  23767,  -29594, -8618,  -19535, -26600,
      12570, -4182,  -12948, -6352,  -16061, -6522,  21739,  -6619,
      17381, -14151, 16962,  -20551, -5469,  -13500, 7955,   -20216,
      32108, -31408, -6174,  23767,  -29594, -8618,  -19535, -26600};
  const uint16_t u16_src2_m2[] = {
      44384, 58678, 3553,  60908, 47270, 63079, 60860, 17808, 44454, 53379,
      59179, 36968, 23005, 24397, 2231,  21756, 32019, 37014, 12897, 45225,
      41995, 47049, 8203,  57241, 44384, 58678, 3553,  60908, 47270, 63079,
      60860, 17808, 44454, 53379, 59179, 36968, 23005, 24397, 2231,  21756,
      32019, 37014, 12897, 45225, 41995, 47049, 8203,  57241};
  const int16_t i16_ans_m2[] = {
      32767, -32768, -32768, -32768, -32768, -32768, 32767,  -32768,
      32767, -32768, 32767,  -32768, -32768, -32768, 32767,  -32768,
      32767, -32768, -32768, 32767,  -32768, -32768, -32768, -32768,
      32767, -32768, -32768, -32768, -32768, -32768, 32767,  -32768,
      32767, -32768, 32767,  -32768, -32768, -32768, 32767,  -32768,
      32767, -32768, -32768, 32767,  -32768, -32768, -32768, -32768};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 16 * sizeof(int16_t));
  muint16m2_t u16_ts2_m2 = mlce16_m2(u16_src2_m2, 16 * sizeof(uint16_t));
  mint16m2_t i16_out_m2 = msmulsu_mm(i16_ts1_m2, u16_ts2_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 3 * 16, "MSMULSU.MM E16   M2");
  // int32 * uint32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const int32_t i32_src1_m2[] = {
      525950382,   35933534,   -2082280113, 212601511,   2130135820,
      885633054,   410308700,  1745774321,  1667970820,  -2082882220,
      -135817237,  836449302,  1825651948,  1843995390,  -478014602,
      693390629,   525950382,  35933534,    -2082280113, 212601511,
      2130135820,  885633054,  410308700,   1745774321,  1667970820,
      -2082882220, -135817237, 836449302,   1825651948,  1843995390,
      -478014602,  693390629};
  const uint32_t u32_src2_m2[] = {
      762462384,  2566111694, 3986252303, 2873400204, 2192248108, 2704940799,
      3322736292, 2125716816, 3992748658, 2035863641, 3096972725, 3108907365,
      1045945482, 909580421,  799901707,  519090295,  762462384,  2566111694,
      3986252303, 2873400204, 2192248108, 2704940799, 3322736292, 2125716816,
      3992748658, 2035863641, 3096972725, 3108907365, 1045945482, 909580421,
      799901707,  519090295};
  const int32_t i32_ans_m2[] = {
      2147483647,  2147483647,  -2147483648, 2147483647,  2147483647,
      2147483647,  2147483647,  2147483647,  2147483647,  -2147483648,
      -2147483648, 2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  -2147483648, 2147483647,
      2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
      -2147483648, -2147483648, 2147483647,  2147483647,  2147483647,
      -2147483648, 2147483647};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 8 * sizeof(int32_t));
  muint32m2_t u32_ts2_m2 = mlce32_m2(u32_src2_m2, 8 * sizeof(uint32_t));
  mint32m2_t i32_out_m2 = msmulsu_mm(i32_ts1_m2, u32_ts2_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 4 * 8, "MSMULSU.MM E32   M2");
  // int64 * uint64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const int64_t i64_src1_m2[] = {
      -557083716674211123,  -2205221404755972203, 8746798442008181958,
      -3294148451662967088, -2713815140279497021, -4321929023793918143,
      8352848781433507242,  -1558240372368333550, -8913847676019468474,
      5989545924917948690,  -557083716674211123,  -2205221404755972203,
      8746798442008181958,  -3294148451662967088, -2713815140279497021,
      -4321929023793918143, 8352848781433507242,  -1558240372368333550,
      -8913847676019468474, 5989545924917948690};
  const uint64_t u64_src2_m2[] = {
      481396561439124149,   2605661888422107903,  16522193339830260486,
      12340647094999714009, 12696871045608379226, 7640334777117278173,
      10686427431294166339, 14741961379003308057, 379264457081233260,
      1173009046292533656,  481396561439124149,   2605661888422107903,
      16522193339830260486, 12340647094999714009, 12696871045608379226,
      7640334777117278173,  10686427431294166339, 14741961379003308057,
      379264457081233260,   1173009046292533656};
  const int64_t i64_ans_m2[] = {
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      -9223372036854775808, -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807};
  mint64m2_t i64_ts1_m2 = mlce64_m2(i64_src1_m2, 4 * sizeof(int64_t));
  muint64m2_t u64_ts2_m2 = mlce64_m2(u64_src2_m2, 4 * sizeof(uint64_t));
  mint64m2_t i64_out_m2 = msmulsu_mm(i64_ts1_m2, u64_ts2_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 5 * 4, "MSMULSU.MM E64   M2");
  // M4
  // int8 * uint8
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(64);
  const int8_t i8_src1_m4[] = {
      119, 80,   -118, 64,   -57, -115, 102,  -127, -76, -83,  43,   117,
      -4,  41,   -59,  -42,  14,  -90,  92,   37,   11,  104,  -49,  35,
      48,  -97,  -71,  -9,   -77, -97,  -113, 20,   119, 80,   -118, 64,
      -57, -115, 102,  -127, -76, -83,  43,   117,  -4,  41,   -59,  -42,
      14,  -90,  92,   37,   11,  104,  -49,  35,   48,  -97,  -71,  -9,
      -77, -97,  -113, 20,   119, 80,   -118, 64,   -57, -115, 102,  -127,
      -76, -83,  43,   117,  -4,  41,   -59,  -42,  14,  -90,  92,   37,
      11,  104,  -49,  35,   48,  -97,  -71,  -9,   -77, -97,  -113, 20,
      119, 80,   -118, 64,   -57, -115, 102,  -127, -76, -83,  43,   117,
      -4,  41,   -59,  -42,  14,  -90,  92,   37,   11,  104,  -49,  35,
      48,  -97,  -71,  -9,   -77, -97,  -113, 20};
  const uint8_t u8_src2_m4[] = {
      3,   240, 85,  24,  244, 18,  250, 230, 141, 153, 154, 149, 156, 120, 63,
      167, 28,  16,  42,  101, 153, 63,  181, 174, 169, 183, 134, 164, 44,  60,
      37,  38,  3,   240, 85,  24,  244, 18,  250, 230, 141, 153, 154, 149, 156,
      120, 63,  167, 28,  16,  42,  101, 153, 63,  181, 174, 169, 183, 134, 164,
      44,  60,  37,  38,  3,   240, 85,  24,  244, 18,  250, 230, 141, 153, 154,
      149, 156, 120, 63,  167, 28,  16,  42,  101, 153, 63,  181, 174, 169, 183,
      134, 164, 44,  60,  37,  38,  3,   240, 85,  24,  244, 18,  250, 230, 141,
      153, 154, 149, 156, 120, 63,  167, 28,  16,  42,  101, 153, 63,  181, 174,
      169, 183, 134, 164, 44,  60,  37,  38};
  const int8_t i8_ans_m4[] = {
      127,  127,  -128, 127,  -128, -128, 127,  -128, -128, -128, 127,  127,
      -128, 127,  -128, -128, 127,  -128, 127,  127,  127,  127,  -128, 127,
      127,  -128, -128, -128, -128, -128, -128, 127,  127,  127,  -128, 127,
      -128, -128, 127,  -128, -128, -128, 127,  127,  -128, 127,  -128, -128,
      127,  -128, 127,  127,  127,  127,  -128, 127,  127,  -128, -128, -128,
      -128, -128, -128, 127,  127,  127,  -128, 127,  -128, -128, 127,  -128,
      -128, -128, 127,  127,  -128, 127,  -128, -128, 127,  -128, 127,  127,
      127,  127,  -128, 127,  127,  -128, -128, -128, -128, -128, -128, 127,
      127,  127,  -128, 127,  -128, -128, 127,  -128, -128, -128, 127,  127,
      -128, 127,  -128, -128, 127,  -128, 127,  127,  127,  127,  -128, 127,
      127,  -128, -128, -128, -128, -128, -128, 127};
  mint8m4_t i8_ts1_m4 = mlce8_m4(i8_src1_m4, 64 * sizeof(int8_t));
  muint8m4_t u8_ts2_m4 = mlce8_m4(u8_src2_m4, 64 * sizeof(uint8_t));
  mint8m4_t i8_out_m4 = msmulsu_mm(i8_ts1_m4, u8_ts2_m4);
  msce8_m(i8_out_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m4, i8_buffer, 2 * 64, "MSMULSU.MM E8    M4");
  // int16 * uint16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(32);
  const int16_t i16_src1_m4[] = {
      12570,  -4182,  -12948, -6352,  -16061, -6522,  21739,  -6619,  17381,
      -14151, 16962,  -20551, -5469,  -13500, 7955,   -20216, 32108,  -31408,
      -6174,  23767,  -29594, -8618,  -19535, -26600, 12570,  -4182,  -12948,
      -6352,  -16061, -6522,  21739,  -6619,  17381,  -14151, 16962,  -20551,
      -5469,  -13500, 7955,   -20216, 32108,  -31408, -6174,  23767,  -29594,
      -8618,  -19535, -26600, 12570,  -4182,  -12948, -6352,  -16061, -6522,
      21739,  -6619,  17381,  -14151, 16962,  -20551, -5469,  -13500, 7955,
      -20216, 32108,  -31408, -6174,  23767,  -29594, -8618,  -19535, -26600,
      12570,  -4182,  -12948, -6352,  -16061, -6522,  21739,  -6619,  17381,
      -14151, 16962,  -20551, -5469,  -13500, 7955,   -20216, 32108,  -31408,
      -6174,  23767,  -29594, -8618,  -19535, -26600};
  const uint16_t u16_src2_m4[] = {
      44384, 58678, 3553,  60908, 47270, 63079, 60860, 17808, 44454, 53379,
      59179, 36968, 23005, 24397, 2231,  21756, 32019, 37014, 12897, 45225,
      41995, 47049, 8203,  57241, 44384, 58678, 3553,  60908, 47270, 63079,
      60860, 17808, 44454, 53379, 59179, 36968, 23005, 24397, 2231,  21756,
      32019, 37014, 12897, 45225, 41995, 47049, 8203,  57241, 44384, 58678,
      3553,  60908, 47270, 63079, 60860, 17808, 44454, 53379, 59179, 36968,
      23005, 24397, 2231,  21756, 32019, 37014, 12897, 45225, 41995, 47049,
      8203,  57241, 44384, 58678, 3553,  60908, 47270, 63079, 60860, 17808,
      44454, 53379, 59179, 36968, 23005, 24397, 2231,  21756, 32019, 37014,
      12897, 45225, 41995, 47049, 8203,  57241};
  const int16_t i16_ans_m4[] = {
      32767,  -32768, -32768, -32768, -32768, -32768, 32767,  -32768, 32767,
      -32768, 32767,  -32768, -32768, -32768, 32767,  -32768, 32767,  -32768,
      -32768, 32767,  -32768, -32768, -32768, -32768, 32767,  -32768, -32768,
      -32768, -32768, -32768, 32767,  -32768, 32767,  -32768, 32767,  -32768,
      -32768, -32768, 32767,  -32768, 32767,  -32768, -32768, 32767,  -32768,
      -32768, -32768, -32768, 32767,  -32768, -32768, -32768, -32768, -32768,
      32767,  -32768, 32767,  -32768, 32767,  -32768, -32768, -32768, 32767,
      -32768, 32767,  -32768, -32768, 32767,  -32768, -32768, -32768, -32768,
      32767,  -32768, -32768, -32768, -32768, -32768, 32767,  -32768, 32767,
      -32768, 32767,  -32768, -32768, -32768, 32767,  -32768, 32767,  -32768,
      -32768, 32767,  -32768, -32768, -32768, -32768};
  mint16m4_t i16_ts1_m4 = mlce16_m4(i16_src1_m4, 32 * sizeof(int16_t));
  muint16m4_t u16_ts2_m4 = mlce16_m4(u16_src2_m4, 32 * sizeof(uint16_t));
  mint16m4_t i16_out_m4 = msmulsu_mm(i16_ts1_m4, u16_ts2_m4);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 3 * 32, "MSMULSU.MM E16   M4");
  // int32 * uint32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(16);
  const int32_t i32_src1_m4[] = {
      525950382,   35933534,    -2082280113, 212601511,   2130135820,
      885633054,   410308700,   1745774321,  1667970820,  -2082882220,
      -135817237,  836449302,   1825651948,  1843995390,  -478014602,
      693390629,   525950382,   35933534,    -2082280113, 212601511,
      2130135820,  885633054,   410308700,   1745774321,  1667970820,
      -2082882220, -135817237,  836449302,   1825651948,  1843995390,
      -478014602,  693390629,   525950382,   35933534,    -2082280113,
      212601511,   2130135820,  885633054,   410308700,   1745774321,
      1667970820,  -2082882220, -135817237,  836449302,   1825651948,
      1843995390,  -478014602,  693390629,   525950382,   35933534,
      -2082280113, 212601511,   2130135820,  885633054,   410308700,
      1745774321,  1667970820,  -2082882220, -135817237,  836449302,
      1825651948,  1843995390,  -478014602,  693390629};
  const uint32_t u32_src2_m4[] = {
      762462384,  2566111694, 3986252303, 2873400204, 2192248108, 2704940799,
      3322736292, 2125716816, 3992748658, 2035863641, 3096972725, 3108907365,
      1045945482, 909580421,  799901707,  519090295,  762462384,  2566111694,
      3986252303, 2873400204, 2192248108, 2704940799, 3322736292, 2125716816,
      3992748658, 2035863641, 3096972725, 3108907365, 1045945482, 909580421,
      799901707,  519090295,  762462384,  2566111694, 3986252303, 2873400204,
      2192248108, 2704940799, 3322736292, 2125716816, 3992748658, 2035863641,
      3096972725, 3108907365, 1045945482, 909580421,  799901707,  519090295,
      762462384,  2566111694, 3986252303, 2873400204, 2192248108, 2704940799,
      3322736292, 2125716816, 3992748658, 2035863641, 3096972725, 3108907365,
      1045945482, 909580421,  799901707,  519090295};
  const int32_t i32_ans_m4[] = {
      2147483647,  2147483647,  -2147483648, 2147483647,  2147483647,
      2147483647,  2147483647,  2147483647,  2147483647,  -2147483648,
      -2147483648, 2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  -2147483648, 2147483647,
      2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
      -2147483648, -2147483648, 2147483647,  2147483647,  2147483647,
      -2147483648, 2147483647,  2147483647,  2147483647,  -2147483648,
      2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
      2147483647,  -2147483648, -2147483648, 2147483647,  2147483647,
      2147483647,  -2147483648, 2147483647,  2147483647,  2147483647,
      -2147483648, 2147483647,  2147483647,  2147483647,  2147483647,
      2147483647,  2147483647,  -2147483648, -2147483648, 2147483647,
      2147483647,  2147483647,  -2147483648, 2147483647};
  mint32m4_t i32_ts1_m4 = mlce32_m4(i32_src1_m4, 16 * sizeof(int32_t));
  muint32m4_t u32_ts2_m4 = mlce32_m4(u32_src2_m4, 16 * sizeof(uint32_t));
  mint32m4_t i32_out_m4 = msmulsu_mm(i32_ts1_m4, u32_ts2_m4);
  msce32_m(i32_out_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 4 * 16, "MSMULSU.MM E32   M4");
  // int64 * uint64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(8);
  const int64_t i64_src1_m4[] = {
      -557083716674211123,  -2205221404755972203, 8746798442008181958,
      -3294148451662967088, -2713815140279497021, -4321929023793918143,
      8352848781433507242,  -1558240372368333550, -8913847676019468474,
      5989545924917948690,  -557083716674211123,  -2205221404755972203,
      8746798442008181958,  -3294148451662967088, -2713815140279497021,
      -4321929023793918143, 8352848781433507242,  -1558240372368333550,
      -8913847676019468474, 5989545924917948690,  -557083716674211123,
      -2205221404755972203, 8746798442008181958,  -3294148451662967088,
      -2713815140279497021, -4321929023793918143, 8352848781433507242,
      -1558240372368333550, -8913847676019468474, 5989545924917948690,
      -557083716674211123,  -2205221404755972203, 8746798442008181958,
      -3294148451662967088, -2713815140279497021, -4321929023793918143,
      8352848781433507242,  -1558240372368333550, -8913847676019468474,
      5989545924917948690};
  const uint64_t u64_src2_m4[] = {
      481396561439124149,   2605661888422107903,  16522193339830260486,
      12340647094999714009, 12696871045608379226, 7640334777117278173,
      10686427431294166339, 14741961379003308057, 379264457081233260,
      1173009046292533656,  481396561439124149,   2605661888422107903,
      16522193339830260486, 12340647094999714009, 12696871045608379226,
      7640334777117278173,  10686427431294166339, 14741961379003308057,
      379264457081233260,   1173009046292533656,  481396561439124149,
      2605661888422107903,  16522193339830260486, 12340647094999714009,
      12696871045608379226, 7640334777117278173,  10686427431294166339,
      14741961379003308057, 379264457081233260,   1173009046292533656,
      481396561439124149,   2605661888422107903,  16522193339830260486,
      12340647094999714009, 12696871045608379226, 7640334777117278173,
      10686427431294166339, 14741961379003308057, 379264457081233260,
      1173009046292533656};
  const int64_t i64_ans_m4[] = {
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      -9223372036854775808, -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  -9223372036854775808,
      -9223372036854775808, 9223372036854775807,  -9223372036854775808,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      -9223372036854775808, -9223372036854775808, 9223372036854775807,
      -9223372036854775808, -9223372036854775808, -9223372036854775808,
      9223372036854775807,  -9223372036854775808, -9223372036854775808,
      9223372036854775807};
  mint64m4_t i64_ts1_m4 = mlce64_m4(i64_src1_m4, 8 * sizeof(int64_t));
  muint64m4_t u64_ts2_m4 = mlce64_m4(u64_src2_m4, 8 * sizeof(uint64_t));
  mint64m4_t i64_out_m4 = msmulsu_mm(i64_ts1_m4, u64_ts2_m4);
  msce64_m(i64_out_m4, i64_buffer, 8 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 5 * 8, "MSMULSU.MM E64   M4");
}

static void test_mwmul_mm() {
  // M1
  // int8_m1 * int8_m1 -> int16_m2
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(8);
  const int8_t i8_src1[] = {3, -9, -9, -5, 7,  3, -4, 7,
                            8, 3,  7,  6,  -3, 3, 2,  -5};
  const int8_t i8_src2[] = {9, 7, -4, 5, -6, 6, 1, 6, 8, 0, 0, 4, 1, 2, 2, 2};
  const int16_t i16_ans[] = {27, -63, 36, -25, -42, 18, -4, 42,
                             64, 0,   0,  24,  -3,  6,  4,  -10};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 8 * sizeof(int8_t));
  mint8m1_t i8_ts2 = mlce8_m1(i8_src2, 8 * sizeof(int8_t));
  mint16m2_t i16_out = mwmul_mm(i8_ts1, i8_ts2);
  msettype(E16, M1, BA);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 16, "MWMUL.MM   INT8  M1");
  // int16_m1 * int16_m1 -> int32_m2
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(4);
  const int16_t i16_src1[] = {30005, 5642,   11864, 27362, -3558, -27185,
                              -7175, 31256,  9518,  7073,  -6417, -15898,
                              2252,  -20299, 31654, -6958};
  const int16_t i16_src2[] = {-7206, 30991,  14420, -24379, -23905, 11246,
                              -8216, -4380,  -8777, -4246,  22764,  29002,
                              30669, -17520, -798,  27389};
  const int32_t i32_ans[] = {-216216030, 174851222,  171078880,  -667058198,
                             85053990,   -305722510, 58949800,   -136901280,
                             -83539486,  -30031958,  -146076588, -461073796,
                             69066588,   355638480,  -25259892,  -190572662};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 4 * sizeof(int16_t));
  mint16m1_t i16_ts2 = mlce16_m1(i16_src2, 4 * sizeof(int16_t));
  mint32m2_t i32_out = mwmul_mm(i16_ts1, i16_ts2);
  msettype(E32, M1, BA);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 12, "MWMUL.MM   INT16 M1");
  // int32_m1 * int32_m1 -> int64_m2
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(2);
  const int32_t i32_src1[] = {46596932,    -553489760, 299231084,  -1774547681,
                              -1972003491, 995546582,  1937272988, 175260141};
  const int32_t i32_src2[] = {-1201037433, 868024893,   168118527,
                              -7140496,    -1527478945, 1355263372,
                              -1775460629, -1504030293};
  const int64_t i64_ans[] = {-55964659594955556,   -480442889700595680,
                             50306289074693268,    12671150617989776,
                             3012193811968996995,  1349227817704394504,
                             -3439551917819189452, -263596561219451313};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 2 * sizeof(int32_t));
  mint32m1_t i32_ts2 = mlce32_m1(i32_src2, 2 * sizeof(int32_t));
  mint64m2_t i64_out = mwmul_mm(i32_ts1, i32_ts2);
  msettype(E64, M1, BA);
  msce64_m(i64_out, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 8, "MWMUL.MM   INT32 M1");
  // M2
  // int8 * int8 -> int16
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      3, -9, -9, -5, 7, 3, -4, 7, 8, 3, 7, 6, -3, 3, 2, -5,
      3, -9, -9, -5, 7, 3, -4, 7, 8, 3, 7, 6, -3, 3, 2, -5,
      3, -9, -9, -5, 7, 3, -4, 7, 8, 3, 7, 6, -3, 3, 2, -5,
      3, -9, -9, -5, 7, 3, -4, 7, 8, 3, 7, 6, -3, 3, 2, -5};
  const int8_t i8_src2_m2[] = {
      9, 7, -4, 5, -6, 6, 1,  6, 8,  0, 0, 4, 1,  2, 2,  2, 9, 7, -4, 5, -6, 6,
      1, 6, 8,  0, 0,  4, 1,  2, 2,  2, 9, 7, -4, 5, -6, 6, 1, 6, 8,  0, 0,  4,
      1, 2, 2,  2, 9,  7, -4, 5, -6, 6, 1, 6, 8,  0, 0,  4, 1, 2, 2,  2};
  const int16_t i16_ans_m4[] = {
      27, -63, 36, -25, -42, 18, -4, 42, 64, 0, 0, 24, -3, 6, 4, -10,
      27, -63, 36, -25, -42, 18, -4, 42, 64, 0, 0, 24, -3, 6, 4, -10,
      27, -63, 36, -25, -42, 18, -4, 42, 64, 0, 0, 24, -3, 6, 4, -10,
      27, -63, 36, -25, -42, 18, -4, 42, 64, 0, 0, 24, -3, 6, 4, -10};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_ts2_m2 = mlce8_m2(i8_src2_m2, 32 * sizeof(int8_t));
  mint16m4_t i16_out_m4 = mwmul_mm(i8_ts1_m2, i8_ts2_m2);
  msettype(E16, M4, BA);
  msettileni(32);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 2 * 32, "MWMUL.MM   INT8  M2");
  // int16 * int16 -> int32
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(8);
  const int16_t i16_src1_m2[] = {
      30005, 5642, 11864, 27362,  -3558, -27185, -7175, 31256,
      9518,  7073, -6417, -15898, 2252,  -20299, 31654, -6958,
      30005, 5642, 11864, 27362,  -3558, -27185, -7175, 31256,
      9518,  7073, -6417, -15898, 2252,  -20299, 31654, -6958};
  const int16_t i16_src2_m2[] = {
      -7206, 30991, 14420, -24379, -23905, 11246,  -8216, -4380,
      -8777, -4246, 22764, 29002,  30669,  -17520, -798,  27389,
      -7206, 30991, 14420, -24379, -23905, 11246,  -8216, -4380,
      -8777, -4246, 22764, 29002,  30669,  -17520, -798,  27389};
  const int32_t i32_ans_m4[] = {
      -216216030, 174851222,  171078880,  -667058198, 85053990,   -305722510,
      58949800,   -136901280, -83539486,  -30031958,  -146076588, -461073796,
      69066588,   355638480,  -25259892,  -190572662, -216216030, 174851222,
      171078880,  -667058198, 85053990,   -305722510, 58949800,   -136901280,
      -83539486,  -30031958,  -146076588, -461073796, 69066588,   355638480,
      -25259892,  -190572662};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 8 * sizeof(int16_t));
  mint16m2_t i16_ts2_m2 = mlce16_m2(i16_src2_m2, 8 * sizeof(int16_t));
  mint32m4_t i32_out_m4 = mwmul_mm(i16_ts1_m2, i16_ts2_m2);
  msettype(E32, M4, BA);
  msettileni(8);
  msce32_m(i32_out_m4, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 3 * 8, "MWMUL.MM   INT16 M2");
  // int32 * int32 -> int64
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(4);
  const int32_t i32_src1_m2[] = {46596932,    -553489760,  299231084,
                                 -1774547681, -1972003491, 995546582,
                                 1937272988,  175260141};
  const int32_t i32_src2_m2[] = {-1201037433, 868024893,   168118527,
                                 -7140496,    -1527478945, 1355263372,
                                 -1775460629, -1504030293};
  const int64_t i64_ans_m4[] = {-55964659594955556,   -480442889700595680,
                                50306289074693268,    12671150617989776,
                                3012193811968996995,  1349227817704394504,
                                -3439551917819189452, -263596561219451313};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 4 * sizeof(int32_t));
  mint32m2_t i32_ts2_m2 = mlce32_m2(i32_src2_m2, 4 * sizeof(int32_t));
  mint64m4_t i64_out_m4 = mwmul_mm(i32_ts1_m2, i32_ts2_m2);
  msettype(E64, M4, BA);
  msettileni(4);
  msce64_m(i64_out_m4, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 8, "MWMUL.MM   INT32 M2");
}

static void test_mwmulu_mm() {
  // M1
  // uint8_m1 * uint8_m1 -> uint16_m2
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(8);
  const uint8_t u8_src1[] = {40, 30, 70, 31, 40, 63, 9,  65,
                             79, 37, 6,  25, 78, 79, 78, 12};
  const uint8_t u8_src2[] = {59, 84, 76, 51, 48, 91, 96, 54,
                             23, 99, 60, 13, 48, 15, 19, 6};
  const uint16_t u16_ans[] = {2360, 2520, 5320, 1581, 1920, 5733, 864,  3510,
                              1817, 3663, 360,  325,  3744, 1185, 1482, 72};
  muint8m1_t u8_ts1 = mlce8_m1(u8_src1, 8 * sizeof(uint8_t));
  muint8m1_t u8_ts2 = mlce8_m1(u8_src2, 8 * sizeof(uint8_t));
  muint16m2_t u16_out = mwmulu_mm(u8_ts1, u8_ts2);
  msettype(E16, M1, BA);
  msce16_m(u16_out, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans, u16_buffer, 16, "MWMULU.MM  UINT8  M1");
  // uint16_m1 * uint16_m1 -> uint32_m2
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(4);
  const uint16_t u16_src1[] = {40, 30, 70, 31, 40, 63, 9,  65,
                               79, 37, 6,  25, 78, 79, 78, 12};
  const uint16_t u16_src2[] = {59, 84, 76, 51, 48, 91, 96, 54,
                               23, 99, 60, 13, 48, 15, 19, 6};
  const uint32_t u32_ans[] = {2360, 2520, 5320, 1581, 1920, 5733, 864,  3510,
                              1817, 3663, 360,  325,  3744, 1185, 1482, 72};
  muint16m1_t u16_ts1 = mlce16_m1(u16_src1, 4 * sizeof(uint16_t));
  muint16m1_t u16_ts2 = mlce16_m1(u16_src2, 4 * sizeof(uint16_t));
  muint32m2_t u32_out = mwmulu_mm(u16_ts1, u16_ts2);
  msettype(E32, M1, BA);
  msce32_m(u32_out, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans, u32_buffer, 12, "MWMULU.MM  UINT16 M1");
  // uint32_m1 * uint32_m1 -> uint64_m2
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(2);
  const uint32_t u32_src1[] = {5626299,  8269027,  10652139, 39512841,
                               28909143, 40922555, 13290949, 31375824};
  const uint32_t u32_src2[] = {27450192, 18109559, 38152232, 3635401,
                               7176024,  36500118, 19713312, 13549695};
  const uint64_t u64_ans[] = {
      154442987799408, 149748432329093,  406402878424248, 143645021684241,
      207452703987432, 1493678086361490, 262008624413088, 425132845573680};
  muint32m1_t u32_ts1 = mlce32_m1(u32_src1, 2 * sizeof(uint32_t));
  muint32m1_t u32_ts2 = mlce32_m1(u32_src2, 2 * sizeof(uint32_t));
  muint64m2_t u64_out = mwmulu_mm(u32_ts1, u32_ts2);
  msettype(E64, M1, BA);
  msce64_m(u64_out, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans, u64_buffer, 8, "MWMULU.MM  UINT32 M1");
  // M2
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const uint8_t u8_src1_m2[] = {
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12,
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12,
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12,
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12};
  const uint8_t u8_src2_m2[] = {
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6,
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6,
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6,
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6};
  const uint16_t u16_ans_m4[] = {
      2360, 2520, 5320, 1581, 1920, 5733, 864,  3510, 1817, 3663, 360,
      325,  3744, 1185, 1482, 72,   2360, 2520, 5320, 1581, 1920, 5733,
      864,  3510, 1817, 3663, 360,  325,  3744, 1185, 1482, 72,   2360,
      2520, 5320, 1581, 1920, 5733, 864,  3510, 1817, 3663, 360,  325,
      3744, 1185, 1482, 72,   2360, 2520, 5320, 1581, 1920, 5733, 864,
      3510, 1817, 3663, 360,  325,  3744, 1185, 1482, 72};
  muint8m2_t u8_ts1_m2 = mlce8_m2(u8_src1_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_ts2_m2 = mlce8_m2(u8_src2_m2, 32 * sizeof(uint8_t));
  muint16m4_t u16_out_m4 = mwmulu_mm(u8_ts1_m2, u8_ts2_m2);
  msettype(E16, M4, BA);
  msettileni(32);
  msce16_m(u16_out_m4, u16_buffer, 32 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m4, u16_buffer, 2 * 32, "MWMULU.MM  UINT8  M2");

  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const uint16_t u16_src1_m2[] = {
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12,
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12,
      40, 30, 70, 31, 40, 63, 9, 65, 79, 37, 6, 25, 78, 79, 78, 12};
  const uint16_t u16_src2_m2[] = {
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6,
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6,
      59, 84, 76, 51, 48, 91, 96, 54, 23, 99, 60, 13, 48, 15, 19, 6};
  const uint32_t u32_ans_m4[] = {
      2360, 2520, 5320, 1581, 1920, 5733, 864,  3510, 1817, 3663, 360,  325,
      3744, 1185, 1482, 72,   2360, 2520, 5320, 1581, 1920, 5733, 864,  3510,
      1817, 3663, 360,  325,  3744, 1185, 1482, 72,   2360, 2520, 5320, 1581,
      1920, 5733, 864,  3510, 1817, 3663, 360,  325,  3744, 1185, 1482, 72};
  muint16m2_t u16_ts1_m2 = mlce16_m2(u16_src1_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_ts2_m2 = mlce16_m2(u16_src2_m2, 16 * sizeof(uint16_t));
  muint32m4_t u32_out_m4 = mwmulu_mm(u16_ts1_m2, u16_ts2_m2);
  msettype(E32, M4, BA);
  msettileni(16);
  msce32_m(u32_out_m4, u32_buffer, 16 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m4, u32_buffer, 3 * 16, "MWMULU.MM  UINT16 M2");

  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const uint32_t u32_src1_m2[] = {
      5626299,  8269027,  10652139, 39512841, 28909143, 40922555, 13290949,
      31375824, 5626299,  8269027,  10652139, 39512841, 28909143, 40922555,
      13290949, 31375824, 5626299,  8269027,  10652139, 39512841, 28909143,
      40922555, 13290949, 31375824, 5626299,  8269027,  10652139, 39512841,
      28909143, 40922555, 13290949, 31375824};
  const uint32_t u32_src2_m2[] = {
      27450192, 18109559, 38152232, 3635401,  7176024,  36500118, 19713312,
      13549695, 27450192, 18109559, 38152232, 3635401,  7176024,  36500118,
      19713312, 13549695, 27450192, 18109559, 38152232, 3635401,  7176024,
      36500118, 19713312, 13549695, 27450192, 18109559, 38152232, 3635401,
      7176024,  36500118, 19713312, 13549695};
  const uint64_t u64_ans_m4[] = {
      154442987799408, 149748432329093,  406402878424248, 143645021684241,
      207452703987432, 1493678086361490, 262008624413088, 425132845573680,
      154442987799408, 149748432329093,  406402878424248, 143645021684241,
      207452703987432, 1493678086361490, 262008624413088, 425132845573680,
      154442987799408, 149748432329093,  406402878424248, 143645021684241,
      207452703987432, 1493678086361490, 262008624413088, 425132845573680,
      154442987799408, 149748432329093,  406402878424248, 143645021684241,
      207452703987432, 1493678086361490, 262008624413088, 425132845573680};
  muint32m2_t u32_ts1_m2 = mlce32_m2(u32_src1_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_ts2_m2 = mlce32_m2(u32_src2_m2, 8 * sizeof(uint32_t));
  muint64m4_t u64_out_m4 = mwmulu_mm(u32_ts1_m2, u32_ts2_m2);
  msettype(E64, M4, BA);
  msettileni(8);
  msce64_m(u64_out_m4, u64_buffer, 8 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans_m4, u64_buffer, 4 * 8, "MWMULU.MM  UINT32 M2");
}

static void test_mmul_mm() {
  // M1
  // int8
  msettype(E8, M1, BA);
  msettilemi(5);
  msettileni(16);
  const int8_t i8_src1[] = {
      111,  74,   36,   -72, -121, -124, -23,  36,   42,  42,  -117, -100,
      109,  49,   -44,  -39, -108, 104,  -48,  101,  81,  120, -58,  -115,
      71,   19,   -102, -77, -74,  -18,  13,   44,   -21, 42,  62,   99,
      72,   -73,  38,   41,  96,   72,   -59,  -100, 119, -90, -5,   87,
      -100, -102, 48,   -1,  126,  -118, -102, -22,  101, 56,  124,  31,
      -85,  60,   -115, 23,  29,   106,  -31,  36,   62,  -49, -91,  12,
      4,    -122, 74,   -76, 77,   64,   9,    -127};
  const int8_t i8_src2[] = {
      -54,  45,   -107, -20, 11,  53,   33,   21,  -9,   -2,  -8,   -90,
      -56,  121,  -75,  35,  100, -112, -103, -57, -48,  -44, -80,  87,
      -75,  -107, -102, 0,   -44, -51,  80,   -33, -106, 107, 85,   -111,
      40,   -49,  -97,  117, 99,  -35,  -86,  -90, 45,   91,  -73,  -97,
      68,   41,   -53,  -34, 45,  -41,  -120, -90, 124,  -41, -100, 121,
      21,   21,   -30,  73,  -26, -17,  26,   -7,  -71,  -46, 42,   -94,
      -119, -65,  -91,  47,  100, 97,   -12,  5};
  const int8_t i8_ans[] = {
      0b10010110, 0b00000010, 0b11110100, 0b10100000, 0b11001101, 0b01010100,
      0b00001001, 0b11110100, 0b10000110, 0b10101100, 0b10101000, 0b00101000,
      0b00101000, 0b00101001, 0b11100100, 0b10101011, 0b11010000, 0b10000000,
      0b01010000, 0b10000011, 0b11010000, 0b01100000, 0b00100000, 0b11101011,
      0b00110011, 0b00001111, 0b10100100, 0b00000000, 0b10111000, 0b10010110,
      0b00010000, 0b01010100, 0b10110010, 0b10001110, 0b10010110, 0b00010011,
      0b01000000, 0b11111001, 0b10011010, 0b10111101, 0b00100000, 0b00101000,
      0b11010010, 0b00101000, 0b11101011, 0b00000010, 0b01101101, 0b00001001,
      0b01110000, 0b10101010, 0b00010000, 0b00100010, 0b00100110, 0b11100110,
      0b11010000, 0b10111100, 0b11101100, 0b00001000, 0b10010000, 0b10100111,
      0b00000111, 0b11101100, 0b01111010, 0b10001111, 0b00001110, 0b11110110,
      0b11011010, 0b00000100, 0b11001110, 0b11001110, 0b00010010, 0b10011000,
      0b00100100, 0b11111010, 0b10110010, 0b00001100, 0b00010100, 0b01000000,
      0b10010100, 0b10000101};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 16 * sizeof(int8_t));
  mint8m1_t i8_ts2 = mlce8_m1(i8_src2, 16 * sizeof(int8_t));
  mint8m1_t i8_out = mmul_mm(i8_ts1, i8_ts2);
  msce8_m(i8_out, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 80, "MMUL.MM INT8  M1");
  // int16
  msettype(E16, M1, BA);
  msettilemi(4);
  msettileni(8);
  const int16_t i16_src1[] = {
      -5902,  475,    20032,  457,   3932,   -29934, 11950,  2585,
      -12594, -28837, 22098,  -7916, -17630, 9787,   -26824, -10431,
      22422,  28301,  -16926, -3301, 27054,  -2693,  3171,   2125,
      31609,  -13366, 21463,  19079, 2190,   -1,     -12370, -15122};
  const int16_t i16_src2[] = {
      1618,   32016,  12839, -14307, -23068, 5225,   -10898, 19280,
      19174,  11471,  29950, -19985, -10665, -11767, 28750,  14579,
      -23237, 32112,  29760, -14764, -27210, -30176, 8173,   30292,
      30446,  -26749, 29335, -14402, -818,   -9817,  20889,  -14192};
  const int16_t i16_ans[] = {
      0b0100100110000100, 0b0000110010110000, 0b0110101111000000,
      0b0011101111000101, 0b1111100111110000, 0b0111001001100010,
      0b1101010011000100, 0b0111101011010000, 0b0101100100010100,
      0b1000111010010101, 0b1100110101011100, 0b1111010110101100,
      0b0000010010001110, 0b1011111000010011, 0b1001001100010000,
      0b1000101010110011, 0b1101110110010010, 0b0011011010110000,
      0b1110000010000000, 0b1010011011011100, 0b0110011110110100,
      0b1111110101100000, 0b0111010010100111, 0b0011011101000100,
      0b1001000001111110, 0b0110111001011110, 0b0011000111010001,
      0b0100000100110010, 0b1010101001000100, 0b0010011001011001,
      0b0010110011111110, 0b1011010111100000};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 8 * sizeof(int16_t));
  mint16m1_t i16_ts2 = mlce16_m1(i16_src2, 8 * sizeof(int16_t));
  mint16m1_t i16_out = mmul_mm(i16_ts1, i16_ts2);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 32, "MMUL.MM INT16 M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(5);
  msettileni(4);
  const int32_t i32_src1[] = {
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573};
  const int32_t i32_src2[] = {1510444861, 1001848163,  1325478368, -1732913065,
                              -517488933, -1503842313, 1204301170, 763102971,
                              166057080,  657407816,   1500977977, -2095285952,
                              -182832949, 31379264,    837633032,  -1720048366,
                              -881848507, -1558943035, 26524537,   -99008218};
  const int32_t i32_ans[] = {
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 4 * sizeof(int32_t));
  mint32m1_t i32_ts2 = mlce32_m1(i32_src2, 4 * sizeof(int32_t));
  mint32m1_t i32_out = mmul_mm(i32_ts1, i32_ts2);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 20, "MMUL.MM INT32 M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(1);
  msettileni(1);
  const int64_t i64_src1[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2[] = {2};
  const int64_t i64_ans[] = {
      0b1111111111111111111111111111111111111111111111111111111111111110};
  mint64m1_t i64_ts1 = mlce64_m1(i64_src1, 1 * sizeof(int64_t));
  mint64m1_t i64_ts2 = mlce64_m1(i64_src2, 1 * sizeof(int64_t));
  mint64m1_t i64_out = mmul_mm(i64_ts1, i64_ts2);
  msce64_m(i64_out, i64_buffer, 1 * sizeof(int32_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 1, "MMUL.MM INT64 M1");
  // M2
  // int8
  msettype(E8, M2, BA);
  msettilemi(5);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      111,  74,   36,   -72,  -121, -124, -23,  36,   42,   42,   -117, -100,
      109,  49,   -44,  -39,  -108, 104,  -48,  101,  81,   120,  -58,  -115,
      71,   19,   -102, -77,  -74,  -18,  13,   44,   -21,  42,   62,   99,
      72,   -73,  38,   41,   96,   72,   -59,  -100, 119,  -90,  -5,   87,
      -100, -102, 48,   -1,   126,  -118, -102, -22,  101,  56,   124,  31,
      -85,  60,   -115, 23,   29,   106,  -31,  36,   62,   -49,  -91,  12,
      4,    -122, 74,   -76,  77,   64,   9,    -127, 111,  74,   36,   -72,
      -121, -124, -23,  36,   42,   42,   -117, -100, 109,  49,   -44,  -39,
      -108, 104,  -48,  101,  81,   120,  -58,  -115, 71,   19,   -102, -77,
      -74,  -18,  13,   44,   -21,  42,   62,   99,   72,   -73,  38,   41,
      96,   72,   -59,  -100, 119,  -90,  -5,   87,   -100, -102, 48,   -1,
      126,  -118, -102, -22,  101,  56,   124,  31,   -85,  60,   -115, 23,
      29,   106,  -31,  36,   62,   -49,  -91,  12,   4,    -122, 74,   -76,
      77,   64,   9,    -127};
  const int8_t i8_src2_m2[] = {
      -54,  45,   -107, -20, 11,   53,   33,   21,   -9,   -2,   -8,   -90,
      -56,  121,  -75,  35,  100,  -112, -103, -57,  -48,  -44,  -80,  87,
      -75,  -107, -102, 0,   -44,  -51,  80,   -33,  -106, 107,  85,   -111,
      40,   -49,  -97,  117, 99,   -35,  -86,  -90,  45,   91,   -73,  -97,
      68,   41,   -53,  -34, 45,   -41,  -120, -90,  124,  -41,  -100, 121,
      21,   21,   -30,  73,  -26,  -17,  26,   -7,   -71,  -46,  42,   -94,
      -119, -65,  -91,  47,  100,  97,   -12,  5,    -54,  45,   -107, -20,
      11,   53,   33,   21,  -9,   -2,   -8,   -90,  -56,  121,  -75,  35,
      100,  -112, -103, -57, -48,  -44,  -80,  87,   -75,  -107, -102, 0,
      -44,  -51,  80,   -33, -106, 107,  85,   -111, 40,   -49,  -97,  117,
      99,   -35,  -86,  -90, 45,   91,   -73,  -97,  68,   41,   -53,  -34,
      45,   -41,  -120, -90, 124,  -41,  -100, 121,  21,   21,   -30,  73,
      -26,  -17,  26,   -7,  -71,  -46,  42,   -94,  -119, -65,  -91,  47,
      100,  97,   -12,  5};
  const int8_t i8_ans_m2[] = {
      0b10010110, 0b00000010, 0b11110100, 0b10100000, 0b11001101, 0b01010100,
      0b00001001, 0b11110100, 0b10000110, 0b10101100, 0b10101000, 0b00101000,
      0b00101000, 0b00101001, 0b11100100, 0b10101011, 0b11010000, 0b10000000,
      0b01010000, 0b10000011, 0b11010000, 0b01100000, 0b00100000, 0b11101011,
      0b00110011, 0b00001111, 0b10100100, 0b00000000, 0b10111000, 0b10010110,
      0b00010000, 0b01010100, 0b10110010, 0b10001110, 0b10010110, 0b00010011,
      0b01000000, 0b11111001, 0b10011010, 0b10111101, 0b00100000, 0b00101000,
      0b11010010, 0b00101000, 0b11101011, 0b00000010, 0b01101101, 0b00001001,
      0b01110000, 0b10101010, 0b00010000, 0b00100010, 0b00100110, 0b11100110,
      0b11010000, 0b10111100, 0b11101100, 0b00001000, 0b10010000, 0b10100111,
      0b00000111, 0b11101100, 0b01111010, 0b10001111, 0b00001110, 0b11110110,
      0b11011010, 0b00000100, 0b11001110, 0b11001110, 0b00010010, 0b10011000,
      0b00100100, 0b11111010, 0b10110010, 0b00001100, 0b00010100, 0b01000000,
      0b10010100, 0b10000101, 0b10010110, 0b00000010, 0b11110100, 0b10100000,
      0b11001101, 0b01010100, 0b00001001, 0b11110100, 0b10000110, 0b10101100,
      0b10101000, 0b00101000, 0b00101000, 0b00101001, 0b11100100, 0b10101011,
      0b11010000, 0b10000000, 0b01010000, 0b10000011, 0b11010000, 0b01100000,
      0b00100000, 0b11101011, 0b00110011, 0b00001111, 0b10100100, 0b00000000,
      0b10111000, 0b10010110, 0b00010000, 0b01010100, 0b10110010, 0b10001110,
      0b10010110, 0b00010011, 0b01000000, 0b11111001, 0b10011010, 0b10111101,
      0b00100000, 0b00101000, 0b11010010, 0b00101000, 0b11101011, 0b00000010,
      0b01101101, 0b00001001, 0b01110000, 0b10101010, 0b00010000, 0b00100010,
      0b00100110, 0b11100110, 0b11010000, 0b10111100, 0b11101100, 0b00001000,
      0b10010000, 0b10100111, 0b00000111, 0b11101100, 0b01111010, 0b10001111,
      0b00001110, 0b11110110, 0b11011010, 0b00000100, 0b11001110, 0b11001110,
      0b00010010, 0b10011000, 0b00100100, 0b11111010, 0b10110010, 0b00001100,
      0b00010100, 0b01000000, 0b10010100, 0b10000101};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_ts2_m2 = mlce8_m2(i8_src2_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_out_m2 = mmul_mm(i8_ts1_m2, i8_ts2_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 5 * 32, "MMUL.MM INT8  M2");
  // int16
  msettype(E16, M2, BA);
  msettilemi(4);
  msettileni(16);
  const int16_t i16_src1_m2[] = {
      -5902,  475,    20032,  457,   3932,   -29934, 11950,  2585,
      -12594, -28837, 22098,  -7916, -17630, 9787,   -26824, -10431,
      22422,  28301,  -16926, -3301, 27054,  -2693,  3171,   2125,
      31609,  -13366, 21463,  19079, 2190,   -1,     -12370, -15122,
      -5902,  475,    20032,  457,   3932,   -29934, 11950,  2585,
      -12594, -28837, 22098,  -7916, -17630, 9787,   -26824, -10431,
      22422,  28301,  -16926, -3301, 27054,  -2693,  3171,   2125,
      31609,  -13366, 21463,  19079, 2190,   -1,     -12370, -15122};
  const int16_t i16_src2_m2[] = {
      1618,   32016,  12839, -14307, -23068, 5225,   -10898, 19280,
      19174,  11471,  29950, -19985, -10665, -11767, 28750,  14579,
      -23237, 32112,  29760, -14764, -27210, -30176, 8173,   30292,
      30446,  -26749, 29335, -14402, -818,   -9817,  20889,  -14192,
      1618,   32016,  12839, -14307, -23068, 5225,   -10898, 19280,
      19174,  11471,  29950, -19985, -10665, -11767, 28750,  14579,
      -23237, 32112,  29760, -14764, -27210, -30176, 8173,   30292,
      30446,  -26749, 29335, -14402, -818,   -9817,  20889,  -14192};
  const int16_t i16_ans_m2[] = {
      0b0100100110000100, 0b0000110010110000, 0b0110101111000000,
      0b0011101111000101, 0b1111100111110000, 0b0111001001100010,
      0b1101010011000100, 0b0111101011010000, 0b0101100100010100,
      0b1000111010010101, 0b1100110101011100, 0b1111010110101100,
      0b0000010010001110, 0b1011111000010011, 0b1001001100010000,
      0b1000101010110011, 0b1101110110010010, 0b0011011010110000,
      0b1110000010000000, 0b1010011011011100, 0b0110011110110100,
      0b1111110101100000, 0b0111010010100111, 0b0011011101000100,
      0b1001000001111110, 0b0110111001011110, 0b0011000111010001,
      0b0100000100110010, 0b1010101001000100, 0b0010011001011001,
      0b0010110011111110, 0b1011010111100000, 0b0100100110000100,
      0b0000110010110000, 0b0110101111000000, 0b0011101111000101,
      0b1111100111110000, 0b0111001001100010, 0b1101010011000100,
      0b0111101011010000, 0b0101100100010100, 0b1000111010010101,
      0b1100110101011100, 0b1111010110101100, 0b0000010010001110,
      0b1011111000010011, 0b1001001100010000, 0b1000101010110011,
      0b1101110110010010, 0b0011011010110000, 0b1110000010000000,
      0b1010011011011100, 0b0110011110110100, 0b1111110101100000,
      0b0111010010100111, 0b0011011101000100, 0b1001000001111110,
      0b0110111001011110, 0b0011000111010001, 0b0100000100110010,
      0b1010101001000100, 0b0010011001011001, 0b0010110011111110,
      0b1011010111100000};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_ts2_m2 = mlce16_m2(i16_src2_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_out_m2 = mmul_mm(i16_ts1_m2, i16_ts2_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 4 * 16, "MMUL.MM INT16 M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(5);
  msettileni(8);
  const int32_t i32_src1_m2[] = {
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573,
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573};
  const int32_t i32_src2_m2[] = {
      1510444861, 1001848163,  1325478368, -1732913065, -517488933, -1503842313,
      1204301170, 763102971,   166057080,  657407816,   1500977977, -2095285952,
      -182832949, 31379264,    837633032,  -1720048366, -881848507, -1558943035,
      26524537,   -99008218,   1510444861, 1001848163,  1325478368, -1732913065,
      -517488933, -1503842313, 1204301170, 763102971,   166057080,  657407816,
      1500977977, -2095285952, -182832949, 31379264,    837633032,  -1720048366,
      -881848507, -1558943035, 26524537,   -99008218};
  const int32_t i32_ans_m2[] = {
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010,
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_ts2_m2 = mlce32_m2(i32_src2_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_out_m2 = mmul_mm(i32_ts1_m2, i32_ts2_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 5 * 8, "MMUL.MM INT32 M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(1);
  msettileni(4);
  const int64_t i64_src1_m2[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2_m2[] = {2, 2, 2, 2};
  const int64_t i64_ans_m2[] = {
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110};
  mint64m2_t i64_ts1_m2 = mlce64_m2(i64_src1_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_ts2_m2 = mlce64_m2(i64_src2_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_out_m2 = mmul_mm(i64_ts1_m2, i64_ts2_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int32_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 4, "MMUL.MM INT64 M2");
  // M4
  // int8
  msettype(E8, M4, BA);
  msettilemi(5);
  msettileni(64);
  const int8_t i8_src1_m4[] = {
      111,  74,   36,   -72,  -121, -124, -23,  36,   42,   42,   -117, -100,
      109,  49,   -44,  -39,  -108, 104,  -48,  101,  81,   120,  -58,  -115,
      71,   19,   -102, -77,  -74,  -18,  13,   44,   -21,  42,   62,   99,
      72,   -73,  38,   41,   96,   72,   -59,  -100, 119,  -90,  -5,   87,
      -100, -102, 48,   -1,   126,  -118, -102, -22,  101,  56,   124,  31,
      -85,  60,   -115, 23,   29,   106,  -31,  36,   62,   -49,  -91,  12,
      4,    -122, 74,   -76,  77,   64,   9,    -127, 111,  74,   36,   -72,
      -121, -124, -23,  36,   42,   42,   -117, -100, 109,  49,   -44,  -39,
      -108, 104,  -48,  101,  81,   120,  -58,  -115, 71,   19,   -102, -77,
      -74,  -18,  13,   44,   -21,  42,   62,   99,   72,   -73,  38,   41,
      96,   72,   -59,  -100, 119,  -90,  -5,   87,   -100, -102, 48,   -1,
      126,  -118, -102, -22,  101,  56,   124,  31,   -85,  60,   -115, 23,
      29,   106,  -31,  36,   62,   -49,  -91,  12,   4,    -122, 74,   -76,
      77,   64,   9,    -127, 111,  74,   36,   -72,  -121, -124, -23,  36,
      42,   42,   -117, -100, 109,  49,   -44,  -39,  -108, 104,  -48,  101,
      81,   120,  -58,  -115, 71,   19,   -102, -77,  -74,  -18,  13,   44,
      -21,  42,   62,   99,   72,   -73,  38,   41,   96,   72,   -59,  -100,
      119,  -90,  -5,   87,   -100, -102, 48,   -1,   126,  -118, -102, -22,
      101,  56,   124,  31,   -85,  60,   -115, 23,   29,   106,  -31,  36,
      62,   -49,  -91,  12,   4,    -122, 74,   -76,  77,   64,   9,    -127,
      111,  74,   36,   -72,  -121, -124, -23,  36,   42,   42,   -117, -100,
      109,  49,   -44,  -39,  -108, 104,  -48,  101,  81,   120,  -58,  -115,
      71,   19,   -102, -77,  -74,  -18,  13,   44,   -21,  42,   62,   99,
      72,   -73,  38,   41,   96,   72,   -59,  -100, 119,  -90,  -5,   87,
      -100, -102, 48,   -1,   126,  -118, -102, -22,  101,  56,   124,  31,
      -85,  60,   -115, 23,   29,   106,  -31,  36,   62,   -49,  -91,  12,
      4,    -122, 74,   -76,  77,   64,   9,    -127};
  const int8_t i8_src2_m4[] = {
      -54,  45,   -107, -20,  11,   53,   33,   21,   -9,   -2,   -8,   -90,
      -56,  121,  -75,  35,   100,  -112, -103, -57,  -48,  -44,  -80,  87,
      -75,  -107, -102, 0,    -44,  -51,  80,   -33,  -106, 107,  85,   -111,
      40,   -49,  -97,  117,  99,   -35,  -86,  -90,  45,   91,   -73,  -97,
      68,   41,   -53,  -34,  45,   -41,  -120, -90,  124,  -41,  -100, 121,
      21,   21,   -30,  73,   -26,  -17,  26,   -7,   -71,  -46,  42,   -94,
      -119, -65,  -91,  47,   100,  97,   -12,  5,    -54,  45,   -107, -20,
      11,   53,   33,   21,   -9,   -2,   -8,   -90,  -56,  121,  -75,  35,
      100,  -112, -103, -57,  -48,  -44,  -80,  87,   -75,  -107, -102, 0,
      -44,  -51,  80,   -33,  -106, 107,  85,   -111, 40,   -49,  -97,  117,
      99,   -35,  -86,  -90,  45,   91,   -73,  -97,  68,   41,   -53,  -34,
      45,   -41,  -120, -90,  124,  -41,  -100, 121,  21,   21,   -30,  73,
      -26,  -17,  26,   -7,   -71,  -46,  42,   -94,  -119, -65,  -91,  47,
      100,  97,   -12,  5,    -54,  45,   -107, -20,  11,   53,   33,   21,
      -9,   -2,   -8,   -90,  -56,  121,  -75,  35,   100,  -112, -103, -57,
      -48,  -44,  -80,  87,   -75,  -107, -102, 0,    -44,  -51,  80,   -33,
      -106, 107,  85,   -111, 40,   -49,  -97,  117,  99,   -35,  -86,  -90,
      45,   91,   -73,  -97,  68,   41,   -53,  -34,  45,   -41,  -120, -90,
      124,  -41,  -100, 121,  21,   21,   -30,  73,   -26,  -17,  26,   -7,
      -71,  -46,  42,   -94,  -119, -65,  -91,  47,   100,  97,   -12,  5,
      -54,  45,   -107, -20,  11,   53,   33,   21,   -9,   -2,   -8,   -90,
      -56,  121,  -75,  35,   100,  -112, -103, -57,  -48,  -44,  -80,  87,
      -75,  -107, -102, 0,    -44,  -51,  80,   -33,  -106, 107,  85,   -111,
      40,   -49,  -97,  117,  99,   -35,  -86,  -90,  45,   91,   -73,  -97,
      68,   41,   -53,  -34,  45,   -41,  -120, -90,  124,  -41,  -100, 121,
      21,   21,   -30,  73,   -26,  -17,  26,   -7,   -71,  -46,  42,   -94,
      -119, -65,  -91,  47,   100,  97,   -12,  5};
  const int8_t i8_ans_m4[] = {
      0b10010110, 0b00000010, 0b11110100, 0b10100000, 0b11001101, 0b01010100,
      0b00001001, 0b11110100, 0b10000110, 0b10101100, 0b10101000, 0b00101000,
      0b00101000, 0b00101001, 0b11100100, 0b10101011, 0b11010000, 0b10000000,
      0b01010000, 0b10000011, 0b11010000, 0b01100000, 0b00100000, 0b11101011,
      0b00110011, 0b00001111, 0b10100100, 0b00000000, 0b10111000, 0b10010110,
      0b00010000, 0b01010100, 0b10110010, 0b10001110, 0b10010110, 0b00010011,
      0b01000000, 0b11111001, 0b10011010, 0b10111101, 0b00100000, 0b00101000,
      0b11010010, 0b00101000, 0b11101011, 0b00000010, 0b01101101, 0b00001001,
      0b01110000, 0b10101010, 0b00010000, 0b00100010, 0b00100110, 0b11100110,
      0b11010000, 0b10111100, 0b11101100, 0b00001000, 0b10010000, 0b10100111,
      0b00000111, 0b11101100, 0b01111010, 0b10001111, 0b00001110, 0b11110110,
      0b11011010, 0b00000100, 0b11001110, 0b11001110, 0b00010010, 0b10011000,
      0b00100100, 0b11111010, 0b10110010, 0b00001100, 0b00010100, 0b01000000,
      0b10010100, 0b10000101, 0b10010110, 0b00000010, 0b11110100, 0b10100000,
      0b11001101, 0b01010100, 0b00001001, 0b11110100, 0b10000110, 0b10101100,
      0b10101000, 0b00101000, 0b00101000, 0b00101001, 0b11100100, 0b10101011,
      0b11010000, 0b10000000, 0b01010000, 0b10000011, 0b11010000, 0b01100000,
      0b00100000, 0b11101011, 0b00110011, 0b00001111, 0b10100100, 0b00000000,
      0b10111000, 0b10010110, 0b00010000, 0b01010100, 0b10110010, 0b10001110,
      0b10010110, 0b00010011, 0b01000000, 0b11111001, 0b10011010, 0b10111101,
      0b00100000, 0b00101000, 0b11010010, 0b00101000, 0b11101011, 0b00000010,
      0b01101101, 0b00001001, 0b01110000, 0b10101010, 0b00010000, 0b00100010,
      0b00100110, 0b11100110, 0b11010000, 0b10111100, 0b11101100, 0b00001000,
      0b10010000, 0b10100111, 0b00000111, 0b11101100, 0b01111010, 0b10001111,
      0b00001110, 0b11110110, 0b11011010, 0b00000100, 0b11001110, 0b11001110,
      0b00010010, 0b10011000, 0b00100100, 0b11111010, 0b10110010, 0b00001100,
      0b00010100, 0b01000000, 0b10010100, 0b10000101, 0b10010110, 0b00000010,
      0b11110100, 0b10100000, 0b11001101, 0b01010100, 0b00001001, 0b11110100,
      0b10000110, 0b10101100, 0b10101000, 0b00101000, 0b00101000, 0b00101001,
      0b11100100, 0b10101011, 0b11010000, 0b10000000, 0b01010000, 0b10000011,
      0b11010000, 0b01100000, 0b00100000, 0b11101011, 0b00110011, 0b00001111,
      0b10100100, 0b00000000, 0b10111000, 0b10010110, 0b00010000, 0b01010100,
      0b10110010, 0b10001110, 0b10010110, 0b00010011, 0b01000000, 0b11111001,
      0b10011010, 0b10111101, 0b00100000, 0b00101000, 0b11010010, 0b00101000,
      0b11101011, 0b00000010, 0b01101101, 0b00001001, 0b01110000, 0b10101010,
      0b00010000, 0b00100010, 0b00100110, 0b11100110, 0b11010000, 0b10111100,
      0b11101100, 0b00001000, 0b10010000, 0b10100111, 0b00000111, 0b11101100,
      0b01111010, 0b10001111, 0b00001110, 0b11110110, 0b11011010, 0b00000100,
      0b11001110, 0b11001110, 0b00010010, 0b10011000, 0b00100100, 0b11111010,
      0b10110010, 0b00001100, 0b00010100, 0b01000000, 0b10010100, 0b10000101,
      0b10010110, 0b00000010, 0b11110100, 0b10100000, 0b11001101, 0b01010100,
      0b00001001, 0b11110100, 0b10000110, 0b10101100, 0b10101000, 0b00101000,
      0b00101000, 0b00101001, 0b11100100, 0b10101011, 0b11010000, 0b10000000,
      0b01010000, 0b10000011, 0b11010000, 0b01100000, 0b00100000, 0b11101011,
      0b00110011, 0b00001111, 0b10100100, 0b00000000, 0b10111000, 0b10010110,
      0b00010000, 0b01010100, 0b10110010, 0b10001110, 0b10010110, 0b00010011,
      0b01000000, 0b11111001, 0b10011010, 0b10111101, 0b00100000, 0b00101000,
      0b11010010, 0b00101000, 0b11101011, 0b00000010, 0b01101101, 0b00001001,
      0b01110000, 0b10101010, 0b00010000, 0b00100010, 0b00100110, 0b11100110,
      0b11010000, 0b10111100, 0b11101100, 0b00001000, 0b10010000, 0b10100111,
      0b00000111, 0b11101100, 0b01111010, 0b10001111, 0b00001110, 0b11110110,
      0b11011010, 0b00000100, 0b11001110, 0b11001110, 0b00010010, 0b10011000,
      0b00100100, 0b11111010, 0b10110010, 0b00001100, 0b00010100, 0b01000000,
      0b10010100, 0b10000101};
  mint8m4_t i8_ts1_m4 = mlce8_m4(i8_src1_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_ts2_m4 = mlce8_m4(i8_src2_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_out_m4 = mmul_mm(i8_ts1_m4, i8_ts2_m4);
  msce8_m(i8_out_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m4, i8_buffer, 5 * 64, "MMUL.MM INT8  M4");
  // int16
  msettype(E16, M4, BA);
  msettilemi(4);
  msettileni(32);
  const int16_t i16_src1_m4[] = {
      -5902,  475,    20032,  457,    3932,   -29934, 11950,  2585,   -12594,
      -28837, 22098,  -7916,  -17630, 9787,   -26824, -10431, 22422,  28301,
      -16926, -3301,  27054,  -2693,  3171,   2125,   31609,  -13366, 21463,
      19079,  2190,   -1,     -12370, -15122, -5902,  475,    20032,  457,
      3932,   -29934, 11950,  2585,   -12594, -28837, 22098,  -7916,  -17630,
      9787,   -26824, -10431, 22422,  28301,  -16926, -3301,  27054,  -2693,
      3171,   2125,   31609,  -13366, 21463,  19079,  2190,   -1,     -12370,
      -15122, -5902,  475,    20032,  457,    3932,   -29934, 11950,  2585,
      -12594, -28837, 22098,  -7916,  -17630, 9787,   -26824, -10431, 22422,
      28301,  -16926, -3301,  27054,  -2693,  3171,   2125,   31609,  -13366,
      21463,  19079,  2190,   -1,     -12370, -15122, -5902,  475,    20032,
      457,    3932,   -29934, 11950,  2585,   -12594, -28837, 22098,  -7916,
      -17630, 9787,   -26824, -10431, 22422,  28301,  -16926, -3301,  27054,
      -2693,  3171,   2125,   31609,  -13366, 21463,  19079,  2190,   -1,
      -12370, -15122};
  const int16_t i16_src2_m4[] = {
      1618,   32016,  12839,  -14307, -23068, 5225,   -10898, 19280,  19174,
      11471,  29950,  -19985, -10665, -11767, 28750,  14579,  -23237, 32112,
      29760,  -14764, -27210, -30176, 8173,   30292,  30446,  -26749, 29335,
      -14402, -818,   -9817,  20889,  -14192, 1618,   32016,  12839,  -14307,
      -23068, 5225,   -10898, 19280,  19174,  11471,  29950,  -19985, -10665,
      -11767, 28750,  14579,  -23237, 32112,  29760,  -14764, -27210, -30176,
      8173,   30292,  30446,  -26749, 29335,  -14402, -818,   -9817,  20889,
      -14192, 1618,   32016,  12839,  -14307, -23068, 5225,   -10898, 19280,
      19174,  11471,  29950,  -19985, -10665, -11767, 28750,  14579,  -23237,
      32112,  29760,  -14764, -27210, -30176, 8173,   30292,  30446,  -26749,
      29335,  -14402, -818,   -9817,  20889,  -14192, 1618,   32016,  12839,
      -14307, -23068, 5225,   -10898, 19280,  19174,  11471,  29950,  -19985,
      -10665, -11767, 28750,  14579,  -23237, 32112,  29760,  -14764, -27210,
      -30176, 8173,   30292,  30446,  -26749, 29335,  -14402, -818,   -9817,
      20889,  -14192};
  const int16_t i16_ans_m4[] = {
      0b0100100110000100, 0b0000110010110000, 0b0110101111000000,
      0b0011101111000101, 0b1111100111110000, 0b0111001001100010,
      0b1101010011000100, 0b0111101011010000, 0b0101100100010100,
      0b1000111010010101, 0b1100110101011100, 0b1111010110101100,
      0b0000010010001110, 0b1011111000010011, 0b1001001100010000,
      0b1000101010110011, 0b1101110110010010, 0b0011011010110000,
      0b1110000010000000, 0b1010011011011100, 0b0110011110110100,
      0b1111110101100000, 0b0111010010100111, 0b0011011101000100,
      0b1001000001111110, 0b0110111001011110, 0b0011000111010001,
      0b0100000100110010, 0b1010101001000100, 0b0010011001011001,
      0b0010110011111110, 0b1011010111100000, 0b0100100110000100,
      0b0000110010110000, 0b0110101111000000, 0b0011101111000101,
      0b1111100111110000, 0b0111001001100010, 0b1101010011000100,
      0b0111101011010000, 0b0101100100010100, 0b1000111010010101,
      0b1100110101011100, 0b1111010110101100, 0b0000010010001110,
      0b1011111000010011, 0b1001001100010000, 0b1000101010110011,
      0b1101110110010010, 0b0011011010110000, 0b1110000010000000,
      0b1010011011011100, 0b0110011110110100, 0b1111110101100000,
      0b0111010010100111, 0b0011011101000100, 0b1001000001111110,
      0b0110111001011110, 0b0011000111010001, 0b0100000100110010,
      0b1010101001000100, 0b0010011001011001, 0b0010110011111110,
      0b1011010111100000, 0b0100100110000100, 0b0000110010110000,
      0b0110101111000000, 0b0011101111000101, 0b1111100111110000,
      0b0111001001100010, 0b1101010011000100, 0b0111101011010000,
      0b0101100100010100, 0b1000111010010101, 0b1100110101011100,
      0b1111010110101100, 0b0000010010001110, 0b1011111000010011,
      0b1001001100010000, 0b1000101010110011, 0b1101110110010010,
      0b0011011010110000, 0b1110000010000000, 0b1010011011011100,
      0b0110011110110100, 0b1111110101100000, 0b0111010010100111,
      0b0011011101000100, 0b1001000001111110, 0b0110111001011110,
      0b0011000111010001, 0b0100000100110010, 0b1010101001000100,
      0b0010011001011001, 0b0010110011111110, 0b1011010111100000,
      0b0100100110000100, 0b0000110010110000, 0b0110101111000000,
      0b0011101111000101, 0b1111100111110000, 0b0111001001100010,
      0b1101010011000100, 0b0111101011010000, 0b0101100100010100,
      0b1000111010010101, 0b1100110101011100, 0b1111010110101100,
      0b0000010010001110, 0b1011111000010011, 0b1001001100010000,
      0b1000101010110011, 0b1101110110010010, 0b0011011010110000,
      0b1110000010000000, 0b1010011011011100, 0b0110011110110100,
      0b1111110101100000, 0b0111010010100111, 0b0011011101000100,
      0b1001000001111110, 0b0110111001011110, 0b0011000111010001,
      0b0100000100110010, 0b1010101001000100, 0b0010011001011001,
      0b0010110011111110, 0b1011010111100000};
  mint16m4_t i16_ts1_m4 = mlce16_m4(i16_src1_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_ts2_m4 = mlce16_m4(i16_src2_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_out_m4 = mmul_mm(i16_ts1_m4, i16_ts2_m4);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 4 * 32, "MMUL.MM INT16 M4");
  // int32
  msettype(E32, M4, BA);
  msettilemi(5);
  msettileni(16);
  const int32_t i32_src1_m4[] = {
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573,
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573,
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573,
      1233436256,  1274488063, -1780058273, 1135628978, -950815679,
      1671959166,  1666808812, 776934449,   1234692602, -1526993931,
      -1399929402, 760500162,  -1387010718, 189025654,  730688401,
      692056148,   2145584747, -1212261150, 619640527,  -1699508573};
  const int32_t i32_src2_m4[] = {
      1510444861, 1001848163,  1325478368, -1732913065, -517488933, -1503842313,
      1204301170, 763102971,   166057080,  657407816,   1500977977, -2095285952,
      -182832949, 31379264,    837633032,  -1720048366, -881848507, -1558943035,
      26524537,   -99008218,   1510444861, 1001848163,  1325478368, -1732913065,
      -517488933, -1503842313, 1204301170, 763102971,   166057080,  657407816,
      1500977977, -2095285952, -182832949, 31379264,    837633032,  -1720048366,
      -881848507, -1558943035, 26524537,   -99008218,   1510444861, 1001848163,
      1325478368, -1732913065, -517488933, -1503842313, 1204301170, 763102971,
      166057080,  657407816,   1500977977, -2095285952, -182832949, 31379264,
      837633032,  -1720048366, -881848507, -1558943035, 26524537,   -99008218,
      1510444861, 1001848163,  1325478368, -1732913065, -517488933, -1503842313,
      1204301170, 763102971,   166057080,  657407816,   1500977977, -2095285952,
      -182832949, 31379264,    837633032,  -1720048366, -881848507, -1558943035,
      26524537,   -99008218};
  const int32_t i32_ans_m4[] = {
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010,
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010,
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010,
      0b10011111100110001111110011100000, 0b10110010011011010101000110011101,
      0b00001110111000001010001000100000, 0b11101110100011000100101001111110,
      0b00111011010010100111000110011011, 0b01101110010101001111100110010010,
      0b00111101000000011010101100011000, 0b10100110101111011111001000001011,
      0b01100011100110101011010100110000, 0b00001010111001101010011111101000,
      0b00111111101011111110101100010110, 0b00101101111111101010001010000000,
      0b01000010011111010100010010110110, 0b10101110000010011100011110000000,
      0b01000011001110101110000010001000, 0b11100000010000110000100111101000,
      0b01101101011000001111111111010111, 0b01011111100110110000110111101010,
      0b10000001111001111101110011010111, 0b10101001110010011000111100110010};
  mint32m4_t i32_ts1_m4 = mlce32_m4(i32_src1_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_ts2_m4 = mlce32_m4(i32_src2_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_out_m4 = mmul_mm(i32_ts1_m4, i32_ts2_m4);
  msce32_m(i32_out_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 5 * 16, "MMUL.MM INT32 M4");
  // int64
  msettype(E64, M4, BA);
  msettilemi(1);
  msettileni(8);
  const int64_t i64_src1_m4[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2_m4[] = {2, 2, 2, 2, 2, 2, 2, 2};
  const int64_t i64_ans_m4[] = {
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110,
      0b1111111111111111111111111111111111111111111111111111111111111110};
  mint64m4_t i64_ts1_m4 = mlce64_m4(i64_src1_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_ts2_m4 = mlce64_m4(i64_src2_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_out_m4 = mmul_mm(i64_ts1_m4, i64_ts2_m4);
  msce64_m(i64_out_m4, i64_buffer, 8 * sizeof(int32_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 8, "MMUL.MM INT64 M4");
}

static void test_mmulh_mm() {
  // M1
  // int8
  msettype(E8, M1, BA);
  msettilemi(5);
  msettileni(16);
  const int8_t i8_src1[] = {
      78,  52,  70,  7,   -58, 55,  44,  13, 34,  69,  84,  -96, 54,  98,
      -71, 35,  -93, 12,  -22, -67, 60,  99, 38,  46,  62,  61,  -53, -99,
      66,  -69, 7,   -79, 83,  67,  28,  37, -1,  -84, 62,  -96, -19, -83,
      4,   -99, 32,  63,  57,  -58, 30,  21, -72, -23, -67, 90,  63,  -1,
      -56, 28,  3,   10,  -72, -14, 67,  54, -22, 1,   -16, -6,  55,  -39,
      8,   -21, 7,   -74, -16, 32,  -82, 1,  -27, 24};
  const int8_t i8_src2[] = {
      -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,  -29, -60, 0,   34,
      11,  -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66, -88, -11, -50,
      -72, 69,  -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,  -34, 84,
      1,   94,  -29, -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,  8,
      -48, -92, -35, 14,  -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,
      2,   -48, -93, 96,  10,  54,  65,  -2,  -75, 82};
  const int8_t i8_ans[] = {
      0b11100011, 0b11110111, 0b11101100, 0b11111111, 0b00000000, 0b11101110,
      0b00000101, 0b11111110, 0b00000101, 0b00001000, 0b11110110, 0b00010110,
      0b00000000, 0b00001101, 0b11111100, 0b11111110, 0b00010010, 0b11111101,
      0b00000010, 0b00000100, 0b00010001, 0b11100000, 0b11110100, 0b11111110,
      0b11110000, 0b11101011, 0b00000010, 0b00010011, 0b11101101, 0b11101101,
      0b11111110, 0b00010111, 0b11100011, 0b11110001, 0b00000110, 0b00000110,
      0b00000000, 0b00010001, 0b00010111, 0b11100000, 0b00000010, 0b11100100,
      0b00000000, 0b11011011, 0b11111100, 0b11110001, 0b11111111, 0b00010101,
      0b11111001, 0b11111011, 0b00001010, 0b00000010, 0b00000110, 0b11101011,
      0b00000010, 0b11111111, 0b00001010, 0b11110101, 0b11111111, 0b00000000,
      0b00011011, 0b11111100, 0b00011000, 0b11101111, 0b00000000, 0b11111111,
      0b00000000, 0b11111111, 0b00010000, 0b11110100, 0b00000000, 0b00000011,
      0b11111101, 0b11100100, 0b11111111, 0b00000110, 0b11101011, 0b11111111,
      0b00000111, 0b00000111};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 16 * sizeof(int8_t));
  mint8m1_t i8_ts2 = mlce8_m1(i8_src2, 16 * sizeof(int8_t));
  mint8m1_t i8_out = mmulh_mm(i8_ts1, i8_ts2);
  msce8_m(i8_out, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 80, "MMULH.MM INT8  M1");
  // int16
  msettype(E16, M1, BA);
  msettilemi(4);
  msettileni(8);
  const int16_t i16_src1[] = {
      11250,  22150,  2251,  12909,  -30246, 32388,  1526,   -29028,
      9864,   -24657, 21612, -10020, 8121,   -24224, 6392,   -1325,
      -12874, -27400, 25592, -20141, 13907,  3045,   -14471, -12370,
      9058,   -15692, 20696, 6998,   -3212,  17796,  31326,  26919};
  const int16_t i16_src2[] = {
      15471,  22523,  11719, -29632, 2956,  -8034,  -1065, 4555,
      -2719,  21642,  5013,  23090,  1294,  -10139, 4386,  2174,
      18127,  9145,   22257, 2459,   17300, 1459,   -1963, -17806,
      -11131, -27921, -8440, 11457,  17303, 21852,  29579, -29601};
  const int16_t i16_ans[] = {
      0b0000101001011111, 0b0001110110111100, 0b0000000110010010,
      0b1110100100110011, 0b1111101010101011, 0b1111000001111101,
      0b1111111111100111, 0b1111100000011110, 0b1111111001100110,
      0b1110000000110001, 0b0000011001110101, 0b1111001000110101,
      0b0000000010100000, 0b0000111010100011, 0b0000000110101011,
      0b1111111111010100, 0b1111001000010111, 0b1111000100010000,
      0b0010000111110011, 0b1111110100001100, 0b0000111001010111,
      0b0000000001000011, 0b0000000110110001, 0b0000110100100000,
      0b1111100111111101, 0b0001101000011101, 0b1111010110010110,
      0b0000010011000111, 0b1111110010101111, 0b0001011100101101,
      0b0011011100111010, 0b1101000010000001};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 8 * sizeof(int16_t));
  mint16m1_t i16_ts2 = mlce16_m1(i16_src2, 8 * sizeof(int16_t));
  mint16m1_t i16_out = mmulh_mm(i16_ts1, i16_ts2);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 32, "MMULH.MM INT16 M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(5);
  msettileni(4);
  const int32_t i32_src1[] = {-1864187291, 44583579,    143522824,  -541181720,
                              -511255337,  1992571033,  2019553228, 414468700,
                              1143057586,  -1900987662, 2041881726, -517526418,
                              -1110304650, -648262133,  2004722094, -1852474879,
                              2090151511,  2012822785,  279661019,  1562895275};
  const int32_t i32_src2[] = {1644675682,  415568863,   -695797429, 1188293154,
                              -37381,      -1066542573, -563026474, 1741107815,
                              1464853175,  -991207022,  -739078845, -440318919,
                              -2011471844, 312303164,   6822316,    1711153974,
                              1165513769,  -482726958,  1678327018, -101761353};
  const int32_t i32_ans[] = {
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 4 * sizeof(int32_t));
  mint32m1_t i32_ts2 = mlce32_m1(i32_src2, 4 * sizeof(int32_t));
  mint32m1_t i32_out = mmulh_mm(i32_ts1, i32_ts2);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 20, "MMULH.MM INT32 M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(1);
  msettileni(1);
  const int64_t i64_src1[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2[] = {4};
  const int64_t i64_ans[] = {
      0b0000000000000000000000000000000000000000000000000000000000000001};
  mint64m1_t i64_ts1 = mlce64_m1(i64_src1, 1 * sizeof(int64_t));
  mint64m1_t i64_ts2 = mlce64_m1(i64_src2, 1 * sizeof(int64_t));
  mint64m1_t i64_out = mmulh_mm(i64_ts1, i64_ts2);
  msce64_m(i64_out, i64_buffer, 1 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 1, "MMULH.MM INT64 M1");
  // M2
  // int8
  msettype(E8, M2, BA);
  msettilemi(5);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      78,  52,  70,  7,   -58, 55,  44,  13,  34,  69,  84,  -96, 54,  98,  -71,
      35,  -93, 12,  -22, -67, 60,  99,  38,  46,  62,  61,  -53, -99, 66,  -69,
      7,   -79, 83,  67,  28,  37,  -1,  -84, 62,  -96, -19, -83, 4,   -99, 32,
      63,  57,  -58, 30,  21,  -72, -23, -67, 90,  63,  -1,  -56, 28,  3,   10,
      -72, -14, 67,  54,  -22, 1,   -16, -6,  55,  -39, 8,   -21, 7,   -74, -16,
      32,  -82, 1,   -27, 24,  78,  52,  70,  7,   -58, 55,  44,  13,  34,  69,
      84,  -96, 54,  98,  -71, 35,  -93, 12,  -22, -67, 60,  99,  38,  46,  62,
      61,  -53, -99, 66,  -69, 7,   -79, 83,  67,  28,  37,  -1,  -84, 62,  -96,
      -19, -83, 4,   -99, 32,  63,  57,  -58, 30,  21,  -72, -23, -67, 90,  63,
      -1,  -56, 28,  3,   10,  -72, -14, 67,  54,  -22, 1,   -16, -6,  55,  -39,
      8,   -21, 7,   -74, -16, 32,  -82, 1,   -27, 24};
  const int8_t i8_src2_m2[] = {
      -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,  -29, -60, 0,   34,  11,
      -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66, -88, -11, -50, -72, 69,
      -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,  -34, 84,  1,   94,  -29,
      -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,  8,   -48, -92, -35, 14,
      -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,  2,   -48, -93, 96,  10,
      54,  65,  -2,  -75, 82,  -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,
      -29, -60, 0,   34,  11,  -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66,
      -88, -11, -50, -72, 69,  -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,
      -34, 84,  1,   94,  -29, -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,
      8,   -48, -92, -35, 14,  -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,
      2,   -48, -93, 96,  10,  54,  65,  -2,  -75, 82};
  const int8_t i8_ans_m2[] = {
      0b11100011, 0b11110111, 0b11101100, 0b11111111, 0b00000000, 0b11101110,
      0b00000101, 0b11111110, 0b00000101, 0b00001000, 0b11110110, 0b00010110,
      0b00000000, 0b00001101, 0b11111100, 0b11111110, 0b00010010, 0b11111101,
      0b00000010, 0b00000100, 0b00010001, 0b11100000, 0b11110100, 0b11111110,
      0b11110000, 0b11101011, 0b00000010, 0b00010011, 0b11101101, 0b11101101,
      0b11111110, 0b00010111, 0b11100011, 0b11110001, 0b00000110, 0b00000110,
      0b00000000, 0b00010001, 0b00010111, 0b11100000, 0b00000010, 0b11100100,
      0b00000000, 0b11011011, 0b11111100, 0b11110001, 0b11111111, 0b00010101,
      0b11111001, 0b11111011, 0b00001010, 0b00000010, 0b00000110, 0b11101011,
      0b00000010, 0b11111111, 0b00001010, 0b11110101, 0b11111111, 0b00000000,
      0b00011011, 0b11111100, 0b00011000, 0b11101111, 0b00000000, 0b11111111,
      0b00000000, 0b11111111, 0b00010000, 0b11110100, 0b00000000, 0b00000011,
      0b11111101, 0b11100100, 0b11111111, 0b00000110, 0b11101011, 0b11111111,
      0b00000111, 0b00000111, 0b11100011, 0b11110111, 0b11101100, 0b11111111,
      0b00000000, 0b11101110, 0b00000101, 0b11111110, 0b00000101, 0b00001000,
      0b11110110, 0b00010110, 0b00000000, 0b00001101, 0b11111100, 0b11111110,
      0b00010010, 0b11111101, 0b00000010, 0b00000100, 0b00010001, 0b11100000,
      0b11110100, 0b11111110, 0b11110000, 0b11101011, 0b00000010, 0b00010011,
      0b11101101, 0b11101101, 0b11111110, 0b00010111, 0b11100011, 0b11110001,
      0b00000110, 0b00000110, 0b00000000, 0b00010001, 0b00010111, 0b11100000,
      0b00000010, 0b11100100, 0b00000000, 0b11011011, 0b11111100, 0b11110001,
      0b11111111, 0b00010101, 0b11111001, 0b11111011, 0b00001010, 0b00000010,
      0b00000110, 0b11101011, 0b00000010, 0b11111111, 0b00001010, 0b11110101,
      0b11111111, 0b00000000, 0b00011011, 0b11111100, 0b00011000, 0b11101111,
      0b00000000, 0b11111111, 0b00000000, 0b11111111, 0b00010000, 0b11110100,
      0b00000000, 0b00000011, 0b11111101, 0b11100100, 0b11111111, 0b00000110,
      0b11101011, 0b11111111, 0b00000111, 0b00000111};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_ts2_m2 = mlce8_m2(i8_src2_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_out_m2 = mmulh_mm(i8_ts1_m2, i8_ts2_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 5 * 32, "MMULH.MM INT8  M2");
  // int16
  msettype(E16, M2, BA);
  msettilemi(4);
  msettileni(16);
  const int16_t i16_src1_m2[] = {
      11250,  22150,  2251,  12909,  -30246, 32388,  1526,   -29028,
      9864,   -24657, 21612, -10020, 8121,   -24224, 6392,   -1325,
      -12874, -27400, 25592, -20141, 13907,  3045,   -14471, -12370,
      9058,   -15692, 20696, 6998,   -3212,  17796,  31326,  26919,
      11250,  22150,  2251,  12909,  -30246, 32388,  1526,   -29028,
      9864,   -24657, 21612, -10020, 8121,   -24224, 6392,   -1325,
      -12874, -27400, 25592, -20141, 13907,  3045,   -14471, -12370,
      9058,   -15692, 20696, 6998,   -3212,  17796,  31326,  26919};
  const int16_t i16_src2_m2[] = {
      15471,  22523,  11719, -29632, 2956,  -8034,  -1065, 4555,
      -2719,  21642,  5013,  23090,  1294,  -10139, 4386,  2174,
      18127,  9145,   22257, 2459,   17300, 1459,   -1963, -17806,
      -11131, -27921, -8440, 11457,  17303, 21852,  29579, -29601,
      15471,  22523,  11719, -29632, 2956,  -8034,  -1065, 4555,
      -2719,  21642,  5013,  23090,  1294,  -10139, 4386,  2174,
      18127,  9145,   22257, 2459,   17300, 1459,   -1963, -17806,
      -11131, -27921, -8440, 11457,  17303, 21852,  29579, -29601};
  const int16_t i16_ans_m2[] = {
      0b0000101001011111, 0b0001110110111100, 0b0000000110010010,
      0b1110100100110011, 0b1111101010101011, 0b1111000001111101,
      0b1111111111100111, 0b1111100000011110, 0b1111111001100110,
      0b1110000000110001, 0b0000011001110101, 0b1111001000110101,
      0b0000000010100000, 0b0000111010100011, 0b0000000110101011,
      0b1111111111010100, 0b1111001000010111, 0b1111000100010000,
      0b0010000111110011, 0b1111110100001100, 0b0000111001010111,
      0b0000000001000011, 0b0000000110110001, 0b0000110100100000,
      0b1111100111111101, 0b0001101000011101, 0b1111010110010110,
      0b0000010011000111, 0b1111110010101111, 0b0001011100101101,
      0b0011011100111010, 0b1101000010000001, 0b0000101001011111,
      0b0001110110111100, 0b0000000110010010, 0b1110100100110011,
      0b1111101010101011, 0b1111000001111101, 0b1111111111100111,
      0b1111100000011110, 0b1111111001100110, 0b1110000000110001,
      0b0000011001110101, 0b1111001000110101, 0b0000000010100000,
      0b0000111010100011, 0b0000000110101011, 0b1111111111010100,
      0b1111001000010111, 0b1111000100010000, 0b0010000111110011,
      0b1111110100001100, 0b0000111001010111, 0b0000000001000011,
      0b0000000110110001, 0b0000110100100000, 0b1111100111111101,
      0b0001101000011101, 0b1111010110010110, 0b0000010011000111,
      0b1111110010101111, 0b0001011100101101, 0b0011011100111010,
      0b1101000010000001};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_ts2_m2 = mlce16_m2(i16_src2_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_out_m2 = mmulh_mm(i16_ts1_m2, i16_ts2_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 4 * 16, "MMULH.MM INT16 M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(5);
  msettileni(8);
  const int32_t i32_src1_m2[] = {
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275,
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275};
  const int32_t i32_src2_m2[] = {
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353,
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353};
  const int32_t i32_ans_m2[] = {
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110,
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_ts2_m2 = mlce32_m2(i32_src2_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_out_m2 = mmulh_mm(i32_ts1_m2, i32_ts2_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 5 * 8, "MMULH.MM INT32 M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(1);
  msettileni(4);
  const int64_t i64_src1_m2[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2_m2[] = {4, 4, 4, 4};
  const int64_t i64_ans_m2[] = {
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001};
  mint64m2_t i64_ts1_m2 = mlce64_m2(i64_src1_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_ts2_m2 = mlce64_m2(i64_src2_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_out_m2 = mmulh_mm(i64_ts1_m2, i64_ts2_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 4, "MMULH.MM INT64 M2");
  // M4
  // int8
  msettype(E8, M4, BA);
  msettilemi(5);
  msettileni(64);
  const int8_t i8_src1_m4[] = {
      78,  52,  70,  7,   -58, 55,  44,  13,  34,  69,  84,  -96, 54,  98,  -71,
      35,  -93, 12,  -22, -67, 60,  99,  38,  46,  62,  61,  -53, -99, 66,  -69,
      7,   -79, 83,  67,  28,  37,  -1,  -84, 62,  -96, -19, -83, 4,   -99, 32,
      63,  57,  -58, 30,  21,  -72, -23, -67, 90,  63,  -1,  -56, 28,  3,   10,
      -72, -14, 67,  54,  -22, 1,   -16, -6,  55,  -39, 8,   -21, 7,   -74, -16,
      32,  -82, 1,   -27, 24,  78,  52,  70,  7,   -58, 55,  44,  13,  34,  69,
      84,  -96, 54,  98,  -71, 35,  -93, 12,  -22, -67, 60,  99,  38,  46,  62,
      61,  -53, -99, 66,  -69, 7,   -79, 83,  67,  28,  37,  -1,  -84, 62,  -96,
      -19, -83, 4,   -99, 32,  63,  57,  -58, 30,  21,  -72, -23, -67, 90,  63,
      -1,  -56, 28,  3,   10,  -72, -14, 67,  54,  -22, 1,   -16, -6,  55,  -39,
      8,   -21, 7,   -74, -16, 32,  -82, 1,   -27, 24,  78,  52,  70,  7,   -58,
      55,  44,  13,  34,  69,  84,  -96, 54,  98,  -71, 35,  -93, 12,  -22, -67,
      60,  99,  38,  46,  62,  61,  -53, -99, 66,  -69, 7,   -79, 83,  67,  28,
      37,  -1,  -84, 62,  -96, -19, -83, 4,   -99, 32,  63,  57,  -58, 30,  21,
      -72, -23, -67, 90,  63,  -1,  -56, 28,  3,   10,  -72, -14, 67,  54,  -22,
      1,   -16, -6,  55,  -39, 8,   -21, 7,   -74, -16, 32,  -82, 1,   -27, 24,
      78,  52,  70,  7,   -58, 55,  44,  13,  34,  69,  84,  -96, 54,  98,  -71,
      35,  -93, 12,  -22, -67, 60,  99,  38,  46,  62,  61,  -53, -99, 66,  -69,
      7,   -79, 83,  67,  28,  37,  -1,  -84, 62,  -96, -19, -83, 4,   -99, 32,
      63,  57,  -58, 30,  21,  -72, -23, -67, 90,  63,  -1,  -56, 28,  3,   10,
      -72, -14, 67,  54,  -22, 1,   -16, -6,  55,  -39, 8,   -21, 7,   -74, -16,
      32,  -82, 1,   -27, 24};
  const int8_t i8_src2_m4[] = {
      -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,  -29, -60, 0,   34,  11,
      -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66, -88, -11, -50, -72, 69,
      -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,  -34, 84,  1,   94,  -29,
      -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,  8,   -48, -92, -35, 14,
      -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,  2,   -48, -93, 96,  10,
      54,  65,  -2,  -75, 82,  -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,
      -29, -60, 0,   34,  11,  -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66,
      -88, -11, -50, -72, 69,  -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,
      -34, 84,  1,   94,  -29, -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,
      8,   -48, -92, -35, 14,  -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,
      2,   -48, -93, 96,  10,  54,  65,  -2,  -75, 82,  -92, -40, -71, -31, -2,
      -81, 32,  -25, 38,  31,  -29, -60, 0,   34,  11,  -10, -52, -58, -31, -17,
      73,  -81, -76, -7,  -66, -88, -11, -50, -72, 69,  -40, -77, -87, -56, 57,
      47,  -62, -54, 97,  84,  -34, 84,  1,   94,  -29, -60, -1,  -95, -52, -52,
      -39, -28, -24, -57, 11,  8,   -48, -92, -35, 14,  -99, 69,  94,  -80, 0,
      -53, -15, 21,  75,  74,  2,   -48, -93, 96,  10,  54,  65,  -2,  -75, 82,
      -92, -40, -71, -31, -2,  -81, 32,  -25, 38,  31,  -29, -60, 0,   34,  11,
      -10, -52, -58, -31, -17, 73,  -81, -76, -7,  -66, -88, -11, -50, -72, 69,
      -40, -77, -87, -56, 57,  47,  -62, -54, 97,  84,  -34, 84,  1,   94,  -29,
      -60, -1,  -95, -52, -52, -39, -28, -24, -57, 11,  8,   -48, -92, -35, 14,
      -99, 69,  94,  -80, 0,   -53, -15, 21,  75,  74,  2,   -48, -93, 96,  10,
      54,  65,  -2,  -75, 82};
  const int8_t i8_ans_m4[] = {
      0b11100011, 0b11110111, 0b11101100, 0b11111111, 0b00000000, 0b11101110,
      0b00000101, 0b11111110, 0b00000101, 0b00001000, 0b11110110, 0b00010110,
      0b00000000, 0b00001101, 0b11111100, 0b11111110, 0b00010010, 0b11111101,
      0b00000010, 0b00000100, 0b00010001, 0b11100000, 0b11110100, 0b11111110,
      0b11110000, 0b11101011, 0b00000010, 0b00010011, 0b11101101, 0b11101101,
      0b11111110, 0b00010111, 0b11100011, 0b11110001, 0b00000110, 0b00000110,
      0b00000000, 0b00010001, 0b00010111, 0b11100000, 0b00000010, 0b11100100,
      0b00000000, 0b11011011, 0b11111100, 0b11110001, 0b11111111, 0b00010101,
      0b11111001, 0b11111011, 0b00001010, 0b00000010, 0b00000110, 0b11101011,
      0b00000010, 0b11111111, 0b00001010, 0b11110101, 0b11111111, 0b00000000,
      0b00011011, 0b11111100, 0b00011000, 0b11101111, 0b00000000, 0b11111111,
      0b00000000, 0b11111111, 0b00010000, 0b11110100, 0b00000000, 0b00000011,
      0b11111101, 0b11100100, 0b11111111, 0b00000110, 0b11101011, 0b11111111,
      0b00000111, 0b00000111, 0b11100011, 0b11110111, 0b11101100, 0b11111111,
      0b00000000, 0b11101110, 0b00000101, 0b11111110, 0b00000101, 0b00001000,
      0b11110110, 0b00010110, 0b00000000, 0b00001101, 0b11111100, 0b11111110,
      0b00010010, 0b11111101, 0b00000010, 0b00000100, 0b00010001, 0b11100000,
      0b11110100, 0b11111110, 0b11110000, 0b11101011, 0b00000010, 0b00010011,
      0b11101101, 0b11101101, 0b11111110, 0b00010111, 0b11100011, 0b11110001,
      0b00000110, 0b00000110, 0b00000000, 0b00010001, 0b00010111, 0b11100000,
      0b00000010, 0b11100100, 0b00000000, 0b11011011, 0b11111100, 0b11110001,
      0b11111111, 0b00010101, 0b11111001, 0b11111011, 0b00001010, 0b00000010,
      0b00000110, 0b11101011, 0b00000010, 0b11111111, 0b00001010, 0b11110101,
      0b11111111, 0b00000000, 0b00011011, 0b11111100, 0b00011000, 0b11101111,
      0b00000000, 0b11111111, 0b00000000, 0b11111111, 0b00010000, 0b11110100,
      0b00000000, 0b00000011, 0b11111101, 0b11100100, 0b11111111, 0b00000110,
      0b11101011, 0b11111111, 0b00000111, 0b00000111, 0b11100011, 0b11110111,
      0b11101100, 0b11111111, 0b00000000, 0b11101110, 0b00000101, 0b11111110,
      0b00000101, 0b00001000, 0b11110110, 0b00010110, 0b00000000, 0b00001101,
      0b11111100, 0b11111110, 0b00010010, 0b11111101, 0b00000010, 0b00000100,
      0b00010001, 0b11100000, 0b11110100, 0b11111110, 0b11110000, 0b11101011,
      0b00000010, 0b00010011, 0b11101101, 0b11101101, 0b11111110, 0b00010111,
      0b11100011, 0b11110001, 0b00000110, 0b00000110, 0b00000000, 0b00010001,
      0b00010111, 0b11100000, 0b00000010, 0b11100100, 0b00000000, 0b11011011,
      0b11111100, 0b11110001, 0b11111111, 0b00010101, 0b11111001, 0b11111011,
      0b00001010, 0b00000010, 0b00000110, 0b11101011, 0b00000010, 0b11111111,
      0b00001010, 0b11110101, 0b11111111, 0b00000000, 0b00011011, 0b11111100,
      0b00011000, 0b11101111, 0b00000000, 0b11111111, 0b00000000, 0b11111111,
      0b00010000, 0b11110100, 0b00000000, 0b00000011, 0b11111101, 0b11100100,
      0b11111111, 0b00000110, 0b11101011, 0b11111111, 0b00000111, 0b00000111,
      0b11100011, 0b11110111, 0b11101100, 0b11111111, 0b00000000, 0b11101110,
      0b00000101, 0b11111110, 0b00000101, 0b00001000, 0b11110110, 0b00010110,
      0b00000000, 0b00001101, 0b11111100, 0b11111110, 0b00010010, 0b11111101,
      0b00000010, 0b00000100, 0b00010001, 0b11100000, 0b11110100, 0b11111110,
      0b11110000, 0b11101011, 0b00000010, 0b00010011, 0b11101101, 0b11101101,
      0b11111110, 0b00010111, 0b11100011, 0b11110001, 0b00000110, 0b00000110,
      0b00000000, 0b00010001, 0b00010111, 0b11100000, 0b00000010, 0b11100100,
      0b00000000, 0b11011011, 0b11111100, 0b11110001, 0b11111111, 0b00010101,
      0b11111001, 0b11111011, 0b00001010, 0b00000010, 0b00000110, 0b11101011,
      0b00000010, 0b11111111, 0b00001010, 0b11110101, 0b11111111, 0b00000000,
      0b00011011, 0b11111100, 0b00011000, 0b11101111, 0b00000000, 0b11111111,
      0b00000000, 0b11111111, 0b00010000, 0b11110100, 0b00000000, 0b00000011,
      0b11111101, 0b11100100, 0b11111111, 0b00000110, 0b11101011, 0b11111111,
      0b00000111, 0b00000111};
  mint8m4_t i8_ts1_m4 = mlce8_m4(i8_src1_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_ts2_m4 = mlce8_m4(i8_src2_m4, 64 * sizeof(int8_t));
  mint8m4_t i8_out_m4 = mmulh_mm(i8_ts1_m4, i8_ts2_m4);
  msce8_m(i8_out_m4, i8_buffer, 64 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m4, i8_buffer, 5 * 64, "MMULH.MM INT8  M4");
  // int16
  msettype(E16, M4, BA);
  msettilemi(4);
  msettileni(32);
  const int16_t i16_src1_m4[] = {
      11250,  22150,  2251,   12909,  -30246, 32388,  1526,   -29028, 9864,
      -24657, 21612,  -10020, 8121,   -24224, 6392,   -1325,  -12874, -27400,
      25592,  -20141, 13907,  3045,   -14471, -12370, 9058,   -15692, 20696,
      6998,   -3212,  17796,  31326,  26919,  11250,  22150,  2251,   12909,
      -30246, 32388,  1526,   -29028, 9864,   -24657, 21612,  -10020, 8121,
      -24224, 6392,   -1325,  -12874, -27400, 25592,  -20141, 13907,  3045,
      -14471, -12370, 9058,   -15692, 20696,  6998,   -3212,  17796,  31326,
      26919,  11250,  22150,  2251,   12909,  -30246, 32388,  1526,   -29028,
      9864,   -24657, 21612,  -10020, 8121,   -24224, 6392,   -1325,  -12874,
      -27400, 25592,  -20141, 13907,  3045,   -14471, -12370, 9058,   -15692,
      20696,  6998,   -3212,  17796,  31326,  26919,  11250,  22150,  2251,
      12909,  -30246, 32388,  1526,   -29028, 9864,   -24657, 21612,  -10020,
      8121,   -24224, 6392,   -1325,  -12874, -27400, 25592,  -20141, 13907,
      3045,   -14471, -12370, 9058,   -15692, 20696,  6998,   -3212,  17796,
      31326,  26919};
  const int16_t i16_src2_m4[] = {
      15471,  22523,  11719,  -29632, 2956,   -8034,  -1065,  4555,   -2719,
      21642,  5013,   23090,  1294,   -10139, 4386,   2174,   18127,  9145,
      22257,  2459,   17300,  1459,   -1963,  -17806, -11131, -27921, -8440,
      11457,  17303,  21852,  29579,  -29601, 15471,  22523,  11719,  -29632,
      2956,   -8034,  -1065,  4555,   -2719,  21642,  5013,   23090,  1294,
      -10139, 4386,   2174,   18127,  9145,   22257,  2459,   17300,  1459,
      -1963,  -17806, -11131, -27921, -8440,  11457,  17303,  21852,  29579,
      -29601, 15471,  22523,  11719,  -29632, 2956,   -8034,  -1065,  4555,
      -2719,  21642,  5013,   23090,  1294,   -10139, 4386,   2174,   18127,
      9145,   22257,  2459,   17300,  1459,   -1963,  -17806, -11131, -27921,
      -8440,  11457,  17303,  21852,  29579,  -29601, 15471,  22523,  11719,
      -29632, 2956,   -8034,  -1065,  4555,   -2719,  21642,  5013,   23090,
      1294,   -10139, 4386,   2174,   18127,  9145,   22257,  2459,   17300,
      1459,   -1963,  -17806, -11131, -27921, -8440,  11457,  17303,  21852,
      29579,  -29601};
  const int16_t i16_ans_m4[] = {
      0b0000101001011111, 0b0001110110111100, 0b0000000110010010,
      0b1110100100110011, 0b1111101010101011, 0b1111000001111101,
      0b1111111111100111, 0b1111100000011110, 0b1111111001100110,
      0b1110000000110001, 0b0000011001110101, 0b1111001000110101,
      0b0000000010100000, 0b0000111010100011, 0b0000000110101011,
      0b1111111111010100, 0b1111001000010111, 0b1111000100010000,
      0b0010000111110011, 0b1111110100001100, 0b0000111001010111,
      0b0000000001000011, 0b0000000110110001, 0b0000110100100000,
      0b1111100111111101, 0b0001101000011101, 0b1111010110010110,
      0b0000010011000111, 0b1111110010101111, 0b0001011100101101,
      0b0011011100111010, 0b1101000010000001, 0b0000101001011111,
      0b0001110110111100, 0b0000000110010010, 0b1110100100110011,
      0b1111101010101011, 0b1111000001111101, 0b1111111111100111,
      0b1111100000011110, 0b1111111001100110, 0b1110000000110001,
      0b0000011001110101, 0b1111001000110101, 0b0000000010100000,
      0b0000111010100011, 0b0000000110101011, 0b1111111111010100,
      0b1111001000010111, 0b1111000100010000, 0b0010000111110011,
      0b1111110100001100, 0b0000111001010111, 0b0000000001000011,
      0b0000000110110001, 0b0000110100100000, 0b1111100111111101,
      0b0001101000011101, 0b1111010110010110, 0b0000010011000111,
      0b1111110010101111, 0b0001011100101101, 0b0011011100111010,
      0b1101000010000001, 0b0000101001011111, 0b0001110110111100,
      0b0000000110010010, 0b1110100100110011, 0b1111101010101011,
      0b1111000001111101, 0b1111111111100111, 0b1111100000011110,
      0b1111111001100110, 0b1110000000110001, 0b0000011001110101,
      0b1111001000110101, 0b0000000010100000, 0b0000111010100011,
      0b0000000110101011, 0b1111111111010100, 0b1111001000010111,
      0b1111000100010000, 0b0010000111110011, 0b1111110100001100,
      0b0000111001010111, 0b0000000001000011, 0b0000000110110001,
      0b0000110100100000, 0b1111100111111101, 0b0001101000011101,
      0b1111010110010110, 0b0000010011000111, 0b1111110010101111,
      0b0001011100101101, 0b0011011100111010, 0b1101000010000001,
      0b0000101001011111, 0b0001110110111100, 0b0000000110010010,
      0b1110100100110011, 0b1111101010101011, 0b1111000001111101,
      0b1111111111100111, 0b1111100000011110, 0b1111111001100110,
      0b1110000000110001, 0b0000011001110101, 0b1111001000110101,
      0b0000000010100000, 0b0000111010100011, 0b0000000110101011,
      0b1111111111010100, 0b1111001000010111, 0b1111000100010000,
      0b0010000111110011, 0b1111110100001100, 0b0000111001010111,
      0b0000000001000011, 0b0000000110110001, 0b0000110100100000,
      0b1111100111111101, 0b0001101000011101, 0b1111010110010110,
      0b0000010011000111, 0b1111110010101111, 0b0001011100101101,
      0b0011011100111010, 0b1101000010000001};
  mint16m4_t i16_ts1_m4 = mlce16_m4(i16_src1_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_ts2_m4 = mlce16_m4(i16_src2_m4, 32 * sizeof(int16_t));
  mint16m4_t i16_out_m4 = mmulh_mm(i16_ts1_m4, i16_ts2_m4);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 4 * 32, "MMULH.MM INT16 M4");
  // int32
  msettype(E32, M4, BA);
  msettilemi(5);
  msettileni(16);
  const int32_t i32_src1_m4[] = {
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275,
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275,
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275,
      -1864187291, 44583579,   143522824,   -541181720, -511255337,
      1992571033,  2019553228, 414468700,   1143057586, -1900987662,
      2041881726,  -517526418, -1110304650, -648262133, 2004722094,
      -1852474879, 2090151511, 2012822785,  279661019,  1562895275};
  const int32_t i32_src2_m4[] = {
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353,
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353,
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353,
      1644675682,  415568863,  -695797429,  1188293154, -37381,
      -1066542573, -563026474, 1741107815,  1464853175, -991207022,
      -739078845,  -440318919, -2011471844, 312303164,  6822316,
      1711153974,  1165513769, -482726958,  1678327018, -101761353};
  const int32_t i32_ans_m4[] = {
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110,
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110,
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110,
      0b11010101011100110111000000111111, 0b00000000010000011101001010110100,
      0b11111110100111010011011101001101, 0b11110111000100110100111111010111,
      0b00000000000000000001000101100001, 0b11100010100000011110100010010001,
      0b11110000001110000101100000110010, 0b00001010000000111100001011101101,
      0b00010111001111001011010001101011, 0b00011010001001100100011110110000,
      0b11101011000011101000111100000001, 0b00000011001010011001010010100000,
      0b00011110111111100111000011011000, 0b11111101001100001011110011011111,
      0b00000000001100001001011100000101, 0b11010100000000100101110001000001,
      0b00100001110011101100010001100000, 0b11110010100001000000011100010111,
      0b00000110100000111000001011010110, 0b11111101110010101111011111010110};
  mint32m4_t i32_ts1_m4 = mlce32_m4(i32_src1_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_ts2_m4 = mlce32_m4(i32_src2_m4, 16 * sizeof(int32_t));
  mint32m4_t i32_out_m4 = mmulh_mm(i32_ts1_m4, i32_ts2_m4);
  msce32_m(i32_out_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 5 * 16, "MMULH.MM INT32 M4");
  // int64
  msettype(E64, M4, BA);
  msettilemi(1);
  msettileni(8);
  const int64_t i64_src1_m4[] = {
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111,
      0b0111111111111111111111111111111111111111111111111111111111111111};
  const int64_t i64_src2_m4[] = {4, 4, 4, 4, 4, 4, 4, 4};
  const int64_t i64_ans_m4[] = {
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001};
  mint64m4_t i64_ts1_m4 = mlce64_m4(i64_src1_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_ts2_m4 = mlce64_m4(i64_src2_m4, 8 * sizeof(int64_t));
  mint64m4_t i64_out_m4 = mmulh_mm(i64_ts1_m4, i64_ts2_m4);
  msce64_m(i64_out_m4, i64_buffer, 8 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 8, "MMULH.MM INT64 M4");
}

static void test_mmulhu_mm() {
  // M1
  // uint8
  msettype(E8, M1, BA);
  msettilemi(5);
  msettileni(16);
  const uint8_t u8_src1[] = {
      218, 219, 9,   166, 47,  113, 225, 53,  90,  48,  73,  171, 187, 75,
      45,  159, 234, 18,  62,  68,  39,  223, 64,  85,  20,  138, 77,  62,
      123, 227, 115, 76,  23,  162, 59,  121, 120, 182, 156, 76,  108, 97,
      30,  142, 12,  172, 95,  222, 185, 227, 156, 112, 173, 70,  57,  153,
      211, 109, 174, 126, 250, 44,  132, 202, 173, 124, 22,  250, 179, 25,
      17,  213, 127, 110, 131, 29,  93,  111, 214, 15};
  const uint8_t u8_src2[] = {
      41,  233, 234, 147, 165, 60,  171, 120, 57,  45,  130, 68,  95,  151,
      44,  178, 82,  13,  131, 98,  203, 59,  18,  142, 108, 61,  222, 28,
      44,  135, 17,  238, 72,  121, 47,  130, 26,  195, 169, 120, 152, 150,
      199, 130, 240, 74,  101, 168, 143, 50,  212, 113, 59,  220, 34,  228,
      47,  43,  98,  153, 194, 170, 153, 35,  150, 12,  221, 174, 113, 167,
      157, 239, 122, 161, 243, 134, 101, 205, 25,  110};
  const uint8_t u8_ans[] = {
      0b00100010, 0b11000111, 0b00001000, 0b01011111, 0b00011110, 0b00011010,
      0b10010110, 0b00011000, 0b00010100, 0b00001000, 0b00100101, 0b00101101,
      0b01000101, 0b00101100, 0b00000111, 0b01101110, 0b01001010, 0b00000000,
      0b00011111, 0b00011010, 0b00011110, 0b00110011, 0b00000100, 0b00101111,
      0b00001000, 0b00100000, 0b01000010, 0b00000110, 0b00010101, 0b01110111,
      0b00000111, 0b01000110, 0b00000110, 0b01001100, 0b00001010, 0b00111101,
      0b00001100, 0b10001010, 0b01100110, 0b00100011, 0b01000000, 0b00111000,
      0b00010111, 0b01001000, 0b00001011, 0b00110001, 0b00100101, 0b10010001,
      0b01100111, 0b00101100, 0b10000001, 0b00110001, 0b00100111, 0b00111100,
      0b00000111, 0b10001000, 0b00100110, 0b00010010, 0b01000010, 0b01001011,
      0b10111101, 0b00011101, 0b01001110, 0b00011011, 0b01100101, 0b00000101,
      0b00010010, 0b10101001, 0b01001111, 0b00010000, 0b00001010, 0b11000110,
      0b00111100, 0b01000101, 0b01111100, 0b00001111, 0b00100100, 0b01011000,
      0b00010100, 0b00000110};
  muint8m1_t u8_ts1 = mlce8_m1(u8_src1, 16 * sizeof(uint8_t));
  muint8m1_t u8_ts2 = mlce8_m1(u8_src2, 16 * sizeof(uint8_t));
  muint8m1_t u8_out = mmulhu_mm(u8_ts1, u8_ts2);
  msce8_m(u8_out, u8_buffer, 16 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans, u8_buffer, 80, "MMULHU.MM UINT8  M1");
  // int16
  msettype(E16, M1, BA);
  msettilemi(4);
  msettileni(8);
  const uint16_t u16_src1[] = {30758, 62393, 62484, 60446, 7705,  1850,  21253,
                               42579, 43216, 46744, 44386, 60631, 4239,  53960,
                               28678, 26611, 26276, 286,   57133, 42063, 59641,
                               33884, 33149, 29777, 1605,  3263,  12685, 58911,
                               46617, 17989, 19605, 42204};
  const uint16_t u16_src2[] = {23573, 39120, 31815, 28135, 49280, 46536, 9477,
                               8750,  24696, 56688, 65397, 5005,  54921, 48071,
                               62288, 5782,  32016, 60452, 55872, 15557, 16440,
                               56870, 28274, 32010, 59005, 58429, 50422, 33614,
                               34340, 59682, 35837, 2521};
  const uint16_t u16_ans[] = {
      0b0010101100110111, 0b1001000101111011, 0b0111011001111101,
      0b0110010101011101, 0b0001011010100001, 0b0000010100100001,
      0b0000110000000001, 0b0001011000110100, 0b0011111110011101,
      0b1001110111110001, 0b1010110100000011, 0b0001001000010110,
      0b0000110111100000, 0b1001101010011011, 0b0110101001111000,
      0b0000100100101011, 0b0011001000100100, 0b0000000100000111,
      0b1011111001000100, 0b0010011100000000, 0b0011101001110001,
      0b0111001011011011, 0b0011011111011101, 0b0011100011010000,
      0b0000010110100101, 0b0000101101011101, 0b0010011000011111,
      0b0111011000000111, 0b0101111101101010, 0b0011111111111110,
      0b0010100111100000, 0b0000011001010111};
  muint16m1_t u16_ts1 = mlce16_m1(u16_src1, 8 * sizeof(uint16_t));
  muint16m1_t u16_ts2 = mlce16_m1(u16_src2, 8 * sizeof(uint16_t));
  muint16m1_t u16_out = mmulhu_mm(u16_ts1, u16_ts2);
  msce16_m(u16_out, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans, u16_buffer, 32, "MMULHU.MM UINT16 M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(5);
  msettileni(4);
  const uint32_t u32_src1[] = {2172948444, 359704118,  1395972006, 2973813094,
                               2627025149, 1024097518, 1585699157, 279560401,
                               1264164351, 513761432,  135947367,  1100995243,
                               2072505173, 3639156404, 3495280324, 920348256,
                               1539165040, 1097253775, 2690046313, 1538064200};
  const uint32_t u32_src2[] = {3676752209, 2810261183, 1818098602, 2029977825,
                               754658238,  2592221485, 1446412455, 2579399226,
                               981211306,  3563678362, 2744399798, 3600055577,
                               1318098192, 1325016133, 197231042,  3179621507,
                               3911313836, 156625336,  3014748854, 1815934928};
  const uint32_t u32_ans[] = {
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100};
  muint32m1_t u32_ts1 = mlce32_m1(u32_src1, 4 * sizeof(uint32_t));
  muint32m1_t u32_ts2 = mlce32_m1(u32_src2, 4 * sizeof(uint32_t));
  muint32m1_t u32_out = mmulhu_mm(u32_ts1, u32_ts2);
  msce32_m(u32_out, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans, u32_buffer, 20, "MMULHU.MM UINT32 M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(1);
  msettileni(1);
  const uint64_t u64_src1[] = {
      0b1111111111111111111111111111111111111111111111111111111111111111};
  const uint64_t u64_src2[] = {4};
  const uint64_t u64_ans[] = {0b11};
  muint64m1_t u64_ts1 = mlce64_m1(u64_src1, 1 * sizeof(uint64_t));
  muint64m1_t u64_ts2 = mlce64_m1(u64_src2, 1 * sizeof(uint64_t));
  muint64m1_t u64_out = mmulhu_mm(u64_ts1, u64_ts2);
  msce64_m(u64_out, u64_buffer, 1 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans, u64_buffer, 1, "MMULHU.MM UINT64 M1");
  // M2
  // uint8
  msettype(E8, M2, BA);
  msettilemi(5);
  msettileni(32);
  const uint8_t u8_src1_m2[] = {
      218, 219, 9,   166, 47,  113, 225, 53,  90,  48,  73,  171, 187, 75,  45,
      159, 234, 18,  62,  68,  39,  223, 64,  85,  20,  138, 77,  62,  123, 227,
      115, 76,  23,  162, 59,  121, 120, 182, 156, 76,  108, 97,  30,  142, 12,
      172, 95,  222, 185, 227, 156, 112, 173, 70,  57,  153, 211, 109, 174, 126,
      250, 44,  132, 202, 173, 124, 22,  250, 179, 25,  17,  213, 127, 110, 131,
      29,  93,  111, 214, 15,  218, 219, 9,   166, 47,  113, 225, 53,  90,  48,
      73,  171, 187, 75,  45,  159, 234, 18,  62,  68,  39,  223, 64,  85,  20,
      138, 77,  62,  123, 227, 115, 76,  23,  162, 59,  121, 120, 182, 156, 76,
      108, 97,  30,  142, 12,  172, 95,  222, 185, 227, 156, 112, 173, 70,  57,
      153, 211, 109, 174, 126, 250, 44,  132, 202, 173, 124, 22,  250, 179, 25,
      17,  213, 127, 110, 131, 29,  93,  111, 214, 15};
  const uint8_t u8_src2_m2[] = {
      41,  233, 234, 147, 165, 60,  171, 120, 57,  45,  130, 68,  95,  151, 44,
      178, 82,  13,  131, 98,  203, 59,  18,  142, 108, 61,  222, 28,  44,  135,
      17,  238, 72,  121, 47,  130, 26,  195, 169, 120, 152, 150, 199, 130, 240,
      74,  101, 168, 143, 50,  212, 113, 59,  220, 34,  228, 47,  43,  98,  153,
      194, 170, 153, 35,  150, 12,  221, 174, 113, 167, 157, 239, 122, 161, 243,
      134, 101, 205, 25,  110, 41,  233, 234, 147, 165, 60,  171, 120, 57,  45,
      130, 68,  95,  151, 44,  178, 82,  13,  131, 98,  203, 59,  18,  142, 108,
      61,  222, 28,  44,  135, 17,  238, 72,  121, 47,  130, 26,  195, 169, 120,
      152, 150, 199, 130, 240, 74,  101, 168, 143, 50,  212, 113, 59,  220, 34,
      228, 47,  43,  98,  153, 194, 170, 153, 35,  150, 12,  221, 174, 113, 167,
      157, 239, 122, 161, 243, 134, 101, 205, 25,  110};
  const uint8_t u8_ans_m2[] = {
      0b00100010, 0b11000111, 0b00001000, 0b01011111, 0b00011110, 0b00011010,
      0b10010110, 0b00011000, 0b00010100, 0b00001000, 0b00100101, 0b00101101,
      0b01000101, 0b00101100, 0b00000111, 0b01101110, 0b01001010, 0b00000000,
      0b00011111, 0b00011010, 0b00011110, 0b00110011, 0b00000100, 0b00101111,
      0b00001000, 0b00100000, 0b01000010, 0b00000110, 0b00010101, 0b01110111,
      0b00000111, 0b01000110, 0b00000110, 0b01001100, 0b00001010, 0b00111101,
      0b00001100, 0b10001010, 0b01100110, 0b00100011, 0b01000000, 0b00111000,
      0b00010111, 0b01001000, 0b00001011, 0b00110001, 0b00100101, 0b10010001,
      0b01100111, 0b00101100, 0b10000001, 0b00110001, 0b00100111, 0b00111100,
      0b00000111, 0b10001000, 0b00100110, 0b00010010, 0b01000010, 0b01001011,
      0b10111101, 0b00011101, 0b01001110, 0b00011011, 0b01100101, 0b00000101,
      0b00010010, 0b10101001, 0b01001111, 0b00010000, 0b00001010, 0b11000110,
      0b00111100, 0b01000101, 0b01111100, 0b00001111, 0b00100100, 0b01011000,
      0b00010100, 0b00000110, 0b00100010, 0b11000111, 0b00001000, 0b01011111,
      0b00011110, 0b00011010, 0b10010110, 0b00011000, 0b00010100, 0b00001000,
      0b00100101, 0b00101101, 0b01000101, 0b00101100, 0b00000111, 0b01101110,
      0b01001010, 0b00000000, 0b00011111, 0b00011010, 0b00011110, 0b00110011,
      0b00000100, 0b00101111, 0b00001000, 0b00100000, 0b01000010, 0b00000110,
      0b00010101, 0b01110111, 0b00000111, 0b01000110, 0b00000110, 0b01001100,
      0b00001010, 0b00111101, 0b00001100, 0b10001010, 0b01100110, 0b00100011,
      0b01000000, 0b00111000, 0b00010111, 0b01001000, 0b00001011, 0b00110001,
      0b00100101, 0b10010001, 0b01100111, 0b00101100, 0b10000001, 0b00110001,
      0b00100111, 0b00111100, 0b00000111, 0b10001000, 0b00100110, 0b00010010,
      0b01000010, 0b01001011, 0b10111101, 0b00011101, 0b01001110, 0b00011011,
      0b01100101, 0b00000101, 0b00010010, 0b10101001, 0b01001111, 0b00010000,
      0b00001010, 0b11000110, 0b00111100, 0b01000101, 0b01111100, 0b00001111,
      0b00100100, 0b01011000, 0b00010100, 0b00000110};
  muint8m2_t u8_ts1_m2 = mlce8_m2(u8_src1_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_ts2_m2 = mlce8_m2(u8_src2_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_out_m2 = mmulhu_mm(u8_ts1_m2, u8_ts2_m2);
  msce8_m(u8_out_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m2, u8_buffer, 5 * 32, "MMULHU.MM UINT8  M2");
  // int16
  msettype(E16, M2, BA);
  msettilemi(4);
  msettileni(16);
  const uint16_t u16_src1_m2[] = {
      30758, 62393, 62484, 60446, 7705,  1850,  21253, 42579, 43216, 46744,
      44386, 60631, 4239,  53960, 28678, 26611, 26276, 286,   57133, 42063,
      59641, 33884, 33149, 29777, 1605,  3263,  12685, 58911, 46617, 17989,
      19605, 42204, 30758, 62393, 62484, 60446, 7705,  1850,  21253, 42579,
      43216, 46744, 44386, 60631, 4239,  53960, 28678, 26611, 26276, 286,
      57133, 42063, 59641, 33884, 33149, 29777, 1605,  3263,  12685, 58911,
      46617, 17989, 19605, 42204};
  const uint16_t u16_src2_m2[] = {
      23573, 39120, 31815, 28135, 49280, 46536, 9477,  8750,  24696, 56688,
      65397, 5005,  54921, 48071, 62288, 5782,  32016, 60452, 55872, 15557,
      16440, 56870, 28274, 32010, 59005, 58429, 50422, 33614, 34340, 59682,
      35837, 2521,  23573, 39120, 31815, 28135, 49280, 46536, 9477,  8750,
      24696, 56688, 65397, 5005,  54921, 48071, 62288, 5782,  32016, 60452,
      55872, 15557, 16440, 56870, 28274, 32010, 59005, 58429, 50422, 33614,
      34340, 59682, 35837, 2521};
  const uint16_t u16_ans_m2[] = {
      0b0010101100110111, 0b1001000101111011, 0b0111011001111101,
      0b0110010101011101, 0b0001011010100001, 0b0000010100100001,
      0b0000110000000001, 0b0001011000110100, 0b0011111110011101,
      0b1001110111110001, 0b1010110100000011, 0b0001001000010110,
      0b0000110111100000, 0b1001101010011011, 0b0110101001111000,
      0b0000100100101011, 0b0011001000100100, 0b0000000100000111,
      0b1011111001000100, 0b0010011100000000, 0b0011101001110001,
      0b0111001011011011, 0b0011011111011101, 0b0011100011010000,
      0b0000010110100101, 0b0000101101011101, 0b0010011000011111,
      0b0111011000000111, 0b0101111101101010, 0b0011111111111110,
      0b0010100111100000, 0b0000011001010111, 0b0010101100110111,
      0b1001000101111011, 0b0111011001111101, 0b0110010101011101,
      0b0001011010100001, 0b0000010100100001, 0b0000110000000001,
      0b0001011000110100, 0b0011111110011101, 0b1001110111110001,
      0b1010110100000011, 0b0001001000010110, 0b0000110111100000,
      0b1001101010011011, 0b0110101001111000, 0b0000100100101011,
      0b0011001000100100, 0b0000000100000111, 0b1011111001000100,
      0b0010011100000000, 0b0011101001110001, 0b0111001011011011,
      0b0011011111011101, 0b0011100011010000, 0b0000010110100101,
      0b0000101101011101, 0b0010011000011111, 0b0111011000000111,
      0b0101111101101010, 0b0011111111111110, 0b0010100111100000,
      0b0000011001010111};
  muint16m2_t u16_ts1_m2 = mlce16_m2(u16_src1_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_ts2_m2 = mlce16_m2(u16_src2_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_out_m2 = mmulhu_mm(u16_ts1_m2, u16_ts2_m2);
  msce16_m(u16_out_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m2, u16_buffer, 2 * 16, "MMULHU.MM UINT16 M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(5);
  msettileni(8);
  const uint32_t u32_src1_m2[] = {
      2172948444, 359704118,  1395972006, 2973813094, 2627025149, 1024097518,
      1585699157, 279560401,  1264164351, 513761432,  135947367,  1100995243,
      2072505173, 3639156404, 3495280324, 920348256,  1539165040, 1097253775,
      2690046313, 1538064200, 2172948444, 359704118,  1395972006, 2973813094,
      2627025149, 1024097518, 1585699157, 279560401,  1264164351, 513761432,
      135947367,  1100995243, 2072505173, 3639156404, 3495280324, 920348256,
      1539165040, 1097253775, 2690046313, 1538064200};
  const uint32_t u32_src2_m2[] = {
      3676752209, 2810261183, 1818098602, 2029977825, 754658238,  2592221485,
      1446412455, 2579399226, 981211306,  3563678362, 2744399798, 3600055577,
      1318098192, 1325016133, 197231042,  3179621507, 3911313836, 156625336,
      3014748854, 1815934928, 3676752209, 2810261183, 1818098602, 2029977825,
      754658238,  2592221485, 1446412455, 2579399226, 981211306,  3563678362,
      2744399798, 3600055577, 1318098192, 1325016133, 197231042,  3179621507,
      3911313836, 156625336,  3014748854, 1815934928};
  const uint32_t u32_ans_m2[] = {
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100,
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100};
  muint32m2_t u32_ts1_m2 = mlce32_m2(u32_src1_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_ts2_m2 = mlce32_m2(u32_src2_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_out_m2 = mmulhu_mm(u32_ts1_m2, u32_ts2_m2);
  msce32_m(u32_out_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m2, u32_buffer, 5 * 8, "MMULHU.MM UINT32 M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(1);
  msettileni(4);
  const uint64_t u64_src1_m2[] = {
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111};
  const uint64_t u64_src2_m2[] = {4, 4, 4, 4};
  const uint64_t u64_ans_m2[] = {0b11, 0b11, 0b11, 0b11};
  muint64m2_t u64_ts1_m2 = mlce64_m2(u64_src1_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_ts2_m2 = mlce64_m2(u64_src2_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_out_m2 = mmulhu_mm(u64_ts1_m2, u64_ts2_m2);
  msce64_m(u64_out_m2, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans_m2, u64_buffer, 4, "MMULHU.MM UINT64 M2");
  // M4
  // uint8
  msettype(E8, M4, BA);
  msettilemi(5);
  msettileni(32);
  const uint8_t u8_src1_m4[] = {
      218, 219, 9,   166, 47,  113, 225, 53,  90,  48,  73,  171, 187, 75,  45,
      159, 234, 18,  62,  68,  39,  223, 64,  85,  20,  138, 77,  62,  123, 227,
      115, 76,  23,  162, 59,  121, 120, 182, 156, 76,  108, 97,  30,  142, 12,
      172, 95,  222, 185, 227, 156, 112, 173, 70,  57,  153, 211, 109, 174, 126,
      250, 44,  132, 202, 173, 124, 22,  250, 179, 25,  17,  213, 127, 110, 131,
      29,  93,  111, 214, 15,  218, 219, 9,   166, 47,  113, 225, 53,  90,  48,
      73,  171, 187, 75,  45,  159, 234, 18,  62,  68,  39,  223, 64,  85,  20,
      138, 77,  62,  123, 227, 115, 76,  23,  162, 59,  121, 120, 182, 156, 76,
      108, 97,  30,  142, 12,  172, 95,  222, 185, 227, 156, 112, 173, 70,  57,
      153, 211, 109, 174, 126, 250, 44,  132, 202, 173, 124, 22,  250, 179, 25,
      17,  213, 127, 110, 131, 29,  93,  111, 214, 15,  218, 219, 9,   166, 47,
      113, 225, 53,  90,  48,  73,  171, 187, 75,  45,  159, 234, 18,  62,  68,
      39,  223, 64,  85,  20,  138, 77,  62,  123, 227, 115, 76,  23,  162, 59,
      121, 120, 182, 156, 76,  108, 97,  30,  142, 12,  172, 95,  222, 185, 227,
      156, 112, 173, 70,  57,  153, 211, 109, 174, 126, 250, 44,  132, 202, 173,
      124, 22,  250, 179, 25,  17,  213, 127, 110, 131, 29,  93,  111, 214, 15,
      218, 219, 9,   166, 47,  113, 225, 53,  90,  48,  73,  171, 187, 75,  45,
      159, 234, 18,  62,  68,  39,  223, 64,  85,  20,  138, 77,  62,  123, 227,
      115, 76,  23,  162, 59,  121, 120, 182, 156, 76,  108, 97,  30,  142, 12,
      172, 95,  222, 185, 227, 156, 112, 173, 70,  57,  153, 211, 109, 174, 126,
      250, 44,  132, 202, 173, 124, 22,  250, 179, 25,  17,  213, 127, 110, 131,
      29,  93,  111, 214, 15};
  const uint8_t u8_src2_m4[] = {
      41,  233, 234, 147, 165, 60,  171, 120, 57,  45,  130, 68,  95,  151, 44,
      178, 82,  13,  131, 98,  203, 59,  18,  142, 108, 61,  222, 28,  44,  135,
      17,  238, 72,  121, 47,  130, 26,  195, 169, 120, 152, 150, 199, 130, 240,
      74,  101, 168, 143, 50,  212, 113, 59,  220, 34,  228, 47,  43,  98,  153,
      194, 170, 153, 35,  150, 12,  221, 174, 113, 167, 157, 239, 122, 161, 243,
      134, 101, 205, 25,  110, 41,  233, 234, 147, 165, 60,  171, 120, 57,  45,
      130, 68,  95,  151, 44,  178, 82,  13,  131, 98,  203, 59,  18,  142, 108,
      61,  222, 28,  44,  135, 17,  238, 72,  121, 47,  130, 26,  195, 169, 120,
      152, 150, 199, 130, 240, 74,  101, 168, 143, 50,  212, 113, 59,  220, 34,
      228, 47,  43,  98,  153, 194, 170, 153, 35,  150, 12,  221, 174, 113, 167,
      157, 239, 122, 161, 243, 134, 101, 205, 25,  110, 41,  233, 234, 147, 165,
      60,  171, 120, 57,  45,  130, 68,  95,  151, 44,  178, 82,  13,  131, 98,
      203, 59,  18,  142, 108, 61,  222, 28,  44,  135, 17,  238, 72,  121, 47,
      130, 26,  195, 169, 120, 152, 150, 199, 130, 240, 74,  101, 168, 143, 50,
      212, 113, 59,  220, 34,  228, 47,  43,  98,  153, 194, 170, 153, 35,  150,
      12,  221, 174, 113, 167, 157, 239, 122, 161, 243, 134, 101, 205, 25,  110,
      41,  233, 234, 147, 165, 60,  171, 120, 57,  45,  130, 68,  95,  151, 44,
      178, 82,  13,  131, 98,  203, 59,  18,  142, 108, 61,  222, 28,  44,  135,
      17,  238, 72,  121, 47,  130, 26,  195, 169, 120, 152, 150, 199, 130, 240,
      74,  101, 168, 143, 50,  212, 113, 59,  220, 34,  228, 47,  43,  98,  153,
      194, 170, 153, 35,  150, 12,  221, 174, 113, 167, 157, 239, 122, 161, 243,
      134, 101, 205, 25,  110};
  const uint8_t u8_ans_m4[] = {
      0b00100010, 0b11000111, 0b00001000, 0b01011111, 0b00011110, 0b00011010,
      0b10010110, 0b00011000, 0b00010100, 0b00001000, 0b00100101, 0b00101101,
      0b01000101, 0b00101100, 0b00000111, 0b01101110, 0b01001010, 0b00000000,
      0b00011111, 0b00011010, 0b00011110, 0b00110011, 0b00000100, 0b00101111,
      0b00001000, 0b00100000, 0b01000010, 0b00000110, 0b00010101, 0b01110111,
      0b00000111, 0b01000110, 0b00000110, 0b01001100, 0b00001010, 0b00111101,
      0b00001100, 0b10001010, 0b01100110, 0b00100011, 0b01000000, 0b00111000,
      0b00010111, 0b01001000, 0b00001011, 0b00110001, 0b00100101, 0b10010001,
      0b01100111, 0b00101100, 0b10000001, 0b00110001, 0b00100111, 0b00111100,
      0b00000111, 0b10001000, 0b00100110, 0b00010010, 0b01000010, 0b01001011,
      0b10111101, 0b00011101, 0b01001110, 0b00011011, 0b01100101, 0b00000101,
      0b00010010, 0b10101001, 0b01001111, 0b00010000, 0b00001010, 0b11000110,
      0b00111100, 0b01000101, 0b01111100, 0b00001111, 0b00100100, 0b01011000,
      0b00010100, 0b00000110, 0b00100010, 0b11000111, 0b00001000, 0b01011111,
      0b00011110, 0b00011010, 0b10010110, 0b00011000, 0b00010100, 0b00001000,
      0b00100101, 0b00101101, 0b01000101, 0b00101100, 0b00000111, 0b01101110,
      0b01001010, 0b00000000, 0b00011111, 0b00011010, 0b00011110, 0b00110011,
      0b00000100, 0b00101111, 0b00001000, 0b00100000, 0b01000010, 0b00000110,
      0b00010101, 0b01110111, 0b00000111, 0b01000110, 0b00000110, 0b01001100,
      0b00001010, 0b00111101, 0b00001100, 0b10001010, 0b01100110, 0b00100011,
      0b01000000, 0b00111000, 0b00010111, 0b01001000, 0b00001011, 0b00110001,
      0b00100101, 0b10010001, 0b01100111, 0b00101100, 0b10000001, 0b00110001,
      0b00100111, 0b00111100, 0b00000111, 0b10001000, 0b00100110, 0b00010010,
      0b01000010, 0b01001011, 0b10111101, 0b00011101, 0b01001110, 0b00011011,
      0b01100101, 0b00000101, 0b00010010, 0b10101001, 0b01001111, 0b00010000,
      0b00001010, 0b11000110, 0b00111100, 0b01000101, 0b01111100, 0b00001111,
      0b00100100, 0b01011000, 0b00010100, 0b00000110, 0b00100010, 0b11000111,
      0b00001000, 0b01011111, 0b00011110, 0b00011010, 0b10010110, 0b00011000,
      0b00010100, 0b00001000, 0b00100101, 0b00101101, 0b01000101, 0b00101100,
      0b00000111, 0b01101110, 0b01001010, 0b00000000, 0b00011111, 0b00011010,
      0b00011110, 0b00110011, 0b00000100, 0b00101111, 0b00001000, 0b00100000,
      0b01000010, 0b00000110, 0b00010101, 0b01110111, 0b00000111, 0b01000110,
      0b00000110, 0b01001100, 0b00001010, 0b00111101, 0b00001100, 0b10001010,
      0b01100110, 0b00100011, 0b01000000, 0b00111000, 0b00010111, 0b01001000,
      0b00001011, 0b00110001, 0b00100101, 0b10010001, 0b01100111, 0b00101100,
      0b10000001, 0b00110001, 0b00100111, 0b00111100, 0b00000111, 0b10001000,
      0b00100110, 0b00010010, 0b01000010, 0b01001011, 0b10111101, 0b00011101,
      0b01001110, 0b00011011, 0b01100101, 0b00000101, 0b00010010, 0b10101001,
      0b01001111, 0b00010000, 0b00001010, 0b11000110, 0b00111100, 0b01000101,
      0b01111100, 0b00001111, 0b00100100, 0b01011000, 0b00010100, 0b00000110,
      0b00100010, 0b11000111, 0b00001000, 0b01011111, 0b00011110, 0b00011010,
      0b10010110, 0b00011000, 0b00010100, 0b00001000, 0b00100101, 0b00101101,
      0b01000101, 0b00101100, 0b00000111, 0b01101110, 0b01001010, 0b00000000,
      0b00011111, 0b00011010, 0b00011110, 0b00110011, 0b00000100, 0b00101111,
      0b00001000, 0b00100000, 0b01000010, 0b00000110, 0b00010101, 0b01110111,
      0b00000111, 0b01000110, 0b00000110, 0b01001100, 0b00001010, 0b00111101,
      0b00001100, 0b10001010, 0b01100110, 0b00100011, 0b01000000, 0b00111000,
      0b00010111, 0b01001000, 0b00001011, 0b00110001, 0b00100101, 0b10010001,
      0b01100111, 0b00101100, 0b10000001, 0b00110001, 0b00100111, 0b00111100,
      0b00000111, 0b10001000, 0b00100110, 0b00010010, 0b01000010, 0b01001011,
      0b10111101, 0b00011101, 0b01001110, 0b00011011, 0b01100101, 0b00000101,
      0b00010010, 0b10101001, 0b01001111, 0b00010000, 0b00001010, 0b11000110,
      0b00111100, 0b01000101, 0b01111100, 0b00001111, 0b00100100, 0b01011000,
      0b00010100, 0b00000110};
  muint8m4_t u8_ts1_m4 = mlce8_m4(u8_src1_m4, 64 * sizeof(uint8_t));
  muint8m4_t u8_ts2_m4 = mlce8_m4(u8_src2_m4, 64 * sizeof(uint8_t));
  muint8m4_t u8_out_m4 = mmulhu_mm(u8_ts1_m4, u8_ts2_m4);
  msce8_m(u8_out_m4, u8_buffer, 64 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m4, u8_buffer, 5 * 64, "MMULHU.MM UINT8  M4");
  // int16
  msettype(E16, M4, BA);
  msettilemi(4);
  msettileni(32);
  const uint16_t u16_src1_m4[] = {
      30758, 62393, 62484, 60446, 7705,  1850,  21253, 42579, 43216, 46744,
      44386, 60631, 4239,  53960, 28678, 26611, 26276, 286,   57133, 42063,
      59641, 33884, 33149, 29777, 1605,  3263,  12685, 58911, 46617, 17989,
      19605, 42204, 30758, 62393, 62484, 60446, 7705,  1850,  21253, 42579,
      43216, 46744, 44386, 60631, 4239,  53960, 28678, 26611, 26276, 286,
      57133, 42063, 59641, 33884, 33149, 29777, 1605,  3263,  12685, 58911,
      46617, 17989, 19605, 42204, 30758, 62393, 62484, 60446, 7705,  1850,
      21253, 42579, 43216, 46744, 44386, 60631, 4239,  53960, 28678, 26611,
      26276, 286,   57133, 42063, 59641, 33884, 33149, 29777, 1605,  3263,
      12685, 58911, 46617, 17989, 19605, 42204, 30758, 62393, 62484, 60446,
      7705,  1850,  21253, 42579, 43216, 46744, 44386, 60631, 4239,  53960,
      28678, 26611, 26276, 286,   57133, 42063, 59641, 33884, 33149, 29777,
      1605,  3263,  12685, 58911, 46617, 17989, 19605, 42204};
  const uint16_t u16_src2_m4[] = {
      23573, 39120, 31815, 28135, 49280, 46536, 9477,  8750,  24696, 56688,
      65397, 5005,  54921, 48071, 62288, 5782,  32016, 60452, 55872, 15557,
      16440, 56870, 28274, 32010, 59005, 58429, 50422, 33614, 34340, 59682,
      35837, 2521,  23573, 39120, 31815, 28135, 49280, 46536, 9477,  8750,
      24696, 56688, 65397, 5005,  54921, 48071, 62288, 5782,  32016, 60452,
      55872, 15557, 16440, 56870, 28274, 32010, 59005, 58429, 50422, 33614,
      34340, 59682, 35837, 2521,  23573, 39120, 31815, 28135, 49280, 46536,
      9477,  8750,  24696, 56688, 65397, 5005,  54921, 48071, 62288, 5782,
      32016, 60452, 55872, 15557, 16440, 56870, 28274, 32010, 59005, 58429,
      50422, 33614, 34340, 59682, 35837, 2521,  23573, 39120, 31815, 28135,
      49280, 46536, 9477,  8750,  24696, 56688, 65397, 5005,  54921, 48071,
      62288, 5782,  32016, 60452, 55872, 15557, 16440, 56870, 28274, 32010,
      59005, 58429, 50422, 33614, 34340, 59682, 35837, 2521};
  const uint16_t u16_ans_m4[] = {
      0b0010101100110111, 0b1001000101111011, 0b0111011001111101,
      0b0110010101011101, 0b0001011010100001, 0b0000010100100001,
      0b0000110000000001, 0b0001011000110100, 0b0011111110011101,
      0b1001110111110001, 0b1010110100000011, 0b0001001000010110,
      0b0000110111100000, 0b1001101010011011, 0b0110101001111000,
      0b0000100100101011, 0b0011001000100100, 0b0000000100000111,
      0b1011111001000100, 0b0010011100000000, 0b0011101001110001,
      0b0111001011011011, 0b0011011111011101, 0b0011100011010000,
      0b0000010110100101, 0b0000101101011101, 0b0010011000011111,
      0b0111011000000111, 0b0101111101101010, 0b0011111111111110,
      0b0010100111100000, 0b0000011001010111, 0b0010101100110111,
      0b1001000101111011, 0b0111011001111101, 0b0110010101011101,
      0b0001011010100001, 0b0000010100100001, 0b0000110000000001,
      0b0001011000110100, 0b0011111110011101, 0b1001110111110001,
      0b1010110100000011, 0b0001001000010110, 0b0000110111100000,
      0b1001101010011011, 0b0110101001111000, 0b0000100100101011,
      0b0011001000100100, 0b0000000100000111, 0b1011111001000100,
      0b0010011100000000, 0b0011101001110001, 0b0111001011011011,
      0b0011011111011101, 0b0011100011010000, 0b0000010110100101,
      0b0000101101011101, 0b0010011000011111, 0b0111011000000111,
      0b0101111101101010, 0b0011111111111110, 0b0010100111100000,
      0b0000011001010111, 0b0010101100110111, 0b1001000101111011,
      0b0111011001111101, 0b0110010101011101, 0b0001011010100001,
      0b0000010100100001, 0b0000110000000001, 0b0001011000110100,
      0b0011111110011101, 0b1001110111110001, 0b1010110100000011,
      0b0001001000010110, 0b0000110111100000, 0b1001101010011011,
      0b0110101001111000, 0b0000100100101011, 0b0011001000100100,
      0b0000000100000111, 0b1011111001000100, 0b0010011100000000,
      0b0011101001110001, 0b0111001011011011, 0b0011011111011101,
      0b0011100011010000, 0b0000010110100101, 0b0000101101011101,
      0b0010011000011111, 0b0111011000000111, 0b0101111101101010,
      0b0011111111111110, 0b0010100111100000, 0b0000011001010111,
      0b0010101100110111, 0b1001000101111011, 0b0111011001111101,
      0b0110010101011101, 0b0001011010100001, 0b0000010100100001,
      0b0000110000000001, 0b0001011000110100, 0b0011111110011101,
      0b1001110111110001, 0b1010110100000011, 0b0001001000010110,
      0b0000110111100000, 0b1001101010011011, 0b0110101001111000,
      0b0000100100101011, 0b0011001000100100, 0b0000000100000111,
      0b1011111001000100, 0b0010011100000000, 0b0011101001110001,
      0b0111001011011011, 0b0011011111011101, 0b0011100011010000,
      0b0000010110100101, 0b0000101101011101, 0b0010011000011111,
      0b0111011000000111, 0b0101111101101010, 0b0011111111111110,
      0b0010100111100000, 0b0000011001010111};
  muint16m4_t u16_ts1_m4 = mlce16_m4(u16_src1_m4, 32 * sizeof(uint16_t));
  muint16m4_t u16_ts2_m4 = mlce16_m4(u16_src2_m4, 32 * sizeof(uint16_t));
  muint16m4_t u16_out_m4 = mmulhu_mm(u16_ts1_m4, u16_ts2_m4);
  msce16_m(u16_out_m4, u16_buffer, 32 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m4, u16_buffer, 2 * 32, "MMULHU.MM UINT16 M4");
  // int32
  msettype(E32, M4, BA);
  msettilemi(5);
  msettileni(16);
  const uint32_t u32_src1_m4[] = {
      2172948444, 359704118,  1395972006, 2973813094, 2627025149, 1024097518,
      1585699157, 279560401,  1264164351, 513761432,  135947367,  1100995243,
      2072505173, 3639156404, 3495280324, 920348256,  1539165040, 1097253775,
      2690046313, 1538064200, 2172948444, 359704118,  1395972006, 2973813094,
      2627025149, 1024097518, 1585699157, 279560401,  1264164351, 513761432,
      135947367,  1100995243, 2072505173, 3639156404, 3495280324, 920348256,
      1539165040, 1097253775, 2690046313, 1538064200, 2172948444, 359704118,
      1395972006, 2973813094, 2627025149, 1024097518, 1585699157, 279560401,
      1264164351, 513761432,  135947367,  1100995243, 2072505173, 3639156404,
      3495280324, 920348256,  1539165040, 1097253775, 2690046313, 1538064200,
      2172948444, 359704118,  1395972006, 2973813094, 2627025149, 1024097518,
      1585699157, 279560401,  1264164351, 513761432,  135947367,  1100995243,
      2072505173, 3639156404, 3495280324, 920348256,  1539165040, 1097253775,
      2690046313, 1538064200};
  const uint32_t u32_src2_m4[] = {
      3676752209, 2810261183, 1818098602, 2029977825, 754658238,  2592221485,
      1446412455, 2579399226, 981211306,  3563678362, 2744399798, 3600055577,
      1318098192, 1325016133, 197231042,  3179621507, 3911313836, 156625336,
      3014748854, 1815934928, 3676752209, 2810261183, 1818098602, 2029977825,
      754658238,  2592221485, 1446412455, 2579399226, 981211306,  3563678362,
      2744399798, 3600055577, 1318098192, 1325016133, 197231042,  3179621507,
      3911313836, 156625336,  3014748854, 1815934928, 3676752209, 2810261183,
      1818098602, 2029977825, 754658238,  2592221485, 1446412455, 2579399226,
      981211306,  3563678362, 2744399798, 3600055577, 1318098192, 1325016133,
      197231042,  3179621507, 3911313836, 156625336,  3014748854, 1815934928,
      3676752209, 2810261183, 1818098602, 2029977825, 754658238,  2592221485,
      1446412455, 2579399226, 981211306,  3563678362, 2744399798, 3600055577,
      1318098192, 1325016133, 197231042,  3179621507, 3911313836, 156625336,
      3014748854, 1815934928};
  const uint32_t u32_ans_m4[] = {
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100,
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100,
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100,
      0b01101110111000000000011010011000, 0b00001110000001110100111000011011,
      0b00100011001110001101011011111000, 0b01010011110001101110111010001100,
      0b00011011100000110100011011011011, 0b00100100110101110101100001001100,
      0b00011111110101000110101001010001, 0b00001010000000011101101010110011,
      0b00010001001101101101010001110110, 0b00011001011010001001100000011100,
      0b00000101001011010111111011110011, 0b00110111000000011011000101000110,
      0b00100101111010010010111000010110, 0b01000010111010101111100110111110,
      0b00001001100100010010100101110000, 0b00101000100111001000010000011010,
      0b01010011100010111110010101011101, 0b00000010011000101000111110110100,
      0b01110000100010111101100011100110, 0b00100110110000101101000011111100};
  muint32m4_t u32_ts1_m4 = mlce32_m4(u32_src1_m4, 16 * sizeof(uint32_t));
  muint32m4_t u32_ts2_m4 = mlce32_m4(u32_src2_m4, 16 * sizeof(uint32_t));
  muint32m4_t u32_out_m4 = mmulhu_mm(u32_ts1_m4, u32_ts2_m4);
  msce32_m(u32_out_m4, u32_buffer, 16 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m4, u32_buffer, 5 * 16, "MMULHU.MM UINT32 M4");
  // int64
  msettype(E64, M4, BA);
  msettilemi(1);
  msettileni(8);
  const uint64_t u64_src1_m4[] = {
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111,
      0b1111111111111111111111111111111111111111111111111111111111111111};
  const uint64_t u64_src2_m4[] = {4, 4, 4, 4, 4, 4, 4, 4};
  const uint64_t u64_ans_m4[] = {0b11, 0b11, 0b11, 0b11,
                                 0b11, 0b11, 0b11, 0b11};
  muint64m4_t u64_ts1_m4 = mlce64_m4(u64_src1_m4, 8 * sizeof(uint64_t));
  muint64m4_t u64_ts2_m4 = mlce64_m4(u64_src2_m4, 8 * sizeof(uint64_t));
  muint64m4_t u64_out_m4 = mmulhu_mm(u64_ts1_m4, u64_ts2_m4);
  msce64_m(u64_out_m4, u64_buffer, 8 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans_m4, u64_buffer, 8, "MMULHU.MM UINT64 M4");
}

static void test_mmulhsu_mm() {
  // M1
  // int8 * uint8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(8);
  const int8_t i8_src[] = {-119, -45, 30,  66, -1,   35,  -33,  -48,
                           -75,  -81, -78, 94, -100, -16, -123, 62};
  const uint8_t u8_src[] = {71, 170, 59,  87,  175, 158, 104, 165,
                            71, 60,  188, 221, 213, 133, 162, 38};
  const int8_t i8_ans[] = {0b11011110, 0b11100010, 0b00000110, 0b00010110,
                           0b11111111, 0b00010101, 0b11110010, 0b11100001,
                           0b11101011, 0b11101101, 0b11000110, 0b01010001,
                           0b10101100, 0b11110111, 0b10110010, 0b00001001};
  mint8m1_t i8_ts = mlce8_m1(i8_src, 8 * sizeof(int8_t));
  muint8m1_t u8_ts = mlce8_m1(u8_src, 8 * sizeof(uint8_t));
  mint8m1_t i8_out = mmulhsu_mm(i8_ts, u8_ts);
  msce8_m(i8_out, i8_buffer, 8 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 16, "MMULHSU.MM INT8  M1");
  // int16 * uint16
  msettype(E16, M1, BA);
  msettilemi(2);
  msettileni(8);
  const int16_t i16_src[] = {-23927, -27930, -17071, -10024, -8550, -20789,
                             -27779, -7397,  -1849,  -9510,  22406, 4447,
                             -15129, 22404,  -13497, 26261};
  const uint16_t u16_src[] = {27991, 51391, 28406, 5930,  54367, 50554,
                              722,   61530, 28493, 56015, 46403, 53864,
                              9045,  63484, 28683, 30193};
  const int16_t i16_ans[] = {
      0b1101100000010100, 0b1010101001110010, 0b1110001100011000,
      0b1111110001110100, 0b1110010001001011, 0b1100000101011011,
      0b1111111011001101, 0b1110010011011111, 0b1111110011011100,
      0b1110000000111111, 0b0011110111111000, 0b0000111001000110,
      0b1111011111010111, 0b0101010011000110, 0b1110100011101100,
      0b0010111101000010};
  mint16m1_t i16_ts = mlce16_m1(i16_src, 8 * sizeof(int16_t));
  muint16m1_t u16_ts = mlce16_m1(u16_src, 8 * sizeof(uint16_t));
  mint16m1_t i16_out = mmulhsu_mm(i16_ts, u16_ts);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 16, "MMULHSU.MM INT16 M1");
  // int32 * uint32
  msettype(E32, M1, BA);
  msettilemi(3);
  msettileni(4);
  const int32_t i32_src[] = {339215551, -1941713488, -2057274773, 1140599006,
                             654007477, -1965774859, -799119959,  1377821961,
                             813335216, 130319061,   1473989864,  -2085806316};
  const uint32_t u32_src[] = {2839631618, 3369629408, 792889355,  3177381946,
                              2345233770, 2096172162, 3088374241, 1618641259,
                              868284847,  984913835,  89281062,   2726419517};
  const int32_t i32_ans[] = {
      0b00001101010111100010010000111010, 0b10100101001100110001110000101001,
      0b11101001010111001101100000101111, 0b00110010010010110111010010111111,
      0b00010101010010010010011101011011, 0b11000110110100001010110111010011,
      0b11011101101111111111011111100111, 0b00011110111100110100001010011010,
      0b00001001110011001111001100110011, 0b00000001110010000000000001101010,
      0b00000001110100111000100011110000, 0b10110001000101000111110011110010};
  mint32m1_t i32_ts = mlce32_m1(i32_src, 4 * sizeof(int32_t));
  muint32m1_t u32_ts = mlce32_m1(u32_src, 4 * sizeof(uint32_t));
  mint32m1_t i32_out = mmulhsu_mm(i32_ts, u32_ts);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 12, "MMULHSU.MM INT32 M1");
  // int64 * uint64
  msettype(E64, M1, BA);
  msettilemi(1);
  msettileni(1);
  const int64_t i64_src[] = {
      0b0101011010000000100111011011011000000010011011100100011101111001};
  const uint64_t u64_src[] = {4};
  const int64_t i64_ans[] = {
      0b0000000000000000000000000000000000000000000000000000000000000001};
  mint64m1_t i64_ts = mlce64_m1(i64_src, 1 * sizeof(int64_t));
  muint64m1_t u64_ts = mlce64_m1(u64_src, 1 * sizeof(uint64_t));
  mint64m1_t i64_out = mmulhsu_mm(i64_ts, u64_ts);
  msce64_m(i64_out, i64_buffer, 1 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 1, "MMULHSU.MM INT64 M1");
  // M2
  // int8 * uint8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const int8_t i8_src_m2[] = {
      -119, -45, 30,   66,  -1,   35,  -33,  -48, -75, -81, -78, 94,  -100, -16,
      -123, 62,  -119, -45, 30,   66,  -1,   35,  -33, -48, -75, -81, -78,  94,
      -100, -16, -123, 62,  -119, -45, 30,   66,  -1,  35,  -33, -48, -75,  -81,
      -78,  94,  -100, -16, -123, 62,  -119, -45, 30,  66,  -1,  35,  -33,  -48,
      -75,  -81, -78,  94,  -100, -16, -123, 62};
  const uint8_t u8_src_m2[] = {
      71, 170, 59, 87, 175, 158, 104, 165, 71, 60, 188, 221, 213, 133, 162, 38,
      71, 170, 59, 87, 175, 158, 104, 165, 71, 60, 188, 221, 213, 133, 162, 38,
      71, 170, 59, 87, 175, 158, 104, 165, 71, 60, 188, 221, 213, 133, 162, 38,
      71, 170, 59, 87, 175, 158, 104, 165, 71, 60, 188, 221, 213, 133, 162, 38};
  const int8_t i8_ans_m2[] = {
      0b11011110, 0b11100010, 0b00000110, 0b00010110, 0b11111111, 0b00010101,
      0b11110010, 0b11100001, 0b11101011, 0b11101101, 0b11000110, 0b01010001,
      0b10101100, 0b11110111, 0b10110010, 0b00001001, 0b11011110, 0b11100010,
      0b00000110, 0b00010110, 0b11111111, 0b00010101, 0b11110010, 0b11100001,
      0b11101011, 0b11101101, 0b11000110, 0b01010001, 0b10101100, 0b11110111,
      0b10110010, 0b00001001, 0b11011110, 0b11100010, 0b00000110, 0b00010110,
      0b11111111, 0b00010101, 0b11110010, 0b11100001, 0b11101011, 0b11101101,
      0b11000110, 0b01010001, 0b10101100, 0b11110111, 0b10110010, 0b00001001,
      0b11011110, 0b11100010, 0b00000110, 0b00010110, 0b11111111, 0b00010101,
      0b11110010, 0b11100001, 0b11101011, 0b11101101, 0b11000110, 0b01010001,
      0b10101100, 0b11110111, 0b10110010, 0b00001001};
  mint8m2_t i8_ts_m2 = mlce8_m2(i8_src_m2, 32 * sizeof(int8_t));
  muint8m2_t u8_ts_m2 = mlce8_m2(u8_src_m2, 32 * sizeof(uint8_t));
  mint8m2_t i8_out_m2 = mmulhsu_mm(i8_ts_m2, u8_ts_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 2 * 32, "MMULHSU.MM INT8  M2");
  // int16 * uint16
  msettype(E16, M2, BA);
  msettilemi(2);
  msettileni(16);
  const int16_t i16_src_m2[] = {
      -23927, -27930, -17071, -10024, -8550,  -20789, -27779, -7397,
      -1849,  -9510,  22406,  4447,   -15129, 22404,  -13497, 26261,
      -23927, -27930, -17071, -10024, -8550,  -20789, -27779, -7397,
      -1849,  -9510,  22406,  4447,   -15129, 22404,  -13497, 26261};
  const uint16_t u16_src_m2[] = {
      27991, 51391, 28406, 5930,  54367, 50554, 722,   61530,
      28493, 56015, 46403, 53864, 9045,  63484, 28683, 30193,
      27991, 51391, 28406, 5930,  54367, 50554, 722,   61530,
      28493, 56015, 46403, 53864, 9045,  63484, 28683, 30193};
  const int16_t i16_ans_m2[] = {
      0b1101100000010100, 0b1010101001110010, 0b1110001100011000,
      0b1111110001110100, 0b1110010001001011, 0b1100000101011011,
      0b1111111011001101, 0b1110010011011111, 0b1111110011011100,
      0b1110000000111111, 0b0011110111111000, 0b0000111001000110,
      0b1111011111010111, 0b0101010011000110, 0b1110100011101100,
      0b0010111101000010, 0b1101100000010100, 0b1010101001110010,
      0b1110001100011000, 0b1111110001110100, 0b1110010001001011,
      0b1100000101011011, 0b1111111011001101, 0b1110010011011111,
      0b1111110011011100, 0b1110000000111111, 0b0011110111111000,
      0b0000111001000110, 0b1111011111010111, 0b0101010011000110,
      0b1110100011101100, 0b0010111101000010};
  mint16m2_t i16_ts_m2 = mlce16_m2(i16_src_m2, 16 * sizeof(int16_t));
  muint16m2_t u16_ts_m2 = mlce16_m2(u16_src_m2, 16 * sizeof(uint16_t));
  mint16m2_t i16_out_m2 = mmulhsu_mm(i16_ts_m2, u16_ts_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 2 * 16, "MMULHSU.MM INT16 M2");
  // int32 * uint32
  msettype(E32, M2, BA);
  msettilemi(3);
  msettileni(8);
  const int32_t i32_src_m2[] = {
      339215551,   -1941713488, -2057274773, 1140599006,  654007477,
      -1965774859, -799119959,  1377821961,  813335216,   130319061,
      1473989864,  -2085806316, 339215551,   -1941713488, -2057274773,
      1140599006,  654007477,   -1965774859, -799119959,  1377821961,
      813335216,   130319061,   1473989864,  -2085806316};
  const uint32_t u32_src_m2[] = {
      2839631618, 3369629408, 792889355, 3177381946, 2345233770, 2096172162,
      3088374241, 1618641259, 868284847, 984913835,  89281062,   2726419517,
      2839631618, 3369629408, 792889355, 3177381946, 2345233770, 2096172162,
      3088374241, 1618641259, 868284847, 984913835,  89281062,   2726419517};
  const int32_t i32_ans_m2[] = {
      0b00001101010111100010010000111010, 0b10100101001100110001110000101001,
      0b11101001010111001101100000101111, 0b00110010010010110111010010111111,
      0b00010101010010010010011101011011, 0b11000110110100001010110111010011,
      0b11011101101111111111011111100111, 0b00011110111100110100001010011010,
      0b00001001110011001111001100110011, 0b00000001110010000000000001101010,
      0b00000001110100111000100011110000, 0b10110001000101000111110011110010,
      0b00001101010111100010010000111010, 0b10100101001100110001110000101001,
      0b11101001010111001101100000101111, 0b00110010010010110111010010111111,
      0b00010101010010010010011101011011, 0b11000110110100001010110111010011,
      0b11011101101111111111011111100111, 0b00011110111100110100001010011010,
      0b00001001110011001111001100110011, 0b00000001110010000000000001101010,
      0b00000001110100111000100011110000, 0b10110001000101000111110011110010};
  mint32m2_t i32_ts_m2 = mlce32_m2(i32_src_m2, 8 * sizeof(int32_t));
  muint32m2_t u32_ts_m2 = mlce32_m2(u32_src_m2, 8 * sizeof(uint32_t));
  mint32m2_t i32_out_m2 = mmulhsu_mm(i32_ts_m2, u32_ts_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 3 * 8, "MMULHSU.MM INT32 M2");
  // int64 * uint64
  msettype(E64, M2, BA);
  msettilemi(1);
  msettileni(4);
  const int64_t i64_src_m2[] = {
      0b0101011010000000100111011011011000000010011011100100011101111001,
      0b0101011010000000100111011011011000000010011011100100011101111001,
      0b0101011010000000100111011011011000000010011011100100011101111001,
      0b0101011010000000100111011011011000000010011011100100011101111001};
  const uint64_t u64_src_m2[] = {4, 4, 4, 4};
  const int64_t i64_ans_m2[] = {
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001,
      0b0000000000000000000000000000000000000000000000000000000000000001};
  mint64m2_t i64_ts_m2 = mlce64_m2(i64_src_m2, 4 * sizeof(int64_t));
  muint64m2_t u64_ts_m2 = mlce64_m2(u64_src_m2, 4 * sizeof(uint64_t));
  mint64m2_t i64_out_m2 = mmulhsu_mm(i64_ts_m2, u64_ts_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 4, "MMULHSU.MM INT64 M2");
}

static void test_mwmulsu_mm() {
  // M1
  msettype(E8, M1, BA);
  msettilemi(4);
  msettileni(8);
  const int8_t i8_src[] = {81,  -125, -106, -42, 98,   -43, -56, -25,
                           -50, -18,  -71,  -17, -119, 53,  69,  85,
                           50,  -80,  -18,  70,  86,   61,  -76, -97,
                           12,  90,   -124, -16, 30,   -2,  -42, 95};
  const uint8_t u8_src[] = {161, 116, 50,  52,  2,   225, 131, 114,
                            24,  55,  158, 210, 210, 180, 234, 29,
                            114, 187, 247, 229, 18,  239, 143, 90,
                            78,  56,  189, 170, 110, 88,  141, 248};
  const int16_t i16_ans[] = {13041, -14500, -5300, -2184,  196,   -9675,  -7336,
                             -2850, -1200,  -990,  -11218, -3570, -24990, 9540,
                             16146, 2465,   5700,  -14960, -4446, 16030,  1548,
                             14579, -10868, -8730, 936,    5040,  -23436, -2720,
                             3300,  -176,   -5922, 23560};
  mint8m1_t i8_ts = mlce8_m1(i8_src, 8 * sizeof(int8_t));
  muint8m1_t u8_ts = mlce8_m1(u8_src, 8 * sizeof(uint8_t));
  mint16m2_t i16_out = mwmulsu_mm(i8_ts, u8_ts);
  msettype(E16, M1, BA);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 32, "MWMULSU.MM INT8  M1");

  msettype(E16, M1, BA);
  msettilemi(5);
  msettileni(4);
  const int16_t i16_src[] = {
      3077,  26375, -20913, 7514, 17717,  -9715, -16914, -23166, -26067, -29969,
      19361, -7615, 31342,  -488, -32001, 30885, -19964, 26238,  -27401, -3596};
  const uint16_t u16_src[] = {9247,  24106, 57254, 25477, 32342, 61247, 55044,
                              63986, 25280, 58538, 60416, 24499, 29328, 43107,
                              45334, 62614, 63110, 9277,  9822,  65182};
  const int32_t i32_ans[] = {28453019,    635795750,   -1197352902, 191434178,
                             573003214,   -595014605,  -931014216,  -1482299676,
                             -658973760,  -1754325322, 1169714176,  -186559885,
                             919198176,   -21036216,   -1450733334, 1933833390,
                             -1259928040, 243409926,   -269132622,  -234394472};
  mint16m1_t i16_ts = mlce16_m1(i16_src, 4 * sizeof(int16_t));
  muint16m1_t u16_ts = mlce16_m1(u16_src, 4 * sizeof(uint16_t));
  mint32m2_t i32_out = mwmulsu_mm(i16_ts, u16_ts);
  msettype(E32, M1, BA);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 20, "MWMULSU.MM INT16 M1");

  msettype(E32, M1, BA);
  msettilemi(6);
  msettileni(2);
  const int32_t i32_src[] = {1049035274, 779198181,   -1425260016, -1229308983,
                             996581796,  824773418,   2090183694,  -261140635,
                             903166128,  -1642816567, 383060858,   1537108118};
  const uint32_t u32_src[] = {2836295085, 4186901502, 645052748,  605534020,
                              4280221783, 3169530958, 2173965526, 1835034119,
                              765949423,  495650380,  2839726671, 2692054932};
  const int64_t i64_ans[] = {
      2975373591637828290, 3262426034384567862, -919367889935323968,
      -744388410298101660, 4265591111780462268, 2614144881686474444,
      4543987293763333044, -479201975082325565, 691779574614744144,
      -814262655703845460, 1087788135078743718, 4137979490079137976};
  mint32m1_t i32_ts = mlce32_m1(i32_src, 2 * sizeof(int32_t));
  muint32m1_t u32_ts = mlce32_m1(u32_src, 2 * sizeof(uint32_t));
  mint64m2_t i64_out = mwmulsu_mm(i32_ts, u32_ts);
  msettype(E64, M1, BA);
  msce64_m(i64_out, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 12, "MWMULSU.MM INT32 M1");
  // M2
  msettype(E8, M2, BA);
  msettilemi(4);
  msettileni(32);
  const int8_t i8_src_m2[] = {
      81,   -125, -106, -42, 98,   -43,  -56,  -25,  -50,  -18, -71, -17,  -119,
      53,   69,   85,   50,  -80,  -18,  70,   86,   61,   -76, -97, 12,   90,
      -124, -16,  30,   -2,  -42,  95,   81,   -125, -106, -42, 98,  -43,  -56,
      -25,  -50,  -18,  -71, -17,  -119, 53,   69,   85,   50,  -80, -18,  70,
      86,   61,   -76,  -97, 12,   90,   -124, -16,  30,   -2,  -42, 95,   81,
      -125, -106, -42,  98,  -43,  -56,  -25,  -50,  -18,  -71, -17, -119, 53,
      69,   85,   50,   -80, -18,  70,   86,   61,   -76,  -97, 12,  90,   -124,
      -16,  30,   -2,   -42, 95,   81,   -125, -106, -42,  98,  -43, -56,  -25,
      -50,  -18,  -71,  -17, -119, 53,   69,   85,   50,   -80, -18, 70,   86,
      61,   -76,  -97,  12,  90,   -124, -16,  30,   -2,   -42, 95};
  const uint8_t u8_src_m2[] = {
      161, 116, 50,  52,  2,   225, 131, 114, 24,  55,  158, 210, 210, 180, 234,
      29,  114, 187, 247, 229, 18,  239, 143, 90,  78,  56,  189, 170, 110, 88,
      141, 248, 161, 116, 50,  52,  2,   225, 131, 114, 24,  55,  158, 210, 210,
      180, 234, 29,  114, 187, 247, 229, 18,  239, 143, 90,  78,  56,  189, 170,
      110, 88,  141, 248, 161, 116, 50,  52,  2,   225, 131, 114, 24,  55,  158,
      210, 210, 180, 234, 29,  114, 187, 247, 229, 18,  239, 143, 90,  78,  56,
      189, 170, 110, 88,  141, 248, 161, 116, 50,  52,  2,   225, 131, 114, 24,
      55,  158, 210, 210, 180, 234, 29,  114, 187, 247, 229, 18,  239, 143, 90,
      78,  56,  189, 170, 110, 88,  141, 248};
  const int16_t i16_ans_m4[] = {
      13041,  -14500, -5300,  -2184,  196,    -9675,  -7336,  -2850,  -1200,
      -990,   -11218, -3570,  -24990, 9540,   16146,  2465,   5700,   -14960,
      -4446,  16030,  1548,   14579,  -10868, -8730,  936,    5040,   -23436,
      -2720,  3300,   -176,   -5922,  23560,  13041,  -14500, -5300,  -2184,
      196,    -9675,  -7336,  -2850,  -1200,  -990,   -11218, -3570,  -24990,
      9540,   16146,  2465,   5700,   -14960, -4446,  16030,  1548,   14579,
      -10868, -8730,  936,    5040,   -23436, -2720,  3300,   -176,   -5922,
      23560,  13041,  -14500, -5300,  -2184,  196,    -9675,  -7336,  -2850,
      -1200,  -990,   -11218, -3570,  -24990, 9540,   16146,  2465,   5700,
      -14960, -4446,  16030,  1548,   14579,  -10868, -8730,  936,    5040,
      -23436, -2720,  3300,   -176,   -5922,  23560,  13041,  -14500, -5300,
      -2184,  196,    -9675,  -7336,  -2850,  -1200,  -990,   -11218, -3570,
      -24990, 9540,   16146,  2465,   5700,   -14960, -4446,  16030,  1548,
      14579,  -10868, -8730,  936,    5040,   -23436, -2720,  3300,   -176,
      -5922,  23560};
  mint8m2_t i8_ts_m2 = mlce8_m2(i8_src_m2, 32 * sizeof(int8_t));
  muint8m2_t u8_ts_m2 = mlce8_m2(u8_src_m2, 32 * sizeof(uint8_t));
  mint16m4_t i16_out_m4 = mwmulsu_mm(i8_ts_m2, u8_ts_m2);
  msettype(E16, M4, BA);
  msettileni(32);
  msce16_m(i16_out_m4, i16_buffer, 32 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 4 * 32, "MWMULSU.MM INT8  M2");

  msettype(E16, M2, BA);
  msettilemi(5);
  msettileni(16);
  const int16_t i16_src_m2[] = {
      3077,  26375, -20913, 7514, 17717,  -9715, -16914, -23166, -26067, -29969,
      19361, -7615, 31342,  -488, -32001, 30885, -19964, 26238,  -27401, -3596,
      3077,  26375, -20913, 7514, 17717,  -9715, -16914, -23166, -26067, -29969,
      19361, -7615, 31342,  -488, -32001, 30885, -19964, 26238,  -27401, -3596,
      3077,  26375, -20913, 7514, 17717,  -9715, -16914, -23166, -26067, -29969,
      19361, -7615, 31342,  -488, -32001, 30885, -19964, 26238,  -27401, -3596,
      3077,  26375, -20913, 7514, 17717,  -9715, -16914, -23166, -26067, -29969,
      19361, -7615, 31342,  -488, -32001, 30885, -19964, 26238,  -27401, -3596};
  const uint16_t u16_src_m2[] = {
      9247,  24106, 57254, 25477, 32342, 61247, 55044, 63986, 25280, 58538,
      60416, 24499, 29328, 43107, 45334, 62614, 63110, 9277,  9822,  65182,
      9247,  24106, 57254, 25477, 32342, 61247, 55044, 63986, 25280, 58538,
      60416, 24499, 29328, 43107, 45334, 62614, 63110, 9277,  9822,  65182,
      9247,  24106, 57254, 25477, 32342, 61247, 55044, 63986, 25280, 58538,
      60416, 24499, 29328, 43107, 45334, 62614, 63110, 9277,  9822,  65182,
      9247,  24106, 57254, 25477, 32342, 61247, 55044, 63986, 25280, 58538,
      60416, 24499, 29328, 43107, 45334, 62614, 63110, 9277,  9822,  65182};
  const int32_t i32_ans_m4[] = {
      28453019,   635795750,   -1197352902, 191434178,  573003214,
      -595014605, -931014216,  -1482299676, -658973760, -1754325322,
      1169714176, -186559885,  919198176,   -21036216,  -1450733334,
      1933833390, -1259928040, 243409926,   -269132622, -234394472,
      28453019,   635795750,   -1197352902, 191434178,  573003214,
      -595014605, -931014216,  -1482299676, -658973760, -1754325322,
      1169714176, -186559885,  919198176,   -21036216,  -1450733334,
      1933833390, -1259928040, 243409926,   -269132622, -234394472,
      28453019,   635795750,   -1197352902, 191434178,  573003214,
      -595014605, -931014216,  -1482299676, -658973760, -1754325322,
      1169714176, -186559885,  919198176,   -21036216,  -1450733334,
      1933833390, -1259928040, 243409926,   -269132622, -234394472,
      28453019,   635795750,   -1197352902, 191434178,  573003214,
      -595014605, -931014216,  -1482299676, -658973760, -1754325322,
      1169714176, -186559885,  919198176,   -21036216,  -1450733334,
      1933833390, -1259928040, 243409926,   -269132622, -234394472};
  mint16m2_t i16_ts_m2 = mlce16_m2(i16_src_m2, 16 * sizeof(int16_t));
  muint16m2_t u16_ts_m2 = mlce16_m2(u16_src_m2, 16 * sizeof(uint16_t));
  mint32m4_t i32_out_m4 = mwmulsu_mm(i16_ts_m2, u16_ts_m2);
  msettype(E32, M4, BA);
  msettileni(16);
  msce32_m(i32_out_m4, i32_buffer, 16 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 5 * 16, "MWMULSU.MM INT16 M2");

  msettype(E32, M2, BA);
  msettilemi(6);
  msettileni(8);
  const int32_t i32_src_m2[] = {
      1049035274, 779198181,  -1425260016, -1229308983, 996581796, 824773418,
      2090183694, -261140635, 903166128,   -1642816567, 383060858, 1537108118,
      1049035274, 779198181,  -1425260016, -1229308983, 996581796, 824773418,
      2090183694, -261140635, 903166128,   -1642816567, 383060858, 1537108118,
      1049035274, 779198181,  -1425260016, -1229308983, 996581796, 824773418,
      2090183694, -261140635, 903166128,   -1642816567, 383060858, 1537108118,
      1049035274, 779198181,  -1425260016, -1229308983, 996581796, 824773418,
      2090183694, -261140635, 903166128,   -1642816567, 383060858, 1537108118};
  const uint32_t u32_src_m2[] = {
      2836295085, 4186901502, 645052748, 605534020, 4280221783, 3169530958,
      2173965526, 1835034119, 765949423, 495650380, 2839726671, 2692054932,
      2836295085, 4186901502, 645052748, 605534020, 4280221783, 3169530958,
      2173965526, 1835034119, 765949423, 495650380, 2839726671, 2692054932,
      2836295085, 4186901502, 645052748, 605534020, 4280221783, 3169530958,
      2173965526, 1835034119, 765949423, 495650380, 2839726671, 2692054932,
      2836295085, 4186901502, 645052748, 605534020, 4280221783, 3169530958,
      2173965526, 1835034119, 765949423, 495650380, 2839726671, 2692054932};
  const int64_t i64_ans_m4[] = {
      2975373591637828290, 3262426034384567862, -919367889935323968,
      -744388410298101660, 4265591111780462268, 2614144881686474444,
      4543987293763333044, -479201975082325565, 691779574614744144,
      -814262655703845460, 1087788135078743718, 4137979490079137976,
      2975373591637828290, 3262426034384567862, -919367889935323968,
      -744388410298101660, 4265591111780462268, 2614144881686474444,
      4543987293763333044, -479201975082325565, 691779574614744144,
      -814262655703845460, 1087788135078743718, 4137979490079137976,
      2975373591637828290, 3262426034384567862, -919367889935323968,
      -744388410298101660, 4265591111780462268, 2614144881686474444,
      4543987293763333044, -479201975082325565, 691779574614744144,
      -814262655703845460, 1087788135078743718, 4137979490079137976,
      2975373591637828290, 3262426034384567862, -919367889935323968,
      -744388410298101660, 4265591111780462268, 2614144881686474444,
      4543987293763333044, -479201975082325565, 691779574614744144,
      -814262655703845460, 1087788135078743718, 4137979490079137976};
  mint32m2_t i32_ts_m2 = mlce32_m2(i32_src_m2, 8 * sizeof(int32_t));
  muint32m2_t u32_ts_m2 = mlce32_m2(u32_src_m2, 8 * sizeof(uint32_t));
  mint64m4_t i64_out_m4 = mwmulsu_mm(i32_ts_m2, u32_ts_m2);
  msettype(E64, M4, BA);
  msettileni(8);
  msce64_m(i64_out_m4, i64_buffer, 8 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 6 * 8, "MWMULSU.MM INT32 M2");
}

static void test_mfwmul_mm() {
  // M1
  msettype(E16, M1, BA);
  msettilemi(7);
  msettileni(4);
  const fp16_t fp16_src1[] = {0.4595, -9.24,  -7.047, -3.314, 8.51,   -7.375,
                              -1.653, 4.645,  5.86,   1.132,  -8.04,  2.58,
                              0.282,  3.41,   8.59,   -7.66,  -6.297, -9.59,
                              -1.441, -1.478, 5.746,  2.494,  0.6343, -8.2,
                              -8.484, -1.588, -1.971, -7.164};
  const fp16_t fp16_src2[] = {0.388,  -9.69,  5.16,    6.824,  -9.44,  -3.945,
                              -4.34,  -0.612, -3.656,  0.926,  3.701,  9.06,
                              6.027,  1.647,  -5.09,   -6.883, 3.965,  -2.215,
                              0.4785, -2.195, -5.297,  2.088,  -1.712, -1.036,
                              0.631,  -3.057, -0.9863, -0.8633};
  const fp32_t fp32_ans[] = {
      0.17825492, 89.50078,   -36.359837, -22.612082, -80.24797,  29.101948,
      7.175198,   -2.8419924, -21.422153, 1.0476127,  -29.743399, 23.393742,
      1.7000312,  5.61973,    -43.7299,   52.710747,  -24.971363, 21.24706,
      -0.6898154, 3.2416832,  -30.443075, 5.2113233,  -1.0851928, 8.500949,
      -5.349871,  4.852774,   1.943693,   6.1825542};
  mfloat16m1_t fp16_ts1 = mlce16_m1(fp16_src1, 4 * sizeof(fp16_t));
  mfloat16m1_t fp16_ts2 = mlce16_m1(fp16_src2, 4 * sizeof(fp16_t));
  mfloat32m2_t fp32_out = mfwmul_mm(fp16_ts1, fp16_ts2);
  msettype(E32, M1, BA);
  msce32_m(fp32_out, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_LAX_EQ(fp32_ans, fp32_buffer, 28, "MFWMUL.MM FP16  M1");

  msettype(E32, M1, BA);
  msettilemi(8);
  msettileni(2);
  const fp32_t fp32_src1[] = {-73.76764,  -19.170967, -20.295944, -49.039486,
                              -63.93277,  -2.6433468, -82.258415, 29.136173,
                              -76.619675, -9.5224285, -23.812088, -89.47157,
                              -27.844194, -13.299284, 67.63565,   1.3703527};
  const fp32_t fp32_src2[] = {-50.373806, -86.82979,  -96.81899,  -67.64697,
                              33.81337,   12.368838,  -21.720945, -26.63956,
                              55.856514,  -82.088776, 23.529867,  65.785614,
                              68.95293,   69.263954,  0.47535095, 81.81931};
  const fp64_t fp64_ans[] = {
      3715.95660429,  1664.61108047, 1965.03298794, 3317.37260176,
      -2161.78242917, -32.69512918,  1786.73063698, -776.17486505,
      -4279.70780772, 781.68449761,  -560.29527171, -5885.94213033,
      -1919.93865321, -921.16098631, 32.15066937,   112.1213205};
  mfloat32m1_t fp32_ts1 = mlce32_m1(fp32_src1, 2 * sizeof(fp32_t));
  mfloat32m1_t fp32_ts2 = mlce32_m1(fp32_src2, 2 * sizeof(fp32_t));
  mfloat64m2_t fp64_out = mfwmul_mm(fp32_ts1, fp32_ts2);
  msettype(E64, M1, BA);
  msce64_m(fp64_out, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_LAX_EQ(fp64_ans, fp64_buffer, 16, "MFWMUL.MM FP32  M1");
  // M1
  msettype(E16, M2, BA);
  msettilemi(7);
  msettileni(16);
  const fp16_t fp16_src1_m2[] = {
      0.4595, -9.24,  -7.047, -3.314, 8.51,   -7.375, -1.653, 4.645,  5.86,
      1.132,  -8.04,  2.58,   0.282,  3.41,   8.59,   -7.66,  -6.297, -9.59,
      -1.441, -1.478, 5.746,  2.494,  0.6343, -8.2,   -8.484, -1.588, -1.971,
      -7.164, 0.4595, -9.24,  -7.047, -3.314, 8.51,   -7.375, -1.653, 4.645,
      5.86,   1.132,  -8.04,  2.58,   0.282,  3.41,   8.59,   -7.66,  -6.297,
      -9.59,  -1.441, -1.478, 5.746,  2.494,  0.6343, -8.2,   -8.484, -1.588,
      -1.971, -7.164, 0.4595, -9.24,  -7.047, -3.314, 8.51,   -7.375, -1.653,
      4.645,  5.86,   1.132,  -8.04,  2.58,   0.282,  3.41,   8.59,   -7.66,
      -6.297, -9.59,  -1.441, -1.478, 5.746,  2.494,  0.6343, -8.2,   -8.484,
      -1.588, -1.971, -7.164, 0.4595, -9.24,  -7.047, -3.314, 8.51,   -7.375,
      -1.653, 4.645,  5.86,   1.132,  -8.04,  2.58,   0.282,  3.41,   8.59,
      -7.66,  -6.297, -9.59,  -1.441, -1.478, 5.746,  2.494,  0.6343, -8.2,
      -8.484, -1.588, -1.971, -7.164};
  const fp16_t fp16_src2_m2[] = {
      0.388,  -9.69,  5.16,    6.824,   -9.44,  -3.945, -4.34,   -0.612,
      -3.656, 0.926,  3.701,   9.06,    6.027,  1.647,  -5.09,   -6.883,
      3.965,  -2.215, 0.4785,  -2.195,  -5.297, 2.088,  -1.712,  -1.036,
      0.631,  -3.057, -0.9863, -0.8633, 0.388,  -9.69,  5.16,    6.824,
      -9.44,  -3.945, -4.34,   -0.612,  -3.656, 0.926,  3.701,   9.06,
      6.027,  1.647,  -5.09,   -6.883,  3.965,  -2.215, 0.4785,  -2.195,
      -5.297, 2.088,  -1.712,  -1.036,  0.631,  -3.057, -0.9863, -0.8633,
      0.388,  -9.69,  5.16,    6.824,   -9.44,  -3.945, -4.34,   -0.612,
      -3.656, 0.926,  3.701,   9.06,    6.027,  1.647,  -5.09,   -6.883,
      3.965,  -2.215, 0.4785,  -2.195,  -5.297, 2.088,  -1.712,  -1.036,
      0.631,  -3.057, -0.9863, -0.8633, 0.388,  -9.69,  5.16,    6.824,
      -9.44,  -3.945, -4.34,   -0.612,  -3.656, 0.926,  3.701,   9.06,
      6.027,  1.647,  -5.09,   -6.883,  3.965,  -2.215, 0.4785,  -2.195,
      -5.297, 2.088,  -1.712,  -1.036,  0.631,  -3.057, -0.9863, -0.8633};
  const fp32_t fp32_ans_m4[] = {
      0.17825492, 89.50078,   -36.359837, -22.612082, -80.24797,  29.101948,
      7.175198,   -2.8419924, -21.422153, 1.0476127,  -29.743399, 23.393742,
      1.7000312,  5.61973,    -43.7299,   52.710747,  -24.971363, 21.24706,
      -0.6898154, 3.2416832,  -30.443075, 5.2113233,  -1.0851928, 8.500949,
      -5.349871,  4.852774,   1.943693,   6.1825542,  0.17825492, 89.50078,
      -36.359837, -22.612082, -80.24797,  29.101948,  7.175198,   -2.8419924,
      -21.422153, 1.0476127,  -29.743399, 23.393742,  1.7000312,  5.61973,
      -43.7299,   52.710747,  -24.971363, 21.24706,   -0.6898154, 3.2416832,
      -30.443075, 5.2113233,  -1.0851928, 8.500949,   -5.349871,  4.852774,
      1.943693,   6.1825542,  0.17825492, 89.50078,   -36.359837, -22.612082,
      -80.24797,  29.101948,  7.175198,   -2.8419924, -21.422153, 1.0476127,
      -29.743399, 23.393742,  1.7000312,  5.61973,    -43.7299,   52.710747,
      -24.971363, 21.24706,   -0.6898154, 3.2416832,  -30.443075, 5.2113233,
      -1.0851928, 8.500949,   -5.349871,  4.852774,   1.943693,   6.1825542,
      0.17825492, 89.50078,   -36.359837, -22.612082, -80.24797,  29.101948,
      7.175198,   -2.8419924, -21.422153, 1.0476127,  -29.743399, 23.393742,
      1.7000312,  5.61973,    -43.7299,   52.710747,  -24.971363, 21.24706,
      -0.6898154, 3.2416832,  -30.443075, 5.2113233,  -1.0851928, 8.500949,
      -5.349871,  4.852774,   1.943693,   6.1825542};
  mfloat16m2_t fp16_ts1_m2 = mlce16_m2(fp16_src1_m2, 16 * sizeof(fp16_t));
  mfloat16m2_t fp16_ts2_m2 = mlce16_m2(fp16_src2_m2, 16 * sizeof(fp16_t));
  mfloat32m4_t fp32_out_m4 = mfwmul_mm(fp16_ts1_m2, fp16_ts2_m2);
  msettype(E32, M4, BA);
  msettileni(16);
  msce32_m(fp32_out_m4, fp32_buffer, 16 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_LAX_EQ(fp32_ans_m4, fp32_buffer, 7 * 16,
                           "MFWMUL.MM FP16  M2");

  msettype(E32, M2, BA);
  msettilemi(8);
  msettileni(8);
  const fp32_t fp32_src1_m2[] = {
      -73.76764,  -19.170967, -20.295944, -49.039486, -63.93277,  -2.6433468,
      -82.258415, 29.136173,  -76.619675, -9.5224285, -23.812088, -89.47157,
      -27.844194, -13.299284, 67.63565,   1.3703527,  -73.76764,  -19.170967,
      -20.295944, -49.039486, -63.93277,  -2.6433468, -82.258415, 29.136173,
      -76.619675, -9.5224285, -23.812088, -89.47157,  -27.844194, -13.299284,
      67.63565,   1.3703527,  -73.76764,  -19.170967, -20.295944, -49.039486,
      -63.93277,  -2.6433468, -82.258415, 29.136173,  -76.619675, -9.5224285,
      -23.812088, -89.47157,  -27.844194, -13.299284, 67.63565,   1.3703527,
      -73.76764,  -19.170967, -20.295944, -49.039486, -63.93277,  -2.6433468,
      -82.258415, 29.136173,  -76.619675, -9.5224285, -23.812088, -89.47157,
      -27.844194, -13.299284, 67.63565,   1.3703527};
  const fp32_t fp32_src2_m2[] = {
      -50.373806, -86.82979,  -96.81899,  -67.64697,  33.81337,   12.368838,
      -21.720945, -26.63956,  55.856514,  -82.088776, 23.529867,  65.785614,
      68.95293,   69.263954,  0.47535095, 81.81931,   -50.373806, -86.82979,
      -96.81899,  -67.64697,  33.81337,   12.368838,  -21.720945, -26.63956,
      55.856514,  -82.088776, 23.529867,  65.785614,  68.95293,   69.263954,
      0.47535095, 81.81931,   -50.373806, -86.82979,  -96.81899,  -67.64697,
      33.81337,   12.368838,  -21.720945, -26.63956,  55.856514,  -82.088776,
      23.529867,  65.785614,  68.95293,   69.263954,  0.47535095, 81.81931,
      -50.373806, -86.82979,  -96.81899,  -67.64697,  33.81337,   12.368838,
      -21.720945, -26.63956,  55.856514,  -82.088776, 23.529867,  65.785614,
      68.95293,   69.263954,  0.47535095, 81.81931};
  const fp64_t fp64_ans_m4[] = {
      3715.95660429,  1664.61108047, 1965.03298794, 3317.37260176,
      -2161.78242917, -32.69512918,  1786.73063698, -776.17486505,
      -4279.70780772, 781.68449761,  -560.29527171, -5885.94213033,
      -1919.93865321, -921.16098631, 32.15066937,   112.1213205,
      3715.95660429,  1664.61108047, 1965.03298794, 3317.37260176,
      -2161.78242917, -32.69512918,  1786.73063698, -776.17486505,
      -4279.70780772, 781.68449761,  -560.29527171, -5885.94213033,
      -1919.93865321, -921.16098631, 32.15066937,   112.1213205,
      3715.95660429,  1664.61108047, 1965.03298794, 3317.37260176,
      -2161.78242917, -32.69512918,  1786.73063698, -776.17486505,
      -4279.70780772, 781.68449761,  -560.29527171, -5885.94213033,
      -1919.93865321, -921.16098631, 32.15066937,   112.1213205,
      3715.95660429,  1664.61108047, 1965.03298794, 3317.37260176,
      -2161.78242917, -32.69512918,  1786.73063698, -776.17486505,
      -4279.70780772, 781.68449761,  -560.29527171, -5885.94213033,
      -1919.93865321, -921.16098631, 32.15066937,   112.1213205};
  mfloat32m2_t fp32_ts1_m2 = mlce32_m2(fp32_src1_m2, 8 * sizeof(fp32_t));
  mfloat32m2_t fp32_ts2_m2 = mlce32_m2(fp32_src2_m2, 8 * sizeof(fp32_t));
  mfloat64m4_t fp64_out_m4 = mfwmul_mm(fp32_ts1_m2, fp32_ts2_m2);
  msettype(E64, M4, BA);
  msettileni(8);
  msce64_m(fp64_out_m4, fp64_buffer, 8 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_LAX_EQ(fp64_ans_m4, fp64_buffer, 8 * 8,
                           "MFWMUL.MM FP32  M2");
}

int main() {
  test_mfmul_mm();
  test_msmul_mm();
  test_msmulu_mm();
  test_msmulsu_mm();
  test_mwmul_mm();
  test_mwmulu_mm();
  test_mmul_mm();
  test_mmulh_mm();
  test_mmulhu_mm();
  test_mmulhsu_mm();
  test_mwmulsu_mm();
  test_mfwmul_mm();
  return 0;
}
#include "utils.h"
#include <riscv_matrix.h>

static void test_mminu_mm() {
  // M1
  // uint8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(16);
  const uint8_t u8_src1[] = {27,  212, 189, 215, 78,  98,  77,  13,
                             170, 32,  51,  90,  8,   44,  178, 186,
                             140, 77,  110, 123, 246, 141, 156, 68,
                             114, 218, 234, 245, 96,  136, 10,  68};
  const uint8_t u8_src2[] = {82,  60,  148, 134, 72,  87,  144, 213,
                             207, 251, 248, 29,  24,  21,  184, 124,
                             204, 84,  205, 65,  216, 130, 133, 94,
                             143, 44,  132, 187, 224, 237, 21,  135};
  const uint8_t u8_ans[] = {27,  60, 148, 134, 72,  87,  77, 13,  170, 32,  51,
                            29,  8,  21,  178, 124, 140, 77, 110, 65,  216, 130,
                            133, 68, 114, 44,  132, 187, 96, 136, 10,  68};
  muint8m1_t u8_ts1 = mlce8_m1(u8_src1, 16 * sizeof(uint8_t));
  muint8m1_t u8_ts2 = mlce8_m1(u8_src2, 16 * sizeof(uint8_t));
  muint8m1_t u8_out = mminu_mm(u8_ts1, u8_ts2);
  msce8_m(u8_out, u8_buffer, 16 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans, u8_buffer, 32, " MMINU.MM UINT8  M1");
  // uint16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const uint16_t u16_src1[] = {34858, 4102,  7545,  41940, 57043, 28554,
                               57221, 22151, 36851, 59672, 416,   65496,
                               16832, 15590, 43329, 412,   43171, 3617,
                               24881, 13394, 37651, 9884,  4468,  64120};
  const uint16_t u16_src2[] = {8362,  47921, 29737, 64500, 23288, 6195,
                               64056, 22347, 43292, 4402,  51762, 63371,
                               27786, 35950, 16849, 52216, 41156, 9746,
                               26487, 44585, 47477, 21734, 57656, 20868};
  const uint16_t u16_ans[] = {8362,  4102,  7545,  41940, 23288, 6195,
                              57221, 22151, 36851, 4402,  416,   63371,
                              16832, 15590, 16849, 412,   41156, 3617,
                              24881, 13394, 37651, 9884,  4468,  20868};
  muint16m1_t u16_ts1 = mlce16_m1(u16_src1, 8 * sizeof(uint16_t));
  muint16m1_t u16_ts2 = mlce16_m1(u16_src2, 8 * sizeof(uint16_t));
  muint16m1_t u16_out = mminu_mm(u16_ts1, u16_ts2);
  msce16_m(u16_out, u16_buffer, 8 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans, u16_buffer, 24, " MMINU.MM UINT16 M1");
  // uint32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const uint32_t u32_src1[] = {3495050049, 1387982403, 2172214974, 2990332959,
                               3998018228, 13027523,   2797352558, 632565744,
                               3279795285, 2997739086, 3631775073, 1815396897,
                               3867052938, 704347622,  1085608687, 4049319603};
  const uint32_t u32_src2[] = {305799022,  2219336534, 1380469068, 3151103330,
                               769612844,  2954137341, 1112742621, 929240294,
                               4034559004, 3364695020, 2793852287, 1478302877,
                               1527238514, 983506422,  4167106143, 265842327};
  const uint32_t u32_ans[] = {305799022,  1387982403, 1380469068, 2990332959,
                              769612844,  13027523,   1112742621, 632565744,
                              3279795285, 2997739086, 2793852287, 1478302877,
                              1527238514, 704347622,  1085608687, 265842327};
  muint32m1_t u32_ts1 = mlce32_m1(u32_src1, 4 * sizeof(uint32_t));
  muint32m1_t u32_ts2 = mlce32_m1(u32_src2, 4 * sizeof(uint32_t));
  muint32m1_t u32_out = mminu_mm(u32_ts1, u32_ts2);
  msce32_m(u32_out, u32_buffer, 4 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans, u32_buffer, 16, " MMINU.MM UINT32 M1");
  // uint64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const uint64_t u64_src1[] = {1937612067936275310, 1884261447090562899,
                               4734092163567735431, 5186480340763522304,
                               7515858241899004,    2061484837582013069,
                               7724103648163176804, 1696305951305371852,
                               34055467749968418,   1363565001278274169};
  const uint64_t u64_src2[] = {1174305231616085647, 3577887544765768677,
                               3504883439547175557, 6748687911624696754,
                               3940901879091424531, 5028632885272710487,
                               5945098395687868091, 2511788925694439911,
                               5014527854849558106, 5582583622506769272};
  const uint64_t u64_ans[] = {1174305231616085647, 1884261447090562899,
                              3504883439547175557, 5186480340763522304,
                              7515858241899004,    2061484837582013069,
                              5945098395687868091, 1696305951305371852,
                              34055467749968418,   1363565001278274169};
  muint64m1_t u64_ts1 = mlce64_m1(u64_src1, 2 * sizeof(uint64_t));
  muint64m1_t u64_ts2 = mlce64_m1(u64_src2, 2 * sizeof(uint64_t));
  muint64m1_t u64_out = mminu_mm(u64_ts1, u64_ts2);
  msce64_m(u64_out, u64_buffer, 2 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans, u64_buffer, 10, " MMINU.MM UINT64 M1");
  // M2
  // uint8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const uint8_t u8_src1_m2[] = {
      187, 116, 108, 119, 195, 168, 49,  226, 138, 192, 242, 69,  232,
      220, 180, 175, 62,  135, 174, 11,  27,  182, 130, 142, 138, 76,
      126, 130, 207, 93,  116, 88,  74,  233, 90,  140, 178, 184, 47,
      132, 123, 234, 97,  157, 163, 212, 172, 172, 218, 10,  24,  46,
      247, 190, 178, 154, 90,  156, 115, 67,  111, 140, 152, 195};
  const uint8_t u8_src2_m2[] = {
      231, 65,  39,  23,  161, 253, 171, 121, 181, 0,   76,  153, 202,
      24,  81,  145, 169, 103, 12,  87,  87,  98,  226, 112, 115, 161,
      202, 7,   137, 159, 65,  197, 72,  179, 244, 32,  242, 239, 82,
      20,  106, 128, 26,  202, 172, 40,  232, 178, 254, 165, 145, 241,
      151, 221, 208, 99,  122, 217, 221, 226, 173, 47,  145, 243};
  const uint8_t u8_ans_m2[] = {
      187, 65,  39,  23, 161, 168, 49,  121, 138, 0,   76,  69,  202,
      24,  81,  145, 62, 103, 12,  11,  27,  98,  130, 112, 115, 76,
      126, 7,   137, 93, 65,  88,  72,  179, 90,  32,  178, 184, 47,
      20,  106, 128, 26, 157, 163, 40,  172, 172, 218, 10,  24,  46,
      151, 190, 178, 99, 90,  156, 115, 67,  111, 47,  145, 195};
  muint8m2_t u8_ts1_m2 = mlce8_m2(u8_src1_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_ts2_m2 = mlce8_m2(u8_src2_m2, 32 * sizeof(uint8_t));
  muint8m2_t u8_out_m2 = mminu_mm(u8_ts1_m2, u8_ts2_m2);
  msce8_m(u8_out_m2, u8_buffer, 32 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m2, u8_buffer, 2 * 32, "MMINU.MM UINT8  M2");
  // uint16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const uint16_t u16_src1_m2[] = {
      65220, 35295, 46627, 14872, 20750, 3502,  10679, 6562,  48109, 39595,
      38141, 30605, 24017, 11358, 51492, 31864, 38484, 32414, 54926, 39404,
      36328, 41898, 48705, 62212, 6888,  3707,  49176, 33695, 42147, 12427,
      30285, 35446, 31200, 20647, 60769, 34400, 35805, 47283, 11655, 44486,
      17380, 34766, 11914, 12016, 13968, 35535, 14921, 58103};
  const uint16_t u16_src2_m2[] = {
      11713, 54969, 53837, 22948, 26349, 20504, 12589, 37100, 22493, 24409,
      22013, 26968, 47168, 2153,  13385, 4795,  56361, 52387, 64724, 16956,
      19796, 51436, 30674, 13433, 40309, 62583, 20339, 35231, 7972,  35053,
      30752, 49704, 43389, 24303, 17396, 58927, 40599, 35106, 10772, 65431,
      43998, 63901, 20205, 42262, 39248, 19915, 51200, 53701};
  const uint16_t u16_ans_m2[] = {
      11713, 35295, 46627, 14872, 20750, 3502,  10679, 6562,  22493, 24409,
      22013, 26968, 24017, 2153,  13385, 4795,  38484, 32414, 54926, 16956,
      19796, 41898, 30674, 13433, 6888,  3707,  20339, 33695, 7972,  12427,
      30285, 35446, 31200, 20647, 17396, 34400, 35805, 35106, 10772, 44486,
      17380, 34766, 11914, 12016, 13968, 19915, 14921, 53701};
  muint16m2_t u16_ts1_m2 = mlce16_m2(u16_src1_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_ts2_m2 = mlce16_m2(u16_src2_m2, 16 * sizeof(uint16_t));
  muint16m2_t u16_out_m2 = mminu_mm(u16_ts1_m2, u16_ts2_m2);
  msce16_m(u16_out_m2, u16_buffer, 16 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m2, u16_buffer, 3 * 16, "MMINU.MM UINT16 M2");
  // uint32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const uint32_t u32_src1_m2[] = {
      4115827841, 1833085999, 1351195188, 1851267885, 1019872067, 1387781679,
      3146890021, 980666707,  3594645249, 1449115936, 2254398293, 4012448103,
      1151308482, 2739198863, 2329217277, 2477787294, 1351983922, 4171965879,
      822241520,  2751295989, 2017411732, 3601960454, 844287386,  1157109619,
      3635068634, 2022099810, 2238584863, 231633695,  4267523911, 2965093491,
      47321949,   1152020477};
  const uint32_t u32_src2_m2[] = {
      1274823276, 716581072,  1748647877, 241338055,  2716174323, 3583943165,
      2463667780, 3813265453, 3513197341, 2580264090, 3425119348, 1213782916,
      3184610865, 4266016910, 3642230681, 1692779003, 317285830,  4187127210,
      2692332334, 1299799264, 3069438363, 146216552,  3010065339, 2777439231,
      3460697823, 1147336047, 911706477,  2127545220, 1310308909, 1499480682,
      602289694,  1109187894};
  const uint32_t u32_ans_m2[] = {
      1274823276, 716581072,  1351195188, 241338055,  1019872067, 1387781679,
      2463667780, 980666707,  3513197341, 1449115936, 2254398293, 1213782916,
      1151308482, 2739198863, 2329217277, 1692779003, 317285830,  4171965879,
      822241520,  1299799264, 2017411732, 146216552,  844287386,  1157109619,
      3460697823, 1147336047, 911706477,  231633695,  1310308909, 1499480682,
      47321949,   1109187894};
  muint32m2_t u32_ts1_m2 = mlce32_m2(u32_src1_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_ts2_m2 = mlce32_m2(u32_src2_m2, 8 * sizeof(uint32_t));
  muint32m2_t u32_out_m2 = mminu_mm(u32_ts1_m2, u32_ts2_m2);
  msce32_m(u32_out_m2, u32_buffer, 8 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m2, u32_buffer, 4 * 8, "MMINU.MM UINT32 M2");
  // uint64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const uint64_t u64_src1_m2[] = {
      3043536737206385436,  17499021319215822047, 18262966542404642672,
      7359560131337022890,  12074546182541034578, 6963037908597169850,
      14911156213092827998, 11251014885149046792, 12420425608392631553,
      15729534586010113993, 2214184223875278636,  15605924375962241560,
      3713635696937372759,  448508971388776428,   14396030825201642,
      17110490277710035117, 12912730283095318655, 4156796982026590383,
      17405183527898937121, 8848810760308075570};
  const uint64_t u64_src2_m2[] = {
      9718028060847824364,  4850767228312871815,  4764890916442424316,
      11881380415057931726, 3639525987290613223,  8265207550615179117,
      866811176093662334,   13108656090051658047, 8014146545651960893,
      7660318537961707797,  8759910915544580529,  12210093162514819140,
      9872932166405823874,  9493799709234456298,  15803654135573895121,
      11631115678235013875, 3221414370755588563,  7019876216603137365,
      1326453296088294963,  14090311705189347250};
  const uint64_t u64_ans_m2[] = {
      3043536737206385436,  4850767228312871815,  4764890916442424316,
      7359560131337022890,  3639525987290613223,  6963037908597169850,
      866811176093662334,   11251014885149046792, 8014146545651960893,
      7660318537961707797,  2214184223875278636,  12210093162514819140,
      3713635696937372759,  448508971388776428,   14396030825201642,
      11631115678235013875, 3221414370755588563,  4156796982026590383,
      1326453296088294963,  8848810760308075570};
  muint64m2_t u64_ts1_m2 = mlce64_m2(u64_src1_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_ts2_m2 = mlce64_m2(u64_src2_m2, 4 * sizeof(uint64_t));
  muint64m2_t u64_out_m2 = mminu_mm(u64_ts1_m2, u64_ts2_m2);
  msce64_m(u64_out_m2, u64_buffer, 4 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans_m2, u64_buffer, 5 * 4, "MMINU.MM UINT64 M2");
  // M4
  // uint8
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(33);
  const uint8_t u8_src1_m4[] = {
      133, 211, 29,  196, 118, 50,  113, 215, 64,  197, 186, 152, 200, 123,
      95,  115, 109, 95,  18,  117, 142, 214, 179, 141, 140, 222, 175, 78,
      108, 141, 224, 65,  139, 202, 96,  1,   19,  188, 210, 97,  228, 61,
      136, 182, 201, 126, 160, 21,  218, 10,  63,  120, 90,  76,  100, 44,
      206, 16,  71,  41,  179, 152, 95,  146, 77,  152};
  const uint8_t u8_src2_m4[] = {
      212, 85,  29,  209, 129, 4,   34,  117, 22, 34,  187, 144, 139, 16,
      143, 177, 155, 218, 165, 73,  188, 121, 85, 165, 88,  111, 144, 131,
      130, 149, 28,  121, 156, 2,   196, 251, 90, 42,  7,   172, 218, 165,
      183, 189, 116, 232, 55,  163, 149, 23,  64, 42,  132, 129, 87,  213,
      158, 108, 41,  50,  196, 134, 185, 215, 87, 244};
  const uint8_t u8_ans_m4[] = {
      133, 85,  29,  196, 118, 4,   34,  117, 22, 34,  186, 144, 139, 16,
      95,  115, 109, 95,  18,  73,  142, 121, 85, 141, 88,  111, 144, 78,
      108, 141, 28,  65,  139, 2,   96,  1,   19, 42,  7,   97,  218, 61,
      136, 182, 116, 126, 55,  21,  149, 10,  63, 42,  90,  76,  87,  44,
      158, 16,  41,  41,  179, 134, 95,  146, 77, 152};
  muint8m4_t u8_ts1_m4 = mlce8_m4(u8_src1_m4, 33 * sizeof(uint8_t));
  muint8m4_t u8_ts2_m4 = mlce8_m4(u8_src2_m4, 33 * sizeof(uint8_t));
  muint8m4_t u8_out_m4 = mminu_mm(u8_ts1_m4, u8_ts2_m4);
  msce8_m(u8_out_m4, u8_buffer, 33 * sizeof(uint8_t));
  EXCEPT_U8_ARRAY_EQ(u8_ans_m4, u8_buffer, 2 * 33, "MMINU.MM UINT8  M4");
  // uint16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(17);
  const uint16_t u16_src1_m4[] = {
      39259, 29477, 48050, 12726, 62395, 37313, 19757, 63113, 34838,
      8257,  2355,  40657, 43480, 6750,  62441, 28991, 21746, 46642,
      45934, 18963, 19821, 54171, 23542, 31015, 11615, 13698, 56529,
      5667,  5619,  1414,  6468,  65255, 20695, 35246, 29114, 48770,
      6442,  51203, 58981, 59002, 29740, 59964, 45796, 43523, 41732,
      8778,  64033, 23470, 54027, 19330, 4345};
  const uint16_t u16_src2_m4[] = {
      18930, 23105, 17181, 33365, 38008, 19740, 25977, 36604, 33059,
      36528, 61895, 47436, 54985, 49666, 58187, 10107, 30439, 56279,
      64884, 46470, 56522, 34026, 1326,  31682, 65337, 34585, 41843,
      42754, 13156, 39885, 22586, 7602,  57967, 23835, 21129, 16859,
      18498, 44142, 44753, 42523, 44625, 22691, 21185, 51874, 46675,
      2152,  41041, 18488, 53691, 1918,  42546};
  const uint16_t u16_ans_m4[] = {
      18930, 23105, 17181, 12726, 38008, 19740, 19757, 36604, 33059,
      8257,  2355,  40657, 43480, 6750,  58187, 10107, 21746, 46642,
      45934, 18963, 19821, 34026, 1326,  31015, 11615, 13698, 41843,
      5667,  5619,  1414,  6468,  7602,  20695, 23835, 21129, 16859,
      6442,  44142, 44753, 42523, 29740, 22691, 21185, 43523, 41732,
      2152,  41041, 18488, 53691, 1918,  4345};
  muint16m4_t u16_ts1_m4 = mlce16_m4(u16_src1_m4, 17 * sizeof(uint16_t));
  muint16m4_t u16_ts2_m4 = mlce16_m4(u16_src2_m4, 17 * sizeof(uint16_t));
  muint16m4_t u16_out_m4 = mminu_mm(u16_ts1_m4, u16_ts2_m4);
  msce16_m(u16_out_m4, u16_buffer, 17 * sizeof(uint16_t));
  EXCEPT_U16_ARRAY_EQ(u16_ans_m4, u16_buffer, 3 * 17, "MMINU.MM UINT16 M4");
  // uint32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(9);
  const uint32_t u32_src1_m4[] = {
      2134292078, 1961415389, 148872146,  2594016279, 143807169,  1400022283,
      3129085058, 2920248401, 1967777488, 1614476744, 3848506514, 2853582783,
      2508413321, 1922453195, 1802983875, 3404174847, 242629125,  1281362860,
      2820069368, 19669318,   2384704675, 1800391357, 3501843837, 3778122485,
      2150331051, 3086973438, 1717520279, 663828390,  2298658541, 3066603746,
      3893080839, 3532710411, 3054525729, 3161078117, 3733391033, 1874241610};
  const uint32_t u32_src2_m4[] = {
      3281139589, 3226682353, 2609840590, 1386748924, 1871629161, 3393482517,
      2473877328, 1804608345, 3132598243, 2687987767, 613037438,  53226724,
      3508069658, 273712670,  661370146,  4145084530, 4023604023, 2316442799,
      1520640415, 1686888,    520286316,  705529060,  302774954,  3955564345,
      278275451,  621355511,  1772316882, 2643599752, 1839814962, 129377905,
      2175772804, 2222022819, 3403930722, 3527246613, 720825331,  705995922};
  const uint32_t u32_ans_m4[] = {
      2134292078, 1961415389, 148872146,  1386748924, 143807169,  1400022283,
      2473877328, 1804608345, 1967777488, 1614476744, 613037438,  53226724,
      2508413321, 273712670,  661370146,  3404174847, 242629125,  1281362860,
      1520640415, 1686888,    520286316,  705529060,  302774954,  3778122485,
      278275451,  621355511,  1717520279, 663828390,  1839814962, 129377905,
      2175772804, 2222022819, 3054525729, 3161078117, 720825331,  705995922};
  muint32m4_t u32_ts1_m4 = mlce32_m4(u32_src1_m4, 9 * sizeof(uint32_t));
  muint32m4_t u32_ts2_m4 = mlce32_m4(u32_src2_m4, 9 * sizeof(uint32_t));
  muint32m4_t u32_out_m4 = mminu_mm(u32_ts1_m4, u32_ts2_m4);
  msce32_m(u32_out_m4, u32_buffer, 9 * sizeof(uint32_t));
  EXCEPT_U32_ARRAY_EQ(u32_ans_m4, u32_buffer, 4 * 9, "MMINU.MM UINT32 M4");
  // uint64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(5);
  const uint64_t u64_src1_m4[] = {
      12986280664718317641, 9852268758393143579,  8765949541987566208,
      2127873894190585427,  11171783287197011792, 11937692511738109934,
      15951417126081254458, 7684637889282702749,  18402714472323487435,
      6906960641792374699,  3944823271254791803,  5823647175022278482,
      14893532453344045361, 7140202000512479433,  11640966221139470924,
      13989172749718793836, 5834002477262374923,  970380485438165439,
      4803367068538820079,  14043318742343840323, 16591726557074848441,
      5405219065428663776,  6282576990325030286,  15333331005429578046,
      3832848269838110378};
  const uint64_t u64_src2_m4[] = {
      3832421670061176897,  4143353966396825132,  17989051197037923275,
      11552351004465857582, 6845164770480999430,  2421132777530287462,
      2060726712155100175,  17062859037754846920, 8029969600739469280,
      12341205614127075249, 7646163554206709881,  8551364677491049745,
      842422488031660727,   15124280677035055553, 8486637130983276371,
      15963480257302284356, 6405022162696716675,  6021046151985743906,
      13204258563586332889, 3333085749673726116,  8447822951682033702,
      7910205568764261396,  7608149089990164501,  2940750127191378988,
      9583712234527247684};
  const uint64_t u64_ans_m4[] = {
      3832421670061176897,  4143353966396825132, 8765949541987566208,
      2127873894190585427,  6845164770480999430, 2421132777530287462,
      2060726712155100175,  7684637889282702749, 8029969600739469280,
      6906960641792374699,  3944823271254791803, 5823647175022278482,
      842422488031660727,   7140202000512479433, 8486637130983276371,
      13989172749718793836, 5834002477262374923, 970380485438165439,
      4803367068538820079,  3333085749673726116, 8447822951682033702,
      5405219065428663776,  6282576990325030286, 2940750127191378988,
      3832848269838110378};
  muint64m4_t u64_ts1_m4 = mlce64_m4(u64_src1_m4, 5 * sizeof(uint64_t));
  muint64m4_t u64_ts2_m4 = mlce64_m4(u64_src2_m4, 5 * sizeof(uint64_t));
  muint64m4_t u64_out_m4 = mminu_mm(u64_ts1_m4, u64_ts2_m4);
  msce64_m(u64_out_m4, u64_buffer, 5 * sizeof(uint64_t));
  EXCEPT_U64_ARRAY_EQ(u64_ans_m4, u64_buffer, 5 * 5, "MMINU.MM UINT64 M4");
}

static void test_mmin_mm() {
  // M1
  // int8
  msettype(E8, M1, BA);
  msettilemi(2);
  msettileni(16);
  const int8_t i8_src1[] = {-71, -44, -83, 25,  95,  3,   81, 4,
                            19,  -79, 95,  90,  88,  57,  52, 72,
                            -91, -20, 104, -47, -26, -98, -7, 69,
                            -16, 104, -55, 116, 76,  91,  23, -38};
  const int8_t i8_src2[] = {99,  56,   117,  28,   53,  -96, -114, 72,
                            -76, 46,   7,    -78,  40,  84,  -64,  45,
                            -53, 62,   -104, -116, 20,  88,  39,   10,
                            37,  -116, -14,  -84,  -73, -33, 40,   -82};
  const int8_t i8_ans[] = {-71, -44,  -83,  25,   53,  -96, -114, 4,
                           -76, -79,  7,    -78,  40,  57,  -64,  45,
                           -91, -20,  -104, -116, -26, -98, -7,   10,
                           -16, -116, -55,  -84,  -73, -33, 23,   -82};
  mint8m1_t i8_ts1 = mlce8_m1(i8_src1, 16 * sizeof(int8_t));
  mint8m1_t i8_ts2 = mlce8_m1(i8_src2, 16 * sizeof(int8_t));
  mint8m1_t i8_out = mmin_mm(i8_ts1, i8_ts2);
  msce8_m(i8_out, i8_buffer, 16 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans, i8_buffer, 32, "MMIN.MM  INT8   M1");
  // int16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const int16_t i16_src1[] = {-9478, -1985,  -4763,  -32078, 6790,  -25990,
                              -272,  -20479, 18590,  15521,  18865, 16116,
                              -5509, 12626,  -26665, -11204, 10253, -7940,
                              31016, 32115,  -430,   -11422, 5827,  -1960};
  const int16_t i16_src2[] = {-14704, 30503,  -30980, -12302, 8238,  3596,
                              -22575, -13405, 16411,  6487,   7897,  -17431,
                              -30123, 1312,   8785,   20445,  32288, 26669,
                              -3698,  -1107,  -7773,  -24408, 31514, -497};
  const int16_t i16_ans[] = {-14704, -1985,  -30980, -32078, 6790,  -25990,
                             -22575, -20479, 16411,  6487,   7897,  -17431,
                             -30123, 1312,   -26665, -11204, 10253, -7940,
                             -3698,  -1107,  -7773,  -24408, 5827,  -1960};
  mint16m1_t i16_ts1 = mlce16_m1(i16_src1, 8 * sizeof(int16_t));
  mint16m1_t i16_ts2 = mlce16_m1(i16_src2, 8 * sizeof(int16_t));
  mint16m1_t i16_out = mmin_mm(i16_ts1, i16_ts2);
  msce16_m(i16_out, i16_buffer, 8 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans, i16_buffer, 24, "MMIN.MM  INT16  M1");
  // int32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const int32_t i32_src1[] = {1047423436,  1296068775, 1184072519, 1785943523,
                              1282540217,  696956657,  -771901288, -1267984653,
                              -1556848952, -653931853, -991640089, -2114580130,
                              -711640727,  75342789,   1117160398, 22034674};
  const int32_t i32_src2[] = {1173535399, 1688132819, -2128707743, 1812714383,
                              1239187401, 1707137642, -1966233568, 483564866,
                              1000028710, 1006828770, -1831500912, -1958003576,
                              419286803,  1517527201, -1627090932, -629733438};
  const int32_t i32_ans[] = {1047423436,  1296068775, -2128707743, 1785943523,
                             1239187401,  696956657,  -1966233568, -1267984653,
                             -1556848952, -653931853, -1831500912, -2114580130,
                             -711640727,  75342789,   -1627090932, -629733438};
  mint32m1_t i32_ts1 = mlce32_m1(i32_src1, 4 * sizeof(int32_t));
  mint32m1_t i32_ts2 = mlce32_m1(i32_src2, 4 * sizeof(int32_t));
  mint32m1_t i32_out = mmin_mm(i32_ts1, i32_ts2);
  msce32_m(i32_out, i32_buffer, 4 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans, i32_buffer, 16, "MMIN.MM  INT32  M1");
  // int64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const int64_t i64_src1[] = {7621253839309581652, 4138013800606796827,
                              7789435713167547180, 3609826260540391400,
                              5902411683316393154, 7547362302378498321,
                              9035475176236335067, -2061431345561205477,
                              259472434100410970,  6455390097215408248};
  const int64_t i64_src2[] = {3759890604660289286, 5968447979930864222,
                              8191709680003459496, 8869515284944638399,
                              2722928046424027974, -7342123838203643858,
                              547153244562634723,  -2944847451770931380,
                              2968699386306159806, -1767721608737341093};
  const int64_t i64_ans[] = {3759890604660289286, 4138013800606796827,
                             7789435713167547180, 3609826260540391400,
                             2722928046424027974, -7342123838203643858,
                             547153244562634723,  -2944847451770931380,
                             259472434100410970,  -1767721608737341093};
  mint64m1_t i64_ts1 = mlce64_m1(i64_src1, 2 * sizeof(int64_t));
  mint64m1_t i64_ts2 = mlce64_m1(i64_src2, 2 * sizeof(int64_t));
  mint64m1_t i64_out = mmin_mm(i64_ts1, i64_ts2);
  msce64_m(i64_out, i64_buffer, 2 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans, i64_buffer, 10, "MMIN.MM  INT64  M1");
  // M2
  // int8
  msettype(E8, M2, BA);
  msettilemi(2);
  msettileni(32);
  const int8_t i8_src1_m2[] = {
      50, -68, 107, 74,  59,  -112, -27, 109, 73,   -123, 44,  97,   -93,
      75, -13, -56, 106, 41,  -15,  94,  -48, -96,  53,   31,  -120, -18,
      38, 69,  73,  15,  51,  33,   -23, -42, 10,   27,   0,   -18,  -57,
      3,  -35, -81, 106, -51, 93,   -7,  -38, 9,    -13,  112, 79,   -44,
      5,  110, 69,  -1,  72,  -81,  106, 60,  -115, -78,  63,  -107};
  const int8_t i8_src2_m2[] = {
      -87, 67,  -81,  -78,  -60, 89,   -60,  -38, -92,  91,  94,   48,  82,
      76,  71,  -117, -99,  -49, 3,    -94,  -66, 52,   -61, -101, -90, -91,
      -60, -78, -107, -122, -54, -124, 108,  -96, 74,   49,  -45,  19,  28,
      43,  -26, 12,   54,   42,  -80,  -62,  -18, -107, 22,  93,   -96, 13,
      -15, -11, -39,  49,   -36, -92,  -100, 120, -38,  49,  20,   11};
  const int8_t i8_ans_m2[] = {
      -87, -68, -81,  -78,  -60, -112, -60,  -38, -92,  -123, 44,   48,   -93,
      75,  -13, -117, -99,  -49, -15,  -94,  -66, -96,  -61,  -101, -120, -91,
      -60, -78, -107, -122, -54, -124, -23,  -96, 10,   27,   -45,  -18,  -57,
      3,   -35, -81,  54,   -51, -80,  -62,  -38, -107, -13,  93,   -96,  -44,
      -15, -11, -39,  -1,   -36, -92,  -100, 60,  -115, -78,  20,   -107};
  mint8m2_t i8_ts1_m2 = mlce8_m2(i8_src1_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_ts2_m2 = mlce8_m2(i8_src2_m2, 32 * sizeof(int8_t));
  mint8m2_t i8_out_m2 = mmin_mm(i8_ts1_m2, i8_ts2_m2);
  msce8_m(i8_out_m2, i8_buffer, 32 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m2, i8_buffer, 2 * 32, "MMIN.MM  INT8   M2");
  // int16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const int16_t i16_src1_m2[] = {
      28627,  -29797, -29703, -15928, 29583,  21272,  30461,  14126,
      2698,   18721,  22828,  31612,  -3377,  10084,  -10117, 29647,
      -31322, -23865, 25944,  -27034, 9342,   16776,  23509,  -18597,
      -12701, 5948,   -12562, -31254, -20695, -9176,  26750,  29486,
      -28491, -21330, -13528, 14102,  -30641, -20426, 5915,   -6986,
      -2931,  -14710, 15153,  341,    -5619,  13715,  28358,  -16617};
  const int16_t i16_src2_m2[] = {
      4510,   10097,  -13227, 5193,   -23663, 25581, 29933,  -28005,
      -15631, 23256,  -24336, 19265,  7145,   -763,  -19093, -25095,
      136,    -27818, 29160,  -23289, 705,    457,   6349,   -29474,
      17566,  1026,   -8142,  -12151, 7079,   2081,  -32632, -16559,
      11480,  -27502, -5799,  29947,  9258,   -8141, 31325,  -31047,
      -24230, 25923,  21994,  30136,  25592,  13599, -17714, -24089};
  const int16_t i16_ans_m2[] = {
      4510,   -29797, -29703, -15928, -23663, 21272,  29933,  -28005,
      -15631, 18721,  -24336, 19265,  -3377,  -763,   -19093, -25095,
      -31322, -27818, 25944,  -27034, 705,    457,    6349,   -29474,
      -12701, 1026,   -12562, -31254, -20695, -9176,  -32632, -16559,
      -28491, -27502, -13528, 14102,  -30641, -20426, 5915,   -31047,
      -24230, -14710, 15153,  341,    -5619,  13599,  -17714, -24089};
  mint16m2_t i16_ts1_m2 = mlce16_m2(i16_src1_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_ts2_m2 = mlce16_m2(i16_src2_m2, 16 * sizeof(int16_t));
  mint16m2_t i16_out_m2 = mmin_mm(i16_ts1_m2, i16_ts2_m2);
  msce16_m(i16_out_m2, i16_buffer, 16 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m2, i16_buffer, 3 * 16, "MMIN.MM  INT16  M2");
  // int32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const int32_t i32_src1_m2[] = {
      -978885466,  -527020961,  -1246074996, -1706209164, 1855681253,
      1815819034,  -1809541597, 948567331,   1676117244,  2057152078,
      1251603605,  -1936979377, -388804942,  1369480091,  1901682834,
      -77790908,   1577265838,  -144723256,  1710632298,  -834091085,
      -24845076,   -919959722,  -1190826467, -2111153518, 116651190,
      -2085348096, -237876042,  2079309533,  609130157,   1609107094,
      904953559,   193698240};
  const int32_t i32_src2_m2[] = {
      -1651044200, 1222244955,  1558367710,  626705587,   -2056168478,
      555104150,   -594635014,  -1008362782, 1936538284,  -1250104990,
      -1157682957, 1847338638,  167038910,   -63897048,   -1668190767,
      -411175327,  -222470504,  -437409728,  460796925,   1062221790,
      1444293792,  -653205390,  -1416081727, -1112605818, 979339671,
      -1040927206, -1864045128, 2029271641,  802316035,   -1976912105,
      1236241546,  737393077};
  const int32_t i32_ans_m2[] = {
      -1651044200, -527020961,  -1246074996, -1706209164, -2056168478,
      555104150,   -1809541597, -1008362782, 1676117244,  -1250104990,
      -1157682957, -1936979377, -388804942,  -63897048,   -1668190767,
      -411175327,  -222470504,  -437409728,  460796925,   -834091085,
      -24845076,   -919959722,  -1416081727, -2111153518, 116651190,
      -2085348096, -1864045128, 2029271641,  609130157,   -1976912105,
      904953559,   193698240};
  mint32m2_t i32_ts1_m2 = mlce32_m2(i32_src1_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_ts2_m2 = mlce32_m2(i32_src2_m2, 8 * sizeof(int32_t));
  mint32m2_t i32_out_m2 = mmin_mm(i32_ts1_m2, i32_ts2_m2);
  msce32_m(i32_out_m2, i32_buffer, 8 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m2, i32_buffer, 4 * 8, "MMIN.MM  INT32  M2");
  // int64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const int64_t i64_src1_m2[] = {
      -5695823833792130123, -8236529725928809380, -3808884394418751159,
      -1781996840298180462, 3676774996857915173,  8795304824174424360,
      -6443100101693868783, 1896884588474790849,  3093020968878075123,
      2213733164280497887,  7766970656289730281,  -1536009600001682758,
      1687779554443561153,  -3821869641923811823, 5155084600007389663,
      -7877094474515765031, -6062858023024459022, -7681521883964093121,
      -7384792855029910058, -2086228859268253279};
  const int64_t i64_src2_m2[] = {
      -4803749998417420031, 4267846696586784135,  -5477179337783090235,
      -9111553044126011368, 4782725875927991238,  -6982301702644611632,
      -3990726920457426422, 7339772938974683662,  -5183045862063062582,
      7424013646827012689,  -6402518093309936158, 6792515618672816928,
      1262849490803429240,  2537024184827364294,  4426355143879699866,
      -1941733894377832939, 7591945564574858110,  -6143301610878936839,
      5518073613296728949,  -3497557872725549341};
  const int64_t i64_ans_m2[] = {
      -5695823833792130123, -8236529725928809380, -5477179337783090235,
      -9111553044126011368, 3676774996857915173,  -6982301702644611632,
      -6443100101693868783, 1896884588474790849,  -5183045862063062582,
      2213733164280497887,  -6402518093309936158, -1536009600001682758,
      1262849490803429240,  -3821869641923811823, 4426355143879699866,
      -7877094474515765031, -6062858023024459022, -7681521883964093121,
      -7384792855029910058, -3497557872725549341};
  mint64m2_t i64_ts1_m2 = mlce64_m2(i64_src1_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_ts2_m2 = mlce64_m2(i64_src2_m2, 4 * sizeof(int64_t));
  mint64m2_t i64_out_m2 = mmin_mm(i64_ts1_m2, i64_ts2_m2);
  msce64_m(i64_out_m2, i64_buffer, 4 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m2, i64_buffer, 5 * 4, "MMIN.MM  INT64  M2");
  // M4
  // int8
  msettype(E8, M4, BA);
  msettilemi(2);
  msettileni(33);
  const int8_t i8_src1_m4[] = {
      106,  -112, 64,   22,  91,  -107, -116, 73,   24,   45,  111,
      -91,  51,   -79,  -31, 43,  -82,  -34,  -98,  116,  122, -79,
      62,   43,   49,   42,  8,   -113, -10,  -69,  -56,  124, 70,
      -113, -90,  -67,  27,  -80, -13,  23,   -94,  -87,  -46, 122,
      -29,  -64,  -119, 117, -72, 37,   107,  31,   -123, 120, 110,
      19,   -83,  -98,  34,  -58, -34,  124,  -116, -90,  -4,  120};
  const int8_t i8_src2_m4[] = {
      -11, 22, -72,  10,   -68, 7,   86,  1,   -86, 75,  37,  -29, 46,  -18,
      46,  77, 54,   122,  -86, -53, -92, -56, 109, 2,   110, 99,  25,  -59,
      41,  30, -108, 49,   -22, -15, 48,  -93, 12,  71,  88,  34,  -16, 16,
      93,  88, 28,   -84,  -88, -77, 25,  51,  -57, 116, -58, 87,  123, -85,
      -54, -8, 1,    -105, 68,  -67, -5,  84,  111, -126};
  const int8_t i8_ans_m4[] = {
      -11,  -112, -72,  10,  -68,  -107, -116, 1,    -86,  45,  37,
      -91,  46,   -79,  -31, 43,   -82,  -34,  -98,  -53,  -92, -79,
      62,   2,    49,   42,  8,    -113, -10,  -69,  -108, 49,  -22,
      -113, -90,  -93,  12,  -80,  -13,  23,   -94,  -87,  -46, 88,
      -29,  -84,  -119, -77, -72,  37,   -57,  31,   -123, 87,  110,
      -85,  -83,  -98,  1,   -105, -34,  -67,  -116, -90,  -4,  -126};
  mint8m4_t i8_ts1_m4 = mlce8_m4(i8_src1_m4, 33 * sizeof(int8_t));
  mint8m4_t i8_ts2_m4 = mlce8_m4(i8_src2_m4, 33 * sizeof(int8_t));
  mint8m4_t i8_out_m4 = mmin_mm(i8_ts1_m4, i8_ts2_m4);
  msce8_m(i8_out_m4, i8_buffer, 33 * sizeof(int8_t));
  EXCEPT_I8_ARRAY_EQ(i8_ans_m4, i8_buffer, 2 * 33, "MMIN.MM  INT8   M4");
  // int16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(17);
  const int16_t i16_src1_m4[] = {
      11234,  17078,  -7232,  31529,  -2471,  9169,   19450, 13363,  -21064,
      -363,   -26375, -1878,  15976,  -7222,  -13777, 12128, 7543,   2352,
      -3141,  7931,   8040,   1763,   6588,   -16378, 12058, -22335, -12144,
      -32078, 28148,  -7231,  17502,  -10815, 11100,  6840,  -24752, 17155,
      -7773,  -27735, -12283, -11034, 9197,   1027,   -9679, -11254, -17135,
      19397,  -11494, 2325,   30696,  -5955,  -21756};
  const int16_t i16_src2_m4[] = {
      -2187,  10902,  -21395, 6556,  -24794, 438,    -29239, -9697,  1352,
      -6711,  -22805, -25121, 1256,  4028,   12418,  -10489, 26606,  8488,
      2222,   -25675, -27312, 27009, -5076,  -11820, 32561,  7194,   20953,
      -13155, 5374,   -11059, 3639,  2289,   -10295, 28895,  -29219, -19453,
      -32694, -13004, -23183, 24548, 26109,  3914,   -9057,  10726,  23665,
      13725,  16065,  -27514, 6063,  -8456,  -29077};
  const int16_t i16_ans_m4[] = {
      -2187,  10902,  -21395, 6556,   -24794, 438,    -29239, -9697,  -21064,
      -6711,  -26375, -25121, 1256,   -7222,  -13777, -10489, 7543,   2352,
      -3141,  -25675, -27312, 1763,   -5076,  -16378, 12058,  -22335, -12144,
      -32078, 5374,   -11059, 3639,   -10815, -10295, 6840,   -29219, -19453,
      -32694, -27735, -23183, -11034, 9197,   1027,   -9679,  -11254, -17135,
      13725,  -11494, -27514, 6063,   -8456,  -29077};
  mint16m4_t i16_ts1_m4 = mlce16_m4(i16_src1_m4, 17 * sizeof(int16_t));
  mint16m4_t i16_ts2_m4 = mlce16_m4(i16_src2_m4, 17 * sizeof(int16_t));
  mint16m4_t i16_out_m4 = mmin_mm(i16_ts1_m4, i16_ts2_m4);
  msce16_m(i16_out_m4, i16_buffer, 17 * sizeof(int16_t));
  EXCEPT_I16_ARRAY_EQ(i16_ans_m4, i16_buffer, 3 * 17, "MMIN.MM  INT16  M4");
  // int32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(9);
  const int32_t i32_src1_m4[] = {
      1095565120,  -472011032,  -1667352936, -40736797,   631857622,
      -1054760602, 1214502048,  1442184364,  98329790,    1665945321,
      -212710981,  -1175315097, -74649549,   -784110198,  -327443285,
      -814629683,  -447202296,  1036943868,  -1534749767, -253432360,
      -700184882,  -867007481,  -719685216,  -1164980100, 1888572923,
      -1398619224, -1362946770, -1262753822, -1047108094, 784132510,
      -1752206754, 1387061068,  -1791178888, -1253494576, 1519661199,
      884369161};
  const int32_t i32_src2_m4[] = {
      1448899765, 2076863070,  1165075262,  1991484967,  187051940,
      2089152371, 1741511056,  1469502190,  1196371416,  -653193712,
      -827722679, 1771364719,  260625426,   -465685777,  -243223204,
      -889095598, 493195944,   1221154776,  -1178764785, -1997469147,
      636596167,  -1462765953, 1209191829,  896379553,   1429047399,
      1966419922, 1936020234,  -1134967353, -2073648519, -629959230,
      439144405,  -530970341,  -1089440690, -219615905,  -310021788,
      1336023492};
  const int32_t i32_ans_m4[] = {
      1095565120,  -472011032,  -1667352936, -40736797,   187051940,
      -1054760602, 1214502048,  1442184364,  98329790,    -653193712,
      -827722679,  -1175315097, -74649549,   -784110198,  -327443285,
      -889095598,  -447202296,  1036943868,  -1534749767, -1997469147,
      -700184882,  -1462765953, -719685216,  -1164980100, 1429047399,
      -1398619224, -1362946770, -1262753822, -2073648519, -629959230,
      -1752206754, -530970341,  -1791178888, -1253494576, -310021788,
      884369161};
  mint32m4_t i32_ts1_m4 = mlce32_m4(i32_src1_m4, 9 * sizeof(int32_t));
  mint32m4_t i32_ts2_m4 = mlce32_m4(i32_src2_m4, 9 * sizeof(int32_t));
  mint32m4_t i32_out_m4 = mmin_mm(i32_ts1_m4, i32_ts2_m4);
  msce32_m(i32_out_m4, i32_buffer, 9 * sizeof(int32_t));
  EXCEPT_I32_ARRAY_EQ(i32_ans_m4, i32_buffer, 4 * 9, "MMIN.MM  INT32  M4");
  // int64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(5);
  const int64_t i64_src1_m4[] = {
      2806342872871200934,  -4033306509707118839, 9163405281227262313,
      6215718112006172060,  -5188619067759740686, 1891919871578505136,
      8245239347998050305,  538664596419176868,   -1427328626997701677,
      -267248691743927065,  2491086929894982572,  -415198778505352733,
      8818777169074707462,  -7407740802528104399, -1064485576538182993,
      5642661546352721818,  7917822208767159260,  799451508763833039,
      -5920878940794372992, 5743357692850553722,  2433594968580870421,
      2409819374750741716,  4072753464912520149,  -3548931910209658310,
      2588166584533400714};
  const int64_t i64_src2_m4[] = {
      -3518986497522083584, -6193777698704027586, -7740189683853878153,
      2525055790195825552,  -1618058656075108236, 525893488660927997,
      1206257265083788821,  -2218902254143442715, -3375053879007718537,
      -4615405803601268329, -759459135541158055,  -2621887154386778721,
      -4245668111356382723, -5454777451529714023, 1637075415605335784,
      3196377742964028770,  7692540751456918002,  6059430227454903339,
      3166726379309099277,  -2890215572890915286, -2544456098249455071,
      6492548681213506332,  -7667271295150473211, -7796667437351042413,
      -503729860330066404};
  const int64_t i64_ans_m4[] = {
      -3518986497522083584, -6193777698704027586, -7740189683853878153,
      2525055790195825552,  -5188619067759740686, 525893488660927997,
      1206257265083788821,  -2218902254143442715, -3375053879007718537,
      -4615405803601268329, -759459135541158055,  -2621887154386778721,
      -4245668111356382723, -7407740802528104399, -1064485576538182993,
      3196377742964028770,  7692540751456918002,  799451508763833039,
      -5920878940794372992, -2890215572890915286, -2544456098249455071,
      2409819374750741716,  -7667271295150473211, -7796667437351042413,
      -503729860330066404};
  mint64m4_t i64_ts1_m4 = mlce64_m4(i64_src1_m4, 5 * sizeof(int64_t));
  mint64m4_t i64_ts2_m4 = mlce64_m4(i64_src2_m4, 5 * sizeof(int64_t));
  mint64m4_t i64_out_m4 = mmin_mm(i64_ts1_m4, i64_ts2_m4);
  msce64_m(i64_out_m4, i64_buffer, 5 * sizeof(int64_t));
  EXCEPT_I64_ARRAY_EQ(i64_ans_m4, i64_buffer, 5 * 5, "MMIN.MM  INT64  M4");
}

static void test_mfmin_mm() {
  // M1
  // fp16
  msettype(E16, M1, BA);
  msettilemi(3);
  msettileni(8);
  const fp16_t fp16_src1[] = {
      -0.641, 1.274,   -0.5757, 0.7256,  -1.534,  0.593,   -1.165,  2.162,
      0.2944, -0.714,  0.2566,  -0.3442, -0.669,  -0.6343, 0.117,   -1.321,
      0.636,  -0.1808, 0.8984,  -0.2937, -0.6978, -1.882,  0.04224, 1.137};
  const fp16_t fp16_src2[] = {
      1.129,   0.4475,  -0.5806, -1.445,  0.307,   2.766,  0.08813, -1.221,
      -0.1545, 0.2212,  -0.1305, -0.9863, -0.9478, 0.6777, -1.476,  -0.394,
      -0.8354, 0.05124, -0.1344, 0.1136,  -0.4602, 0.4934, -1.589,  1.027};
  const fp16_t fp16_ans[] = {
      -0.641,  0.4475,  -0.5806, -1.445,  -1.534,  0.593,   -1.165, -1.221,
      -0.1545, -0.714,  -0.1305, -0.9863, -0.9478, -0.6343, -1.476, -1.321,
      -0.8354, -0.1808, -0.1344, -0.2937, -0.6978, -1.882,  -1.589, 1.027};
  mfloat16m1_t fp16_ts1 = mlce16_m1(fp16_src1, 8 * sizeof(fp16_t));
  mfloat16m1_t fp16_ts2 = mlce16_m1(fp16_src2, 8 * sizeof(fp16_t));
  mfloat16m1_t fp16_out = mfmin_mm(fp16_ts1, fp16_ts2);
  msce16_m(fp16_out, fp16_buffer, 8 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_ans, fp16_buffer, 24, "MFMIN.MM FP16   M1");
  // fp32
  msettype(E32, M1, BA);
  msettilemi(4);
  msettileni(4);
  const fp32_t fp32_src1[] = {
      -0.4690982, -0.28848022, -0.23181526, -2.0541718, 0.18218172, 0.7917702,
      0.6092491,  0.19054824,  -0.5287594,  0.13876893, 0.00224436, -1.4519596,
      2.015604,   1.2912354,   -1.2530205,  -0.25601363};
  const fp32_t fp32_src2[] = {-0.84642494, 0.16054851, -1.7505393, -0.3455231,
                              -0.19710808, 0.10227215, 0.12655504, 0.8003212,
                              0.9909784,   0.17909421, -1.3823507, -0.78190917,
                              -1.4348396,  -1.1776177, 0.6670935,  1.7894806};
  const fp32_t fp32_ans[] = {-0.84642494, -0.28848022, -1.7505393, -2.0541718,
                             -0.19710808, 0.10227215,  0.12655504, 0.19054824,
                             -0.5287594,  0.13876893,  -1.3823507, -1.4519596,
                             -1.4348396,  -1.1776177,  -1.2530205, -0.25601363};
  mfloat32m1_t fp32_ts1 = mlce32_m1(fp32_src1, 4 * sizeof(fp32_t));
  mfloat32m1_t fp32_ts2 = mlce32_m1(fp32_src2, 4 * sizeof(fp32_t));
  mfloat32m1_t fp32_out = mfmin_mm(fp32_ts1, fp32_ts2);
  msce32_m(fp32_out, fp32_buffer, 4 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_ans, fp32_buffer, 16, "MFMIN.MM FP32   M1");
  // fp64
  msettype(E64, M1, BA);
  msettilemi(5);
  msettileni(2);
  const fp64_t fp64_src1[] = {-0.98383261, -0.3942304, -0.15611482, 2.16339874,
                              -0.74209649, -1.5500069, -1.62072863, -0.54966375,
                              0.54711649,  -1.22067194};
  const fp64_t fp64_src2[] = {-2.61784465, 0.02490006, 1.32696526, 0.74632626,
                              0.91131296,  1.1365966,  0.20496439, -1.32838022,
                              -0.1165156,  -0.94767632};
  const fp64_t fp64_ans[] = {-2.61784465, -0.3942304, -0.15611482, 0.74632626,
                             -0.74209649, -1.5500069, -1.62072863, -1.32838022,
                             -0.1165156,  -1.22067194};
  mfloat64m1_t fp64_ts1 = mlce64_m1(fp64_src1, 2 * sizeof(fp64_t));
  mfloat64m1_t fp64_ts2 = mlce64_m1(fp64_src2, 2 * sizeof(fp64_t));
  mfloat64m1_t fp64_out = mfmin_mm(fp64_ts1, fp64_ts2);
  msce64_m(fp64_out, fp64_buffer, 2 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_ans, fp64_buffer, 10, "MFMIN.MM FP64   M1");
  // M2
  // fp16
  msettype(E16, M2, BA);
  msettilemi(3);
  msettileni(16);
  const fp16_t fp16_src1_m2[] = {
      4.5,    4.668,   -2.582,  -2.54,  -0.1443,  8.13,   4.723,  -3.693,
      8.164,  -0.1685, 7.703,   -6.516, -3.713,   -3.748, -3.498, -9.234,
      -9.336, -8.625,  1.202,   -8.766, 5.633,    6.84,   -2.582, -0.4727,
      2.637,  -8.08,   -0.3513, 6.49,   -9.5,     6.598,  4.6,    -3.066,
      -9.51,  6.414,   -4.27,   -3.76,  4.96,     1.6875, 8.73,   7.293,
      1.676,  8.83,    -3.043,  4.12,   -0.01396, 2.77,   -4.32,  -2.3};
  const fp16_t fp16_src2_m2[] = {
      8.6,     -3.805,  5.855, 6.355,  5.19,    -4.95,  9.164,  -3.826,
      -8.766,  8.41,    4.6,   -5.26,  -0.0892, 6.766,  7.86,   0.6455,
      -9.67,   6.086,   8.62,  -2.414, 1.781,   0.824,  -5.3,   -0.162,
      -7.64,   -0.4387, 7.45,  -9.47,  -4.83,   -8.08,  -2.219, 9.125,
      -0.1099, -3.24,   -4.73, 4.15,   -2.988,  8.82,   -4.42,  -1.804,
      8.39,    -2.154,  8.266, -8.914, 5.402,   -1.472, -4.734, 3.213};
  const fp16_t fp16_ans_m2[] = {
      4.5,    -3.805,  -2.582,  -2.54,  -0.1443,  -4.95,  4.723,  -3.826,
      -8.766, -0.1685, 4.6,     -6.516, -3.713,   -3.748, -3.498, -9.234,
      -9.67,  -8.625,  1.202,   -8.766, 1.781,    0.824,  -5.3,   -0.4727,
      -7.64,  -8.08,   -0.3513, -9.47,  -9.5,     -8.08,  -2.219, -3.066,
      -9.51,  -3.24,   -4.73,   -3.76,  -2.988,   1.6875, -4.42,  -1.804,
      1.676,  -2.154,  -3.043,  -8.914, -0.01396, -1.472, -4.734, -2.3};
  mfloat16m2_t fp16_ts1_m2 = mlce16_m2(fp16_src1_m2, 16 * sizeof(fp16_t));
  mfloat16m2_t fp16_ts2_m2 = mlce16_m2(fp16_src2_m2, 16 * sizeof(fp16_t));
  mfloat16m2_t fp16_out_m2 = mfmin_mm(fp16_ts1_m2, fp16_ts2_m2);
  msce16_m(fp16_out_m2, fp16_buffer, 16 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_ans_m2, fp16_buffer, 24, "MFMIN.MM FP16   M2");
  // fp32
  msettype(E32, M2, BA);
  msettilemi(4);
  msettileni(8);
  const fp32_t fp32_src1_m2[] = {
      -3.1618817, 1.9088168, 7.7927623,  -1.662666,   -0.29383308, -3.5763946,
      -8.945769,  1.8541998, -2.5286274, -6.108963,   3.2028704,   7.440432,
      7.5692573,  8.163682,  -4.9826064, -0.60302156, -1.5209943,  2.0695806,
      9.511538,   -4.316945, -7.493721,  2.750786,    8.098024,    9.321954,
      8.146496,   7.553444,  -9.893344,  -2.237274,   -2.3925397,  9.770871,
      -5.6968055, 9.390725};
  const fp32_t fp32_src2_m2[] = {
      -1.5274442, 3.1217833, 9.74294,    0.3877843, 5.9527135,  -1.3617604,
      3.2627563,  9.563086,  2.419182,   2.3867466, -9.509148,  -8.00678,
      3.2438831,  2.6130228, -3.7845793, 5.353824,  -1.1961995, 9.794459,
      -3.75963,   -5.161212, 7.4602075,  9.12424,   -5.1581616, 8.001614,
      -7.7129183, 1.741074,  -4.9830136, -5.701896, 6.7316113,  0.8557456,
      9.082159,   1.7951237};
  const fp32_t fp32_ans_m2[] = {
      -3.1618817, 1.9088168, 7.7927623,  -1.662666,   -0.29383308, -3.5763946,
      -8.945769,  1.8541998, -2.5286274, -6.108963,   -9.509148,   -8.00678,
      3.2438831,  2.6130228, -4.9826064, -0.60302156, -1.5209943,  2.0695806,
      -3.75963,   -5.161212, -7.493721,  2.750786,    -5.1581616,  8.001614,
      -7.7129183, 1.741074,  -9.893344,  -5.701896,   -2.3925397,  0.8557456,
      -5.6968055, 1.7951237};
  mfloat32m2_t fp32_ts1_m2 = mlce32_m2(fp32_src1_m2, 8 * sizeof(fp32_t));
  mfloat32m2_t fp32_ts2_m2 = mlce32_m2(fp32_src2_m2, 8 * sizeof(fp32_t));
  mfloat32m2_t fp32_out_m2 = mfmin_mm(fp32_ts1_m2, fp32_ts2_m2);
  msce32_m(fp32_out_m2, fp32_buffer, 8 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_ans_m2, fp32_buffer, 4 * 8, "MFMIN.MM FP32   M2");
  // fp64
  msettype(E64, M2, BA);
  msettilemi(5);
  msettileni(4);
  const fp64_t fp64_src1_m2[] = {
      -0.44607601, 5.19444456,  -1.770054,   -3.02394041, -3.87701216,
      -3.142008,   -5.14408033, 5.32968867,  3.79360034,  -0.9317016,
      -7.53189696, 0.18206772,  5.55564062,  0.62271317,  1.00046306,
      1.00135787,  4.837276,    -4.82406317, -7.53761989, 6.74282826};
  const fp64_t fp64_src2_m2[] = {
      -0.65758691, 3.78323677,  -9.39750914, -7.70649853, 6.7793528,
      8.31871433,  -7.47740961, -1.72161775, -7.19632965, -7.11908321,
      5.27357932,  -8.87307989, 2.32098621,  3.07986647,  4.71925405,
      5.07623944,  5.80592537,  -2.88357679, -5.36187176, -6.32001368};
  const fp64_t fp64_ans_m2[] = {
      -0.65758691, 3.78323677,  -9.39750914, -7.70649853, -3.87701216,
      -3.142008,   -7.47740961, -1.72161775, -7.19632965, -7.11908321,
      -7.53189696, -8.87307989, 2.32098621,  0.62271317,  1.00046306,
      1.00135787,  4.837276,    -4.82406317, -7.53761989, -6.32001368};
  mfloat64m2_t fp64_ts1_m2 = mlce64_m2(fp64_src1_m2, 4 * sizeof(fp64_t));
  mfloat64m2_t fp64_ts2_m2 = mlce64_m2(fp64_src2_m2, 4 * sizeof(fp64_t));
  mfloat64m2_t fp64_out_m2 = mfmin_mm(fp64_ts1_m2, fp64_ts2_m2);
  msce64_m(fp64_out_m2, fp64_buffer, 4 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_ans_m2, fp64_buffer, 5 * 4, "MFMIN.MM FP64   M2");
  // M4
  // fp16
  msettype(E16, M4, BA);
  msettilemi(3);
  msettileni(17);
  const fp16_t fp16_src1_m4[] = {
      6.766,  -0.0669, 0.6094, -6.375, -0.5386, -9.305, 8.9,    9.164,  3.525,
      -6.418, -7.03,   -1.407, -0.635, -4.895,  6.52,   -5.035, 7.574,  1.903,
      -6.94,  -7.37,   -1.806, -3.656, -6.21,   0.683,  -7.434, -7.113, 7.44,
      4.293,  7.645,   0.3196, -6.395, 0.7065,  2.5,    -3.895, 8.28,   3.365,
      -2.338, -2.217,  -5.383, -4.387, 0.803,   7.84,   6.977,  4.27,   1.206,
      4.79,   2.918,   2.414,  6.61,   -2.906,  -7.24};
  const fp16_t fp16_src2_m4[] = {
      -5.836, 5.285,  -6.117, -7.105,  -4.63,   -1.282, 1.697,   -7.984, -2.523,
      -7.64,  7.023,  3.95,   0.2343,  4.953,   9.84,   4.176,   5.566,  2.78,
      8.26,   -4.266, -1.173, 8.484,   2.252,   -1.202, 0.1921,  5.035,  1.713,
      -0.25,  -5.066, -2.375, -0.5107, -0.8022, -9.34,  -0.7915, 5.367,  0.321,
      9.89,   2.797,  -9.07,  -8.85,   -5.07,   -4.582, 6.027,   -2.77,  -1.523,
      4.977,  2.479,  -4.61,  2.182,   -6.867,  3.758};
  const fp16_t fp16_ans_m4[] = {
      -5.836, -0.0669, -6.117, -7.105, -4.63,   -9.305, 1.697,  -7.984, -2.523,
      -7.64,  -7.03,   -1.407, -0.635, -4.895,  6.52,   -5.035, 5.566,  1.903,
      -6.94,  -7.37,   -1.806, -3.656, -6.21,   -1.202, -7.434, -7.113, 1.713,
      -0.25,  -5.066,  -2.375, -6.395, -0.8022, -9.34,  -3.895, 5.367,  0.321,
      -2.338, -2.217,  -9.07,  -8.85,  -5.07,   -4.582, 6.027,  -2.77,  -1.523,
      4.79,   2.479,   -4.61,  2.182,  -6.867,  -7.24};
  mfloat16m4_t fp16_ts1_m4 = mlce16_m4(fp16_src1_m4, 17 * sizeof(fp16_t));
  mfloat16m4_t fp16_ts2_m4 = mlce16_m4(fp16_src2_m4, 17 * sizeof(fp16_t));
  mfloat16m4_t fp16_out_m4 = mfmin_mm(fp16_ts1_m4, fp16_ts2_m4);
  msce16_m(fp16_out_m4, fp16_buffer, 17 * sizeof(fp16_t));
  EXCEPT_FP16_ARRAY_EQ(fp16_ans_m4, fp16_buffer, 3 * 17, "MFMIN.MM FP16   M4");
  // fp32
  msettype(E32, M4, BA);
  msettilemi(4);
  msettileni(9);
  const fp32_t fp32_src1_m4[] = {
      1.4832873,   0.9775985,  -7.350712,  3.432032,  1.1476078,  9.143892,
      -3.5767808,  -3.9500916, -8.8748045, 3.0977511, 8.608479,   -6.9773164,
      7.8819337,   8.60947,    -3.3402586, 2.2287838, -5.0479836, -8.929053,
      0.5819074,   -1.8882307, -3.9351234, 8.12001,   -7.9997926, 6.7348657,
      -0.16562735, -8.929426,  -4.839727,  3.3431218, -9.231086,  2.9756496,
      -8.585137,   7.2637663,  -1.9495783, 2.9314647, 6.6273227,  -7.6811833};
  const fp32_t fp32_src2_m4[] = {
      -3.9660888, -7.55224,  -2.8900673, 8.976002,  2.4965012,  7.8827066,
      5.138213,   9.5559,    3.2685285,  1.6809667, -9.934711,  -8.44953,
      7.059183,   8.369337,  -7.2953334, -9.702841, -2.2606888, 6.5625877,
      1.1271223,  0.534951,  2.6800108,  4.605732,  -6.539616,  1.149866,
      7.317018,   6.471072,  -2.6961083, 2.480735,  0.99137914, 6.1606283,
      8.734219,   1.5752183, 1.6263362,  6.0449576, -1.6237959, -8.161139};
  const fp32_t fp32_ans_m4[] = {
      -3.9660888,  -7.55224,   -7.350712,  3.432032,  1.1476078,  7.8827066,
      -3.5767808,  -3.9500916, -8.8748045, 1.6809667, -9.934711,  -8.44953,
      7.059183,    8.369337,   -7.2953334, -9.702841, -5.0479836, -8.929053,
      0.5819074,   -1.8882307, -3.9351234, 4.605732,  -7.9997926, 1.149866,
      -0.16562735, -8.929426,  -4.839727,  2.480735,  -9.231086,  2.9756496,
      -8.585137,   1.5752183,  -1.9495783, 2.9314647, -1.6237959, -8.161139};
  mfloat32m4_t fp32_ts1_m4 = mlce32_m4(fp32_src1_m4, 9 * sizeof(fp32_t));
  mfloat32m4_t fp32_ts2_m4 = mlce32_m4(fp32_src2_m4, 9 * sizeof(fp32_t));
  mfloat32m4_t fp32_out_m4 = mfmin_mm(fp32_ts1_m4, fp32_ts2_m4);
  msce32_m(fp32_out_m4, fp32_buffer, 9 * sizeof(fp32_t));
  EXCEPT_FP32_ARRAY_EQ(fp32_ans_m4, fp32_buffer, 4 * 9, "MFMIN.MM FP32   M4");
  // fp64
  msettype(E64, M4, BA);
  msettilemi(5);
  msettileni(5);
  const fp64_t fp64_src1_m4[] = {
      -0.93553379, 1.84597833,  9.45122483,  0.47156288,  9.90699323,
      -8.65967817, 0.10362504,  -0.79551083, 0.36717413,  6.00365388,
      -6.67485661, 3.95127793,  4.14775656,  -8.95337255, -4.12315467,
      -1.06230358, -7.30090334, 3.66221497,  5.29925283,  5.75511342,
      -5.01600129, 7.64869806,  4.84632574,  -4.1229701,  3.6971093};
  const fp64_t fp64_src2_m4[] = {
      5.94591402, 5.81426992,  -3.81335736, -4.57394229, 1.40736632,
      8.06140115, 8.92756695,  -5.1166932,  -7.01846772, 1.93428525,
      -6.7310329, 9.79278892,  -1.82609956, -5.81279551, 2.84222442,
      9.66045542, -8.15523397, 0.22805442,  0.52734195,  4.16556176,
      7.77990875, 5.98779775,  8.45210604,  7.38105792,  -9.73572793};
  const fp64_t fp64_ans_m4[] = {
      -0.93553379, 1.84597833,  -3.81335736, -4.57394229, 1.40736632,
      -8.65967817, 0.10362504,  -5.1166932,  -7.01846772, 1.93428525,
      -6.7310329,  3.95127793,  -1.82609956, -8.95337255, -4.12315467,
      -1.06230358, -8.15523397, 0.22805442,  0.52734195,  4.16556176,
      -5.01600129, 5.98779775,  4.84632574,  -4.1229701,  -9.73572793};
  mfloat64m4_t fp64_ts1_m4 = mlce64_m4(fp64_src1_m4, 5 * sizeof(fp64_t));
  mfloat64m4_t fp64_ts2_m4 = mlce64_m4(fp64_src2_m4, 5 * sizeof(fp64_t));
  mfloat64m4_t fp64_out_m4 = mfmin_mm(fp64_ts1_m4, fp64_ts2_m4);
  msce64_m(fp64_out_m4, fp64_buffer, 5 * sizeof(fp64_t));
  EXCEPT_FP64_ARRAY_EQ(fp64_ans_m4, fp64_buffer, 5 * 5, "MFMIN.MM FP64   M4");
}

int main() {
  test_mminu_mm();
  test_mmin_mm();
  test_mfmin_mm();
  return 0;
}
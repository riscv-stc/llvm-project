#include "../ops/relu.h"
#include "../ops/tensor.h"
#include "../../isa/utils.h"

int main() {
  float src[] = {
      0.46655837,  0.7923713,   0.77544147,  0.6808283,   -0.04068773,
      -0.35154775, 0.10725453,  0.5510965,   0.49182087,  -0.78383887,
      -0.3093958,  0.3078473,   -0.20540418, 0.5174662,   -0.56760603,
      -0.79233116, -0.3159451,  0.74750865,  -0.9999296,  -0.30759943,
      0.5491216,   0.5792443,   0.60262835,  -0.07874836, -0.03365202,
      0.06611942,  0.47976652,  0.59180045,  -0.54456663, 0.67923576,
      -0.9469304,  0.22256434,  0.74780726,  0.36728892,  -0.19898432,
      -0.21164888, 0.8411711,   0.24949281,  0.5182191,   0.45212135,
      -0.16783388, 0.92130214,  0.01675422,  -0.18474475, 0.883096,
      -0.20615879, -0.31389853, -0.08303127, -0.04267895, 0.8482994,
      -0.09223229, -0.25541547, -0.8249179,  -0.7797356,  -0.6964165,
      -0.03777706, 0.54328686,  0.03104574,  -0.26748857, -0.46317142,
      -0.7193112,  0.47069007,  0.5078841,   -0.5795734,  0.85042655,
      0.09946046,  -0.53379864, -0.9117482,  0.5903883,   0.55043185,
      0.3479192,   -0.83267266, -0.0784378,  0.73587906,  0.7109809,
      -0.421423,   0.1642637,   0.4351054,   -0.80116403, -0.546241,
      -0.87529975, 0.4024594,   -0.81388384, 0.44966555,  -0.65238476,
      -0.61131394, -0.9346086,  -0.4140112,  0.8283016,   0.2942547,
      -0.52081954, -0.7979952,  0.13659404,  0.77164954,  0.21772657,
      -0.17779575, 0.02112283,  0.12895857,  0.2299277,   0.13770263,
      0.07468628,  -0.43683943, 0.70621836,  0.7286866,   -0.05635041,
      0.84853154,  -0.5397123,  0.34478605,  0.61212397,  -0.5779952,
      -0.52403855, 0.20592025,  -0.5651637,  0.67735225,  0.22660142,
      0.39882785,  -0.5837182,  -0.9623924,  0.06695897,  -0.04178837,
      0.98109585,  0.3992074,   0.23252368,  0.25205404,  -0.45800358,
      0.57657653,  -0.84864485, -0.43812203, -0.3570933,  -0.15531866,
      0.5216608,   0.336541,    -0.32836872, 0.44368002,  0.94476074,
      0.7500651,   -0.89917606, -0.61026764, 0.57195175,  0.08035754,
      0.60613805,  -0.18694079, 0.13352083,  -0.33071032, 0.76920444,
      -0.9652859,  -0.9051815,  -0.73831123, -0.00910901, 0.7434478,
      0.3536726,   -0.6885615,  -0.03582863, -0.2559099,  0.51391727,
      0.01864476,  0.6026129,   0.8759699,   -0.04340729, -0.41565502,
      0.73815763,  -0.62438595, -0.4853463,  -0.40035224, 0.46219495,
      -0.171524,   -0.08840571, 0.17773248,  -0.13886897, -0.8850837,
      0.27730766,  0.53929317,  0.73007333,  -0.46905255, -0.5847412,
      0.27308744,  0.35699356,  -0.620587,   -0.33325136, -0.53843206,
      0.20344679,  -0.5659526,  -0.27629542, 0.607025,    0.38371968,
      0.58635944,  0.5013707,   0.4818394,   -0.13006802, -0.53086066,
      0.83917475,  -0.48433208, -0.8499285,  0.7786722,   0.581288,
      -0.9289885,  -0.34819183, -0.21301049, -0.3475577,  -0.35685438,
      -0.1777537,  -0.8365526,  -0.00833678, 0.8179653,   -0.2900669,
      0.06259731,  0.07350326,  0.22294456,  0.43101677,  0.48682383,
      0.28619033,  0.04205339,  -0.36536103, -0.7915259,  -0.75973123,
      0.5549162,   -0.28630206, -0.21016252, -0.35217622, -0.40522075,
      -0.83137727, -0.1818933,  -0.84354866, 0.9472214,   0.13932599,
      -0.3009503,  0.5548897,   0.46047056,  0.53116316,  -0.78704846,
      0.4483907,   -0.8802489,  0.9701884,   0.60799855,  0.8844233,
      -0.17478853, 0.97432643,  -0.19800442, -0.5725819,  0.40474513,
      -0.7914112,  -0.8947731,  -0.08747394, 0.9962783,   0.47677338,
      -0.25977325, -0.576355,   0.4713324,   0.3865101,   0.91130996,
      -0.17811914, -0.45132515, 0.27647147,  -0.14546657, -0.16879615,
      -0.61620945, 0.44864905,  -0.04796845, 0.87902313,  -0.39405587,
      0.43109232,  0.18901128,  -0.3524904,  0.01891013,  0.3488697,
      -0.00427757, -0.69811875, -0.2578328,  0.40014735,  0.18865418,
      0.10026714,  -0.45917445, 0.86020446,  0.7384558,   0.35034162,
      0.25347683,  0.5522308,   -0.1273806,  -0.12129512, -0.8725665,
      -0.5353287,  -0.2857102,  0.29445335,  0.21894886,  0.16765215,
      0.35580024,  0.7619719,   -0.09161223, 0.37756112,  0.41700888,
      0.560496,    -0.93361664, -0.27293226, -0.10375621, -0.8812883,
      0.49557433,  0.2214645,   0.4308445,   0.34875622,  0.8879132,
      -0.51416427, -0.971827,   0.02515817,  -0.94661564, 0.25504065,
      -0.684288,   -0.05179989, -0.58054435, -0.30294436, 0.53526187,
      0.16147147,  0.5134517,   0.44025028,  -0.83828694, 0.65813714,
      0.31751388,  0.4988426,   0.69191873,  0.01066631,  0.8395872,
      0.81272244,  -0.61230195, -0.22907141, -0.41656202, -0.7909061,
      -0.13494752, -0.44009978, 0.9271329,   -0.7548907,  0.03855171,
      -0.8123637,  0.524032,    -0.06597198, -0.11549416, 0.24905482,
      0.89106846,  -0.47442973, -0.98328614, -0.05636035, 0.4110556,
      0.341712,    0.521339,    -0.57757664, 0.86334425,  0.26976347,
      -0.30286616, 0.07061425,  -0.5705602,  -0.76557004, 0.6772037,
      0.8703982,   0.88242316,  -0.34827718, 0.26031765,  -0.81406844,
      0.44893497,  -0.4232187,  0.7051263,   0.3695505,   -0.60456824,
      0.18582995,  0.24880576,  -0.26119393, 0.08669323,  0.5265781,
      -0.80937105, -0.7121383,  -0.11661884, 0.93675745,  -0.9555438,
      0.9027426,   0.4416976,   0.822449,    -0.49433017, 0.20454127,
      0.03670938,  0.81049484,  -0.13471974, -0.00648611, -0.15429677,
      0.14273216,  -0.6410363,  0.09618732,  -0.60651565, -0.09398355,
      0.95874286,  -0.9191235,  0.43739897,  -0.99700946, 0.77871144,
      -0.36014423, -0.57352436, 0.03030994,  0.24567279,  0.49258086,
      0.6994935,   0.4545478,   0.3493173,   -0.01493175, 0.69024473,
      -0.14611487, -0.52256155, 0.72436845,  -0.88749295, -0.2850782,
      0.6076154,   -0.3173387,  -0.2397484,  -0.05396315, 0.9700943,
      0.5099143,   0.1883294,   -0.12795173, -0.77705616, -0.1552498,
      -0.5136204,  0.89121526,  0.34224334,  0.46923682,  -0.2405661,
      0.2589122,   -0.53765637, -0.31450155, 0.12159848,  0.36291352,
      -0.95413154, 0.8274794,   0.03115161,  -0.07582904, 0.05888392,
      -0.11245581, 0.66107595,  -0.49545363, 0.4032682,   0.41046154,
      0.41258326,  0.48756716,  -0.86780524, -0.32662046, -0.38898057,
      -0.62044203};
  float ans[] = {
      0.46655837, 0.7923713,  0.77544147, 0.6808283,  0.,         0.,
      0.10725453, 0.5510965,  0.49182087, 0.,         0.,         0.3078473,
      0.,         0.5174662,  0.,         0.,         0.,         0.74750865,
      0.,         0.,         0.5491216,  0.5792443,  0.60262835, 0.,
      0.,         0.06611942, 0.47976652, 0.59180045, 0.,         0.67923576,
      0.,         0.22256434, 0.74780726, 0.36728892, 0.,         0.,
      0.8411711,  0.24949281, 0.5182191,  0.45212135, 0.,         0.92130214,
      0.01675422, 0.,         0.883096,   0.,         0.,         0.,
      0.,         0.8482994,  0.,         0.,         0.,         0.,
      0.,         0.,         0.54328686, 0.03104574, 0.,         0.,
      0.,         0.47069007, 0.5078841,  0.,         0.85042655, 0.09946046,
      0.,         0.,         0.5903883,  0.55043185, 0.3479192,  0.,
      0.,         0.73587906, 0.7109809,  0.,         0.1642637,  0.4351054,
      0.,         0.,         0.,         0.4024594,  0.,         0.44966555,
      0.,         0.,         0.,         0.,         0.8283016,  0.2942547,
      0.,         0.,         0.13659404, 0.77164954, 0.21772657, 0.,
      0.02112283, 0.12895857, 0.2299277,  0.13770263, 0.07468628, 0.,
      0.70621836, 0.7286866,  0.,         0.84853154, 0.,         0.34478605,
      0.61212397, 0.,         0.,         0.20592025, 0.,         0.67735225,
      0.22660142, 0.39882785, 0.,         0.,         0.06695897, 0.,
      0.98109585, 0.3992074,  0.23252368, 0.25205404, 0.,         0.57657653,
      0.,         0.,         0.,         0.,         0.5216608,  0.336541,
      0.,         0.44368002, 0.94476074, 0.7500651,  0.,         0.,
      0.57195175, 0.08035754, 0.60613805, 0.,         0.13352083, 0.,
      0.76920444, 0.,         0.,         0.,         0.,         0.7434478,
      0.3536726,  0.,         0.,         0.,         0.51391727, 0.01864476,
      0.6026129,  0.8759699,  0.,         0.,         0.73815763, 0.,
      0.,         0.,         0.46219495, 0.,         0.,         0.17773248,
      0.,         0.,         0.27730766, 0.53929317, 0.73007333, 0.,
      0.,         0.27308744, 0.35699356, 0.,         0.,         0.,
      0.20344679, 0.,         0.,         0.607025,   0.38371968, 0.58635944,
      0.5013707,  0.4818394,  0.,         0.,         0.83917475, 0.,
      0.,         0.7786722,  0.581288,   0.,         0.,         0.,
      0.,         0.,         0.,         0.,         0.,         0.8179653,
      0.,         0.06259731, 0.07350326, 0.22294456, 0.43101677, 0.48682383,
      0.28619033, 0.04205339, 0.,         0.,         0.,         0.5549162,
      0.,         0.,         0.,         0.,         0.,         0.,
      0.,         0.9472214,  0.13932599, 0.,         0.5548897,  0.46047056,
      0.53116316, 0.,         0.4483907,  0.,         0.9701884,  0.60799855,
      0.8844233,  0.,         0.97432643, 0.,         0.,         0.40474513,
      0.,         0.,         0.,         0.9962783,  0.47677338, 0.,
      0.,         0.4713324,  0.3865101,  0.91130996, 0.,         0.,
      0.27647147, 0.,         0.,         0.,         0.44864905, 0.,
      0.87902313, 0.,         0.43109232, 0.18901128, 0.,         0.01891013,
      0.3488697,  0.,         0.,         0.,         0.40014735, 0.18865418,
      0.10026714, 0.,         0.86020446, 0.7384558,  0.35034162, 0.25347683,
      0.5522308,  0.,         0.,         0.,         0.,         0.,
      0.29445335, 0.21894886, 0.16765215, 0.35580024, 0.7619719,  0.,
      0.37756112, 0.41700888, 0.560496,   0.,         0.,         0.,
      0.,         0.49557433, 0.2214645,  0.4308445,  0.34875622, 0.8879132,
      0.,         0.,         0.02515817, 0.,         0.25504065, 0.,
      0.,         0.,         0.,         0.53526187, 0.16147147, 0.5134517,
      0.44025028, 0.,         0.65813714, 0.31751388, 0.4988426,  0.69191873,
      0.01066631, 0.8395872,  0.81272244, 0.,         0.,         0.,
      0.,         0.,         0.,         0.9271329,  0.,         0.03855171,
      0.,         0.524032,   0.,         0.,         0.24905482, 0.89106846,
      0.,         0.,         0.,         0.4110556,  0.341712,   0.521339,
      0.,         0.86334425, 0.26976347, 0.,         0.07061425, 0.,
      0.,         0.6772037,  0.8703982,  0.88242316, 0.,         0.26031765,
      0.,         0.44893497, 0.,         0.7051263,  0.3695505,  0.,
      0.18582995, 0.24880576, 0.,         0.08669323, 0.5265781,  0.,
      0.,         0.,         0.93675745, 0.,         0.9027426,  0.4416976,
      0.822449,   0.,         0.20454127, 0.03670938, 0.81049484, 0.,
      0.,         0.,         0.14273216, 0.,         0.09618732, 0.,
      0.,         0.95874286, 0.,         0.43739897, 0.,         0.77871144,
      0.,         0.,         0.03030994, 0.24567279, 0.49258086, 0.6994935,
      0.4545478,  0.3493173,  0.,         0.69024473, 0.,         0.,
      0.72436845, 0.,         0.,         0.6076154,  0.,         0.,
      0.,         0.9700943,  0.5099143,  0.1883294,  0.,         0.,
      0.,         0.,         0.89121526, 0.34224334, 0.46923682, 0.,
      0.2589122,  0.,         0.,         0.12159848, 0.36291352, 0.,
      0.8274794,  0.03115161, 0.,         0.05888392, 0.,         0.66107595,
      0.,         0.4032682,  0.41046154, 0.41258326, 0.48756716, 0.,
      0.,         0.,         0.};
  const int B = 1;
  int H = 7;
  int W = 7;
  int C = 9;
  float dst[H * W * C];
  create_tensor4d(relu_src, (void *)src, B, H, W, C);
  create_tensor4d(relu_dst, (void *)dst, B, H, W, C);
  create_tensor4d(relu_ans, (void *)ans, B, H, W, C);
  relu(&relu_dst, &relu_src);
  float* dst_ptr = (float *)relu_dst.data;
  float* ans_ptr = (float *)relu_ans.data;
  EXCEPT_FP32_ARRAY_LAX_EQ(ans_ptr, dst_ptr, H * W * C, "RELU [1, 7, 7, 9]");
  return 0;
}